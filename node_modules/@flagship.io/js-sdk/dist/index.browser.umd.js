/*! For license information please see index.browser.umd.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(self,(()=>(()=>{var t,e,n={34:(t,e,n)=>{"use strict";var i=n(4901);t.exports=function(t){return"object"==typeof t?null!==t:i(t)}},81:(t,e,n)=>{"use strict";var i=n(9565),r=n(9306),o=n(8551),s=n(6823),a=n(851),c=TypeError;t.exports=function(t,e){var n=arguments.length<2?a(t):e;if(r(n))return o(i(n,t));throw new c(s(t)+" is not iterable")}},113:(t,e,n)=>{"use strict";var i=n(6518),r=n(9213).find,o=n(6469),s="find",a=!0;s in[]&&Array(1)[s]((function(){a=!1})),i({target:"Array",proto:!0,forced:a},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),o(s)},235:(t,e,n)=>{"use strict";var i=n(9213).forEach,r=n(4598)("forEach");t.exports=r?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},280:(t,e,n)=>{"use strict";var i=n(6518),r=n(7751),o=n(6395),s=n(550),a=n(916).CONSTRUCTOR,c=n(3438),u=r("Promise"),l=o&&!a;i({target:"Promise",stat:!0,forced:o||a},{resolve:function(t){return c(l&&this===u?s:this,t)}})},283:(t,e,n)=>{"use strict";var i=n(9504),r=n(9039),o=n(4901),s=n(9297),a=n(3724),c=n(350).CONFIGURABLE,u=n(3706),l=n(1181),f=l.enforce,h=l.get,d=String,g=Object.defineProperty,p=i("".slice),v=i("".replace),I=i([].join),_=a&&!r((function(){return 8!==g((function(){}),"length",{value:8}).length})),y=String(String).split("String"),E=t.exports=function(t,e,n){"Symbol("===p(d(e),0,7)&&(e="["+v(d(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||c&&t.name!==e)&&(a?g(t,"name",{value:e,configurable:!0}):t.name=e),_&&n&&s(n,"arity")&&t.length!==n.arity&&g(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&g(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var i=f(t);return s(i,"source")||(i.source=I(y,"string"==typeof e?e:"")),t};Function.prototype.toString=E((function(){return o(this)&&h(this).source||u(this)}),"toString")},298:(t,e,n)=>{"use strict";var i=n(4576),r=n(5397),o=n(8480).f,s=n(7680),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"Window"===i(t)?function(t){try{return o(t)}catch(t){return s(a)}}(t):o(r(t))}},350:(t,e,n)=>{"use strict";var i=n(3724),r=n(9297),o=Function.prototype,s=i&&Object.getOwnPropertyDescriptor,a=r(o,"name"),c=a&&"something"===function(){}.name,u=a&&(!i||i&&s(o,"name").configurable);t.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},380:(t,e,n)=>{"use strict";var i=n(9504),r=n(9039),o=n(533).start,s=RangeError,a=isFinite,c=Math.abs,u=Date.prototype,l=u.toISOString,f=i(u.getTime),h=i(u.getUTCDate),d=i(u.getUTCFullYear),g=i(u.getUTCHours),p=i(u.getUTCMilliseconds),v=i(u.getUTCMinutes),I=i(u.getUTCMonth),_=i(u.getUTCSeconds);t.exports=r((function(){return"0385-07-25T07:06:39.999Z"!==l.call(new Date(-50000000000001))}))||!r((function(){l.call(new Date(NaN))}))?function(){if(!a(f(this)))throw new s("Invalid time value");var t=this,e=d(t),n=p(t),i=e<0?"-":e>9999?"+":"";return i+o(c(e),i?6:4,0)+"-"+o(I(t)+1,2,0)+"-"+o(h(t),2,0)+"T"+o(g(t),2,0)+":"+o(v(t),2,0)+":"+o(_(t),2,0)+"."+o(n,3,0)+"Z"}:l},397:(t,e,n)=>{"use strict";var i=n(7751);t.exports=i("document","documentElement")},421:t=>{"use strict";t.exports={}},436:(t,e,n)=>{"use strict";var i,r,o,s=n(6518),a=n(6395),c=n(6193),u=n(2195),l=n(9565),f=n(6840),h=n(2967),d=n(687),g=n(7633),p=n(9306),v=n(4901),I=n(34),_=n(679),y=n(2293),E=n(9225).set,T=n(1955),A=n(3138),S=n(1103),m=n(8265),C=n(1181),O=n(550),k=n(916),b=n(6043),R="Promise",N=k.CONSTRUCTOR,D=k.REJECTION_EVENT,w=k.SUBCLASSING,x=C.getterFor(R),P=C.set,L=O&&O.prototype,M=O,H=L,F=u.TypeError,V=u.document,U=u.process,G=b.f,j=G,B=!!(V&&V.createEvent&&u.dispatchEvent),K="unhandledrejection",Q=function(t){var e;return!(!I(t)||!v(e=t.then))&&e},q=function(t,e){var n,i,r,o=e.value,s=1===e.state,a=s?t.ok:t.fail,c=t.resolve,u=t.reject,f=t.domain;try{a?(s||(2===e.rejection&&J(e),e.rejection=1),!0===a?n=o:(f&&f.enter(),n=a(o),f&&(f.exit(),r=!0)),n===t.promise?u(new F("Promise-chain cycle")):(i=Q(n))?l(i,n,c,u):c(n)):u(o)}catch(t){f&&!r&&f.exit(),u(t)}},Y=function(t,e){t.notified||(t.notified=!0,T((function(){for(var n,i=t.reactions;n=i.get();)q(n,t);t.notified=!1,e&&!t.rejection&&z(t)})))},W=function(t,e,n){var i,r;B?((i=V.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),u.dispatchEvent(i)):i={promise:e,reason:n},!D&&(r=u["on"+t])?r(i):t===K&&A("Unhandled promise rejection",n)},z=function(t){l(E,u,(function(){var e,n=t.facade,i=t.value;if(X(t)&&(e=S((function(){c?U.emit("unhandledRejection",i,n):W(K,n,i)})),t.rejection=c||X(t)?2:1,e.error))throw e.value}))},X=function(t){return 1!==t.rejection&&!t.parent},J=function(t){l(E,u,(function(){var e=t.facade;c?U.emit("rejectionHandled",e):W("rejectionhandled",e,t.value)}))},Z=function(t,e,n){return function(i){t(e,i,n)}},$=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,Y(t,!0))},tt=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw new F("Promise can't be resolved itself");var i=Q(e);i?T((function(){var n={done:!1};try{l(i,e,Z(tt,n,t),Z($,n,t))}catch(e){$(n,e,t)}})):(t.value=e,t.state=1,Y(t,!1))}catch(e){$({done:!1},e,t)}}};if(N&&(H=(M=function(t){_(this,H),p(t),l(i,this);var e=x(this);try{t(Z(tt,e),Z($,e))}catch(t){$(e,t)}}).prototype,(i=function(t){P(this,{type:R,done:!1,notified:!1,parent:!1,reactions:new m,rejection:!1,state:0,value:null})}).prototype=f(H,"then",(function(t,e){var n=x(this),i=G(y(this,M));return n.parent=!0,i.ok=!v(t)||t,i.fail=v(e)&&e,i.domain=c?U.domain:void 0,0===n.state?n.reactions.add(i):T((function(){q(i,n)})),i.promise})),r=function(){var t=new i,e=x(t);this.promise=t,this.resolve=Z(tt,e),this.reject=Z($,e)},b.f=G=function(t){return t===M||void 0===t?new r(t):j(t)},!a&&v(O)&&L!==Object.prototype)){o=L.then,w||f(L,"then",(function(t,e){var n=this;return new M((function(t,e){l(o,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete L.constructor}catch(t){}h&&h(L,H)}s({global:!0,constructor:!0,wrap:!0,forced:N},{Promise:M}),d(M,R,!1,!0),g(R)},511:(t,e,n)=>{"use strict";var i=n(788),r=TypeError;t.exports=function(t){if(i(t))throw new r("The method doesn't accept regular expressions");return t}},533:(t,e,n)=>{"use strict";var i=n(9504),r=n(8014),o=n(655),s=n(2333),a=n(7750),c=i(s),u=i("".slice),l=Math.ceil,f=function(t){return function(e,n,i){var s,f,h=o(a(e)),d=r(n),g=h.length,p=void 0===i?" ":o(i);return d<=g||""===p?h:((f=c(p,l((s=d-g)/p.length))).length>s&&(f=u(f,0,s)),t?h+f:f+h)}};t.exports={start:f(!1),end:f(!0)}},537:(t,e,n)=>{"use strict";var i=n(550),r=n(4428),o=n(916).CONSTRUCTOR;t.exports=o||!r((function(t){i.all(t).then(void 0,(function(){}))}))},550:(t,e,n)=>{"use strict";var i=n(2195);t.exports=i.Promise},566:(t,e,n)=>{"use strict";var i=n(9504),r=n(9306),o=n(34),s=n(9297),a=n(7680),c=n(616),u=Function,l=i([].concat),f=i([].join),h={};t.exports=c?u.bind:function(t){var e=r(this),n=e.prototype,i=a(arguments,1),c=function(){var n=l(i,a(arguments));return this instanceof c?function(t,e,n){if(!s(h,e)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";h[e]=u("C,a","return new C("+f(i,",")+")")}return h[e](t,n)}(e,n.length,n):e.apply(t,n)};return o(n)&&(c.prototype=n),c}},597:(t,e,n)=>{"use strict";var i=n(9039),r=n(8227),o=n(9519),s=r("species");t.exports=function(t){return o>=51||!i((function(){var e=[];return(e.constructor={})[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},616:(t,e,n)=>{"use strict";var i=n(9039);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},655:(t,e,n)=>{"use strict";var i=n(6955),r=String;t.exports=function(t){if("Symbol"===i(t))throw new TypeError("Cannot convert a Symbol value to a string");return r(t)}},679:(t,e,n)=>{"use strict";var i=n(1625),r=TypeError;t.exports=function(t,e){if(i(e,t))return t;throw new r("Incorrect invocation")}},687:(t,e,n)=>{"use strict";var i=n(4913).f,r=n(9297),o=n(8227)("toStringTag");t.exports=function(t,e,n){t&&!n&&(t=t.prototype),t&&!r(t,o)&&i(t,o,{configurable:!0,value:e})}},739:(t,e,n)=>{"use strict";var i=n(6518),r=n(9039),o=n(8981),s=n(2777);i({target:"Date",proto:!0,arity:1,forced:r((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(t){var e=o(this),n=s(e,"number");return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},741:t=>{"use strict";var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?n:e)(i)}},757:(t,e,n)=>{"use strict";var i=n(7751),r=n(4901),o=n(1625),s=n(7040),a=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=i("Symbol");return r(e)&&o(e.prototype,a(t))}},761:(t,e,n)=>{"use strict";n(6518)({target:"Math",stat:!0},{trunc:n(741)})},788:(t,e,n)=>{"use strict";var i=n(34),r=n(4576),o=n(8227)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"===r(t))}},816:(t,e,n)=>{"use strict";n.d(e,{default:()=>r});var i=n(2284);function r(t){var e=function(t){if("object"!=(0,i.default)(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=(0,i.default)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==(0,i.default)(e)?e:e+""}},825:(t,e,n)=>{"use strict";var i=n(6518),r=n(7751),o=n(8745),s=n(566),a=n(5548),c=n(8551),u=n(34),l=n(2360),f=n(9039),h=r("Reflect","construct"),d=Object.prototype,g=[].push,p=f((function(){function t(){}return!(h((function(){}),[],t)instanceof t)})),v=!f((function(){h((function(){}))})),I=p||v;i({target:"Reflect",stat:!0,forced:I,sham:I},{construct:function(t,e){a(t),c(e);var n=arguments.length<3?t:a(arguments[2]);if(v&&!p)return h(t,e,n);if(t===n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return o(g,i,e),new(o(s,t,i))}var r=n.prototype,f=l(u(r)?r:d),I=o(t,f,e);return u(I)?I:f}})},851:(t,e,n)=>{"use strict";var i=n(6955),r=n(5966),o=n(4117),s=n(6269),a=n(8227)("iterator");t.exports=function(t){if(!o(t))return r(t,a)||r(t,"@@iterator")||s[i(t)]}},916:(t,e,n)=>{"use strict";var i=n(2195),r=n(550),o=n(4901),s=n(2796),a=n(3706),c=n(8227),u=n(4215),l=n(6395),f=n(9519),h=r&&r.prototype,d=c("species"),g=!1,p=o(i.PromiseRejectionEvent),v=s("Promise",(function(){var t=a(r),e=t!==String(r);if(!e&&66===f)return!0;if(l&&(!h.catch||!h.finally))return!0;if(!f||f<51||!/native code/.test(t)){var n=new r((function(t){t(1)})),i=function(t){t((function(){}),(function(){}))};if((n.constructor={})[d]=i,!(g=n.then((function(){}))instanceof i))return!0}return!(e||"BROWSER"!==u&&"DENO"!==u||p)}));t.exports={CONSTRUCTOR:v,REJECTION_EVENT:p,SUBCLASSING:g}},1034:(t,e,n)=>{"use strict";var i=n(9565),r=n(9297),o=n(1625),s=n(7979),a=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in a||r(t,"flags")||!o(a,t)?e:i(s,t)}},1056:(t,e,n)=>{"use strict";var i=n(4913).f;t.exports=function(t,e,n){n in t||i(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},1072:(t,e,n)=>{"use strict";var i=n(1828),r=n(8727);t.exports=Object.keys||function(t){return i(t,r)}},1088:(t,e,n)=>{"use strict";var i=n(6518),r=n(9565),o=n(6395),s=n(350),a=n(4901),c=n(3994),u=n(2787),l=n(2967),f=n(687),h=n(6699),d=n(6840),g=n(8227),p=n(6269),v=n(7657),I=s.PROPER,_=s.CONFIGURABLE,y=v.IteratorPrototype,E=v.BUGGY_SAFARI_ITERATORS,T=g("iterator"),A="keys",S="values",m="entries",C=function(){return this};t.exports=function(t,e,n,s,g,v,O){c(n,e,s);var k,b,R,N=function(t){if(t===g&&L)return L;if(!E&&t&&t in x)return x[t];switch(t){case A:case S:case m:return function(){return new n(this,t)}}return function(){return new n(this)}},D=e+" Iterator",w=!1,x=t.prototype,P=x[T]||x["@@iterator"]||g&&x[g],L=!E&&P||N(g),M="Array"===e&&x.entries||P;if(M&&(k=u(M.call(new t)))!==Object.prototype&&k.next&&(o||u(k)===y||(l?l(k,y):a(k[T])||d(k,T,C)),f(k,D,!0,!0),o&&(p[D]=C)),I&&g===S&&P&&P.name!==S&&(!o&&_?h(x,"name",S):(w=!0,L=function(){return r(P,this)})),g)if(b={values:N(S),keys:v?L:N(A),entries:N(m)},O)for(R in b)(E||w||!(R in x))&&d(x,R,b[R]);else i({target:e,proto:!0,forced:E||w},b);return o&&!O||x[T]===L||d(x,T,L,{name:g}),p[e]=L,b}},1103:t=>{"use strict";t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},1181:(t,e,n)=>{"use strict";var i,r,o,s=n(8622),a=n(2195),c=n(34),u=n(6699),l=n(9297),f=n(7629),h=n(6119),d=n(421),g="Object already initialized",p=a.TypeError,v=a.WeakMap;if(s||f.state){var I=f.state||(f.state=new v);I.get=I.get,I.has=I.has,I.set=I.set,i=function(t,e){if(I.has(t))throw new p(g);return e.facade=t,I.set(t,e),e},r=function(t){return I.get(t)||{}},o=function(t){return I.has(t)}}else{var _=h("state");d[_]=!0,i=function(t,e){if(l(t,_))throw new p(g);return e.facade=t,u(t,_,e),e},r=function(t){return l(t,_)?t[_]:{}},o=function(t){return l(t,_)}}t.exports={set:i,get:r,has:o,enforce:function(t){return o(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=r(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return n}}}},1278:(t,e,n)=>{"use strict";var i=n(6518),r=n(3724),o=n(5031),s=n(5397),a=n(7347),c=n(4659);i({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(t){for(var e,n,i=s(t),r=a.f,u=o(i),l={},f=0;u.length>f;)void 0!==(n=r(i,e=u[f++]))&&c(l,e,n);return l}})},1291:(t,e,n)=>{"use strict";var i=n(741);t.exports=function(t){var e=+t;return e!=e||0===e?0:i(e)}},1296:(t,e,n)=>{"use strict";var i=n(4495);t.exports=i&&!!Symbol.for&&!!Symbol.keyFor},1392:(t,e,n)=>{"use strict";var i,r=n(6518),o=n(7476),s=n(7347).f,a=n(8014),c=n(655),u=n(511),l=n(7750),f=n(1436),h=n(6395),d=o("".slice),g=Math.min,p=f("startsWith");r({target:"String",proto:!0,forced:!(!h&&!p&&(i=s(String.prototype,"startsWith"),i&&!i.writable)||p)},{startsWith:function(t){var e=c(l(this));u(t);var n=a(g(arguments.length>1?arguments[1]:void 0,e.length)),i=c(t);return d(e,n,n+i.length)===i}})},1415:(t,e,n)=>{"use strict";n(2405)},1436:(t,e,n)=>{"use strict";var i=n(8227)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(t){}}return!1}},1469:(t,e,n)=>{"use strict";var i=n(7433);t.exports=function(t,e){return new(i(t))(0===e?0:e)}},1481:(t,e,n)=>{"use strict";var i=n(6518),r=n(6043);i({target:"Promise",stat:!0,forced:n(916).CONSTRUCTOR},{reject:function(t){var e=r.f(this);return(0,e.reject)(t),e.promise}})},1510:(t,e,n)=>{"use strict";var i=n(6518),r=n(7751),o=n(9297),s=n(655),a=n(5745),c=n(1296),u=a("string-to-symbol-registry"),l=a("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!c},{for:function(t){var e=s(t);if(o(u,e))return u[e];var n=r("Symbol")(e);return u[e]=n,l[n]=e,n}})},1625:(t,e,n)=>{"use strict";var i=n(9504);t.exports=i({}.isPrototypeOf)},1629:(t,e,n)=>{"use strict";var i=n(6518),r=n(235);i({target:"Array",proto:!0,forced:[].forEach!==r},{forEach:r})},1688:(t,e,n)=>{"use strict";var i=n(6518),r=n(380);i({target:"Date",proto:!0,forced:Date.prototype.toISOString!==r},{toISOString:r})},1699:(t,e,n)=>{"use strict";var i=n(6518),r=n(9504),o=n(511),s=n(7750),a=n(655),c=n(1436),u=r("".indexOf);i({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~u(a(s(this)),a(o(t)),arguments.length>1?arguments[1]:void 0)}})},1734:(t,e,n)=>{"use strict";n.d(e,{FSFetchReasons:()=>i});var i=function(t){return t.UPDATE_CONTEXT="UPDATE_CONTEXT",t.AUTHENTICATE="AUTHENTICATE",t.UNAUTHENTICATE="UNAUTHENTICATE",t.FLAGS_FETCHING_ERROR="FLAGS_FETCHING_ERROR",t.FLAGS_FETCHED_FROM_CACHE="FLAGS_FETCHED_FROM_CACHE",t.FLAGS_NEVER_FETCHED="FLAGS_NEVER_FETCHED",t.NONE="NONE",t}({})},1828:(t,e,n)=>{"use strict";var i=n(9504),r=n(9297),o=n(5397),s=n(9617).indexOf,a=n(421),c=i([].push);t.exports=function(t,e){var n,i=o(t),u=0,l=[];for(n in i)!r(a,n)&&r(i,n)&&c(l,n);for(;e.length>u;)r(i,n=e[u++])&&(~s(l,n)||c(l,n));return l}},1951:(t,e,n)=>{"use strict";var i=n(8227);e.f=i},1955:(t,e,n)=>{"use strict";var i,r,o,s,a,c=n(2195),u=n(3389),l=n(6080),f=n(9225).set,h=n(8265),d=n(9544),g=n(4265),p=n(7860),v=n(6193),I=c.MutationObserver||c.WebKitMutationObserver,_=c.document,y=c.process,E=c.Promise,T=u("queueMicrotask");if(!T){var A=new h,S=function(){var t,e;for(v&&(t=y.domain)&&t.exit();e=A.get();)try{e()}catch(t){throw A.head&&i(),t}t&&t.enter()};d||v||p||!I||!_?!g&&E&&E.resolve?((s=E.resolve(void 0)).constructor=E,a=l(s.then,s),i=function(){a(S)}):v?i=function(){y.nextTick(S)}:(f=l(f,c),i=function(){f(S)}):(r=!0,o=_.createTextNode(""),new I(S).observe(o,{characterData:!0}),i=function(){o.data=r=!r}),T=function(t){A.head||i(),A.add(t)}}t.exports=T},2003:(t,e,n)=>{"use strict";var i=n(6518),r=n(6395),o=n(916).CONSTRUCTOR,s=n(550),a=n(7751),c=n(4901),u=n(6840),l=s&&s.prototype;if(i({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(t){return this.then(void 0,t)}}),!r&&c(s)){var f=a("Promise").prototype.catch;l.catch!==f&&u(l,"catch",f,{unsafe:!0})}},2008:(t,e,n)=>{"use strict";var i=n(6518),r=n(9213).filter;i({target:"Array",proto:!0,forced:!n(597)("filter")},{filter:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},2010:(t,e,n)=>{"use strict";var i=n(3724),r=n(350).EXISTS,o=n(9504),s=n(2106),a=Function.prototype,c=o(a.toString),u=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=o(u.exec);i&&!r&&s(a,"name",{configurable:!0,get:function(){try{return l(u,c(this))[1]}catch(t){return""}}})},2062:(t,e,n)=>{"use strict";var i=n(6518),r=n(9213).map;i({target:"Array",proto:!0,forced:!n(597)("map")},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},2087:(t,e,n)=>{"use strict";var i=n(34),r=Math.floor;t.exports=Number.isInteger||function(t){return!i(t)&&isFinite(t)&&r(t)===t}},2106:(t,e,n)=>{"use strict";var i=n(283),r=n(4913);t.exports=function(t,e,n){return n.get&&i(n.get,e,{getter:!0}),n.set&&i(n.set,e,{setter:!0}),r.f(t,e,n)}},2140:(t,e,n)=>{"use strict";var i={};i[n(8227)("toStringTag")]="z",t.exports="[object z]"===String(i)},2195:function(t,e,n){"use strict";var i=function(t){return t&&t.Math===Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||i("object"==typeof this&&this)||function(){return this}()||Function("return this")()},2211:(t,e,n)=>{"use strict";var i=n(9039);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},2259:(t,e,n)=>{"use strict";n(2892)("iterator")},2284:(t,e,n)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}n.d(e,{default:()=>i})},2293:(t,e,n)=>{"use strict";var i=n(8551),r=n(5548),o=n(4117),s=n(8227)("species");t.exports=function(t,e){var n,a=i(t).constructor;return void 0===a||o(n=i(a)[s])?e:r(n)}},2333:(t,e,n)=>{"use strict";var i=n(1291),r=n(655),o=n(7750),s=RangeError;t.exports=function(t){var e=r(o(this)),n="",a=i(t);if(a<0||a===1/0)throw new s("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(n+=e);return n}},2357:(t,e,n)=>{"use strict";var i=n(3724),r=n(9039),o=n(9504),s=n(2787),a=n(1072),c=n(5397),u=o(n(8773).f),l=o([].push),f=i&&r((function(){var t=Object.create(null);return t[2]=2,!u(t,2)})),h=function(t){return function(e){for(var n,r=c(e),o=a(r),h=f&&null===s(r),d=o.length,g=0,p=[];d>g;)n=o[g++],i&&!(h?n in r:u(r,n))||l(p,t?[n,r[n]]:r[n]);return p}};t.exports={entries:h(!0),values:h(!1)}},2360:(t,e,n)=>{"use strict";var i,r=n(8551),o=n(6801),s=n(8727),a=n(421),c=n(397),u=n(4055),l=n(6119),f="prototype",h="script",d=l("IE_PROTO"),g=function(){},p=function(t){return"<"+h+">"+t+"</"+h+">"},v=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},I=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;I="undefined"!=typeof document?document.domain&&i?v(i):(e=u("iframe"),n="java"+h+":",e.style.display="none",c.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F):v(i);for(var r=s.length;r--;)delete I[f][s[r]];return I()};a[d]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(g[f]=r(t),n=new g,g[f]=null,n[d]=t):n=I(),void 0===e?n:o.f(n,e)}},2405:(t,e,n)=>{"use strict";n(6468)("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(6938))},2478:(t,e,n)=>{"use strict";var i=n(9504),r=n(8981),o=Math.floor,s=i("".charAt),a=i("".replace),c=i("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,i,f,h){var d=n+t.length,g=i.length,p=l;return void 0!==f&&(f=r(f),p=u),a(h,p,(function(r,a){var u;switch(s(a,0)){case"$":return"$";case"&":return t;case"`":return c(e,0,n);case"'":return c(e,d);case"<":u=f[c(a,1,-1)];break;default:var l=+a;if(0===l)return r;if(l>g){var h=o(l/10);return 0===h?r:h<=g?void 0===i[h-1]?s(a,1):i[h-1]+s(a,1):r}u=i[l-1]}return void 0===u?"":u}))}},2480:(t,e,n)=>{"use strict";n(5081)},2529:t=>{"use strict";t.exports=function(t,e){return{value:t,done:e}}},2637:(t,e,n)=>{"use strict";n(6518)({target:"Number",stat:!0},{isInteger:n(2087)})},2652:(t,e,n)=>{"use strict";var i=n(6080),r=n(9565),o=n(8551),s=n(6823),a=n(4209),c=n(6198),u=n(1625),l=n(81),f=n(851),h=n(9539),d=TypeError,g=function(t,e){this.stopped=t,this.result=e},p=g.prototype;t.exports=function(t,e,n){var v,I,_,y,E,T,A,S=n&&n.that,m=!(!n||!n.AS_ENTRIES),C=!(!n||!n.IS_RECORD),O=!(!n||!n.IS_ITERATOR),k=!(!n||!n.INTERRUPTED),b=i(e,S),R=function(t){return v&&h(v,"normal",t),new g(!0,t)},N=function(t){return m?(o(t),k?b(t[0],t[1],R):b(t[0],t[1])):k?b(t,R):b(t)};if(C)v=t.iterator;else if(O)v=t;else{if(!(I=f(t)))throw new d(s(t)+" is not iterable");if(a(I)){for(_=0,y=c(t);y>_;_++)if((E=N(t[_]))&&u(p,E))return E;return new g(!1)}v=l(t,I)}for(T=C?t.next:v.next;!(A=r(T,v)).done;){try{E=N(A.value)}catch(t){h(v,"throw",t)}if("object"==typeof E&&E&&u(p,E))return E}return new g(!1)}},2675:(t,e,n)=>{"use strict";n(6761),n(1510),n(7812),n(3110),n(9773)},2703:(t,e,n)=>{"use strict";var i=n(2195),r=n(9039),o=n(9504),s=n(655),a=n(3802).trim,c=n(7452),u=i.parseInt,l=i.Symbol,f=l&&l.iterator,h=/^[+-]?0x/i,d=o(h.exec),g=8!==u(c+"08")||22!==u(c+"0x16")||f&&!r((function(){u(Object(f))}));t.exports=g?function(t,e){var n=a(s(t));return u(n,e>>>0||(d(h,n)?16:10))}:u},2744:(t,e,n)=>{"use strict";var i=n(9039);t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},2777:(t,e,n)=>{"use strict";var i=n(9565),r=n(34),o=n(757),s=n(5966),a=n(4270),c=n(8227),u=TypeError,l=c("toPrimitive");t.exports=function(t,e){if(!r(t)||o(t))return t;var n,c=s(t,l);if(c){if(void 0===e&&(e="default"),n=i(c,t,e),!r(n)||o(n))return n;throw new u("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},2787:(t,e,n)=>{"use strict";var i=n(9297),r=n(4901),o=n(8981),s=n(6119),a=n(2211),c=s("IE_PROTO"),u=Object,l=u.prototype;t.exports=a?u.getPrototypeOf:function(t){var e=o(t);if(i(e,c))return e[c];var n=e.constructor;return r(n)&&e instanceof n?n.prototype:e instanceof u?l:null}},2796:(t,e,n)=>{"use strict";var i=n(9039),r=n(4901),o=/#|\.prototype\./,s=function(t,e){var n=c[a(t)];return n===l||n!==u&&(r(e)?i(e):!!e)},a=s.normalize=function(t){return String(t).replace(o,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",l=s.POLYFILL="P";t.exports=s},2812:t=>{"use strict";var e=TypeError;t.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}},2839:(t,e,n)=>{"use strict";var i=n(2195).navigator,r=i&&i.userAgent;t.exports=r?String(r):""},2892:(t,e,n)=>{"use strict";var i=n(9167),r=n(9297),o=n(1951),s=n(4913).f;t.exports=function(t){var e=i.Symbol||(i.Symbol={});r(e,t)||s(e,t,{value:o.f(t)})}},2901:(t,e,n)=>{"use strict";n.d(e,{default:()=>o});var i=n(816);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(0,i.default)(r.key),r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}},2932:(t,e,n)=>{"use strict";n.d(e,{ACTION_TRACKING:()=>Xn,ACTION_TRACKING_DISPATCHED:()=>ti,ACTION_TRACKING_HIT_RECEIVED:()=>Jn,ACTION_TRACKING_INVALID_HIT:()=>Zn,ACTION_TRACKING_INVALID_NONCE:()=>$n,ACTIVATE_ADDED_IN_QUEUE:()=>Et,ACTIVATE_HIT:()=>Qn,ADD_ACTIVATE:()=>mt,ADD_TROUBLESHOOTING_HIT:()=>At,ADD_USAGE_HIT:()=>St,ALLOCATION:()=>On,ALL_HITS_FLUSHED:()=>Vn,ANALYTICS_HIT_ADDED_IN_QUEUE:()=>yt,ANALYTICS_HIT_SENT_SUCCESS:()=>Ot,ANALYTIC_HIT_ALLOCATION:()=>g,ANONYMOUS_ID:()=>Kt,AUTHENTICATE:()=>yn,BASE_API_URL:()=>A,BATCH:()=>Ut,BATCH_HIT:()=>qn,BATCH_LOOP_STARTED:()=>Un,BATCH_LOOP_STOPPED:()=>jn,BATCH_MAX_SIZE:()=>d,BUCKETING_API_URL:()=>O,BUCKETING_NEW_ALLOCATION:()=>bn,BUCKETING_POOLING_STARTED:()=>Ne,BUCKETING_POOLING_STOPPED:()=>De,BUCKETING_VARIATION_CACHE:()=>kn,CDN_ACCOUNT_SETTINGS_URL:()=>Y,CLEAR_CONTEXT:()=>We,CLICK_PATH_DELAY_MS:()=>E,CLIENT_CACHE_KEY:()=>nt,CONSENT_CHANGED:()=>Xe,CONSENT_NOT_SPECIFY_WARNING:()=>zn,CONTEXT_KEY_ERROR:()=>Ke,CONTEXT_KEY_VALUE_UPDATE:()=>Ye,CONTEXT_NULL_ERROR:()=>ht,CONTEXT_VALUE_ERROR:()=>Qe,CUSTOMER_ENV_ID_API_ACTIVATE:()=>jt,CUSTOMER_ENV_ID_API_ITEM:()=>Gt,CUSTOMER_UID:()=>Bt,DEFAULT_BROWSER_POOL_MAX_SIZE:()=>h,DEFAULT_BROWSER_TIME_INTERVAL:()=>f,DEFAULT_DEDUPLICATION_TIME:()=>a,DEFAULT_HIT_CACHE_TIME_MS:()=>ot,DEFAULT_POLLING_INTERVAL:()=>c,DEFAULT_SERVER_POOL_MAX_SIZE:()=>l,DEFAULT_SERVER_TIME_INTERVAL:()=>u,DIRECT_HIT:()=>Yn,DL_API_ITEM:()=>Zt,DS_API_ITEM:()=>Wt,EAI_SCORE_CONTEXT_KEY:()=>et,EMIT_READY:()=>ut,EMOTION_AI_EVENT_URL:()=>W,EMOTION_AI_UC_URL:()=>q,EVENT_ACTION_API_ITEM:()=>Ie,EVENT_CATEGORY_API_ITEM:()=>ve,EVENT_LABEL_API_ITEM:()=>_e,EVENT_VALUE_API_ITEM:()=>ye,EXPOSE_ALL_KEYS:()=>G,FETCH_CAMPAIGNS_FROM_CACHE:()=>$e,FETCH_CAMPAIGNS_SUCCESS:()=>Ze,FETCH_EAI_SCORE:()=>Z,FETCH_EAI_SCORE_ERROR:()=>$,FETCH_EAI_SCORE_SUCCESS:()=>tt,FETCH_FLAGS_BUFFERING_MESSAGE:()=>Nt,FETCH_FLAGS_FROM_CAMPAIGNS:()=>tn,FETCH_FLAGS_PANIC_MODE:()=>nn,FETCH_FLAGS_STARTED:()=>en,FETCH_FLAG_BUFFERING_DEFAULT_TIME:()=>s,FLAGSHIP_SDK:()=>ct,FLAGSHIP_VISITOR_NOT_AUTHENTICATE:()=>Cn,FLAG_METADATA:()=>pn,FLAG_VALUE:()=>an,FLAG_VISITOR_EXPOSED:()=>dn,FS_CONSENT:()=>j,FS_FORCED_VARIATIONS:()=>K,FS_IS_QA_MODE_ENABLED:()=>B,FS_QA_ASSISTANT:()=>x,FS_QA_ASSISTANT_LOCAL:()=>L,FS_QA_ASSISTANT_SCRIPT_TAG_ID:()=>Q,FS_QA_ASSISTANT_STAGING:()=>P,FS_QA_URL:()=>U,GET_FLAG:()=>cn,GET_FLAG_CAST_ERROR:()=>un,GET_FLAG_MISSING_ERROR:()=>on,GET_FLAG_NOT_FOUND:()=>sn,GET_FLAG_VALUE:()=>ln,GET_THIRD_PARTY_SEGMENT:()=>Wn,HEADER_APPLICATION_JSON:()=>be,HEADER_CONTENT_TYPE:()=>Ce,HEADER_X_API_KEY:()=>me,HEADER_X_SDK_CLIENT:()=>Oe,HEADER_X_SDK_VERSION:()=>ke,HIT_ADDED_IN_QUEUE:()=>Tt,HIT_CACHE_ERROR:()=>wn,HIT_CACHE_LOADED:()=>Mn,HIT_CACHE_SAVED:()=>Hn,HIT_CACHE_VERSION:()=>rt,HIT_DATA_FLUSHED:()=>Fn,HIT_EVENT_URL:()=>S,HIT_SENT_SUCCESS:()=>Kn,ICN_API_ITEM:()=>oe,IC_API_ITEM:()=>fe,INITIALIZATION_PARAM_ERROR:()=>ft,INITIALIZATION_STARTING:()=>Re,IN_API_ITEM:()=>le,IP_API_ITEM:()=>he,IQ_API_ITEM:()=>de,IV_API_ITEM:()=>ge,LOOKUP_VISITOR_JSON_OBJECT_ERROR:()=>Rn,MAX_ACTIVATE_HIT_PER_BATCH:()=>st,MAX_CLICK_PATH_LENGTH:()=>I,MAX_COLLECTING_TIME_MS:()=>p,MAX_LAST_COLLECTING_TIME_MS:()=>v,MAX_SCORING_POLLING_TIME:()=>_,METADATA_PANIC_MODE:()=>_n,METADATA_SDK_NOT_READY:()=>In,METHOD_DEACTIVATED_CONSENT_ERROR:()=>vt,METHOD_DEACTIVATED_ERROR:()=>It,NEW_VISITOR_NOT_READY:()=>wt,NO_FLAG_METADATA:()=>vn,PM_API_ITEM:()=>ae,POLLING_EVENT_200:()=>xe,POLLING_EVENT_300:()=>Pe,POLLING_EVENT_FAILED:()=>Le,PREDEFINED_CONTEXT_LOADED:()=>Be,PREDEFINED_CONTEXT_TYPE_ERROR:()=>qe,PROCESS_BUCKETING:()=>we,PROCESS_CACHE:()=>Nn,PROCESS_CACHE_HIT:()=>Ht,PROCESS_CLEAR_CONTEXT:()=>ze,PROCESS_FETCHING_FLAGS:()=>rn,PROCESS_FLUSH_HIT:()=>Ft,PROCESS_INITIALIZATION:()=>xt,PROCESS_LOOKUP_HIT:()=>Vt,PROCESS_NEW_VISITOR:()=>Lt,PROCESS_SDK_STATUS:()=>Me,PROCESS_SEND_HIT:()=>Mt,PROCESS_SET_CONSENT:()=>Je,PROCESS_UPDATE_CONTEXT:()=>Pt,QA_ASSISTANT_LOCAL_URL:()=>w,QA_ASSISTANT_PROD_URL:()=>N,QA_ASSISTANT_STAGING_URL:()=>D,QA_MODE_API_ITEM:()=>Jt,QT_API_ITEM:()=>Xt,REQUEST_TIME_OUT:()=>o,SAVE_VISITOR_INSTANCE:()=>Fe,SCORING_INTERVAL:()=>T,SCREEN_RESOLUTION_API_ITEM:()=>Te,SCROLL_END_DELAY_MS:()=>y,SDK_APP:()=>$t,SDK_INFO:()=>r,SDK_STARTED_INFO:()=>at,SDK_STATUS_CHANGED:()=>He,SEND_BATCH:()=>kt,SEND_EAI_EVENT:()=>z,SEND_EAI_EVENT_ERROR:()=>X,SEND_EAI_EVENT_SUCCESS:()=>J,SEND_TROUBLESHOOTING:()=>bt,SEND_USAGE_HIT:()=>Rt,SESSION_NUMBER:()=>Se,SM_API_ITEM:()=>se,S_API_ITEM:()=>pe,TAG_QA_ASSISTANT:()=>M,TAG_QA_ASSISTANT_LOCAL:()=>F,TAG_QA_ASSISTANT_STAGING:()=>H,TAG_QA_URL:()=>V,TA_API_ITEM:()=>ee,TCC_API_ITEM:()=>re,TC_API_ITEM:()=>ie,THIRD_PARTY_SEGMENT_URL:()=>k,TID_API_ITEM:()=>te,TRACKER_MANAGER_MISSING_ERROR:()=>dt,TRACKING_MANAGER:()=>Gn,TRACKING_MANAGER_ERROR:()=>Bn,TROUBLESHOOTING_HIT_ADDED_IN_QUEUE:()=>_t,TROUBLESHOOTING_HIT_URL:()=>m,TROUBLESHOOTING_SENT_SUCCESS:()=>Ct,TRUSTED_QA_ORIGINS:()=>ei,TR_API_ITEM:()=>ce,TS_API_ITEM:()=>ue,TT_API_ITEM:()=>ne,TYPE_ERROR:()=>gt,T_API_ITEM:()=>zt,UNAUTHENTICATE:()=>mn,URL_ACTIVATE_MODIFICATION:()=>R,URL_CAMPAIGNS:()=>b,USAGE_HIT_URL:()=>C,USER_EXPOSED_CAST_ERROR:()=>gn,USER_EXPOSED_FLAG_ERROR:()=>fn,USER_IP_API_ITEM:()=>Ee,USER_LANGUAGE:()=>Ae,VARIATION_GROUP_ID_API_ITEM_ACTIVATE:()=>qt,VARIATION_ID_API_ITEM:()=>Yt,VISITOR_ALREADY_AUTHENTICATE:()=>Tn,VISITOR_AUTHENTICATE:()=>En,VISITOR_AUTHENTICATE_VISITOR_ID_ERROR:()=>An,VISITOR_CACHE_ERROR:()=>Dn,VISITOR_CACHE_FLUSHED:()=>Ln,VISITOR_CACHE_LOADED:()=>xn,VISITOR_CACHE_SAVED:()=>Pn,VISITOR_CACHE_VERSION:()=>it,VISITOR_CREATED:()=>Ve,VISITOR_EXPOSED_VALUE_NOT_CALLED:()=>hn,VISITOR_ID_API_ITEM:()=>Qt,VISITOR_ID_ERROR:()=>pt,VISITOR_ID_FROM_AB_TASTY_TAG:()=>Ge,VISITOR_ID_GENERATED:()=>je,VISITOR_PROFILE_LOADED:()=>Ue,VISITOR_SYNC_FLAGS_MESSAGE:()=>Dt,VISITOR_UNAUTHENTICATE:()=>Sn});var i=n(4116),r={name:"TypeScript",version:i.version},o=2,s=2,a=2.5,c=5,u=10,l=100,f=5,h=10,d=25e5,g=1,p=3e4,v=12e4,I=1900,_=12e4,y=200,E=500,T=5e3,A="https://decision.flagship.io/v2/",S="https://events.flagship.io",m="https://events.flagship.io/troubleshooting",C="https://events.flagship.io/analytics",O="https://cdn.flagship.io/{0}/bucketing.json",k="https://api-data-connector.flagship.io/accounts/{0}/segments/{1}",b="/campaigns",R="activate",N="https://qa-assistant.flagship.io/bundle.js",D="https://staging-qa-assistant.flagship.io/bundle.js",w="https://local-qa-assistant.flagship.io:5000/bundle.js",x="fs_qa_assistant",P="fs_qa_assistant_staging",L="fs_qa_assistant_local",M="abtasty_qa_assistant",H="abtasty_qa_assistant_staging",F="abtasty_qa_assistant_local",V="qa-assistant.abtasty.com",U="qa-assistant.flagship.io",G="exposeAllKeys",j="fs_consent",B="FS_IS_QA_MODE_ENABLED",K="FS_FORCED_VARIATIONS",Q="FS_QA_ASSISTANT_SCRIPT_TAG_ID",q="https://uc-info.flagship.io/v1/segments/clients/{0}/visitors/{1}",Y="https://cdn.flagship.io/{0}/accountSettings.json",W="https://events.flagship.io/emotionsai",z="sendEAIEvent",X="Failed to send Emotion AI event: {0}",J="Emotion AI event sent: {0}",Z="fetchEAIScore",$="visitor {0}, Failed to fetch EAIScore: {1}",tt="visitor {0}, EAIScore fetched: {1}",et="eai::eas",nt="FS_CLIENT_VISITOR",it=1,rt=1,ot=144e5,st=100,at="Flagship SDK (version: {0}) {1} in **{2}** mode",ct="Flagship SDK",ut="ready",lt="https://docs.developers.flagship.io/docs/js-v3",ft="Params 'envId' and 'apiKey' must not be null or empty.\n  Learn more: ".concat(lt,"#initialization"),ht="Context must not to be null",dt="trackerManager must not be null.",gt="{0} must be a {1}",pt="visitorId must not be null or empty",vt="Method {0} is deactivated for visitor {1} : visitor did not consent.",It="Visitor {0}, method {1} is deactivated while SDK status is: {2}.",_t="The TROUBLESHOOTING HIT has been added to the pool queue : {0}",yt="The USAGE HIT has been added to the pool queue : {0}",Et="The ACTIVATE has been added to the pool queue : {0}",Tt="The HIT has been added into the pool queue : {0}",At="ADD TROUBLESHOOTING HIT",St="ADD USAGE HIT",mt="ADD ACTIVATE",Ct="Troubleshooting hit has been sent : {0}",Ot="Usage hit has been sent : {0}",kt="SEND BATCH",bt="SEND TROUBLESHOOTING",Rt="SEND USAGE HIT",Nt="Visitor {0}, fetchFlags has been ignored and will continue to be ignored for the next {1}ms, this delay can be changed with `fetchFlagsBufferingTime` option in the SDK config",Dt="without calling `fetchFlags` method afterwards. So, the value of the flag `{1}` might be outdated",wt='You can\'t create a new visitor without first calling the "Flagship.start" method.\nLearn more: '.concat(lt,"#initialization\n"),xt="INITIALIZATION",Pt="UPDATE CONTEXT",Lt="NEW VISITOR",Mt="ADD HIT",Ht="CACHE HIT",Ft="FLUSH HIT",Vt="LOOKUP HIT",Ut="batch",Gt="cid",jt="cid",Bt="cuid",Kt="aid",Qt="vid",qt="caid",Yt="vaid",Wt="ds",zt="t",Xt="qt",Jt="qa",Zt="dl",$t="APP",te="tid",ee="ta",ne="tt",ie="tc",re="tcc",oe="icn",se="sm",ae="pm",ce="tr",ue="ts",le="in",fe="ic",he="ip",de="iq",ge="iv",pe="s",ve="ec",Ie="ea",_e="el",ye="ev",Ee="uip",Te="sr",Ae="ul",Se="sn",me="x-api-key",Ce="Content-Type",Oe="x-sdk-client",ke="x-sdk-version",be="application/json",Re="Flagship SDK version {0} is starting in {1} mode with config {2}",Ne="Bucketing polling process has been started",De="Bucketing polling process has been stopped",we="BUCKETING",xe="Polling event with code status 200 : {0}",Pe="Polling event with code status 304",Le="Polling event failed with error",Me="SDK STATUS",He="SDK status has changed:  {0}",Fe="Visitor {0} has been saved in SDK instance",Ve="Visitor {0} has been created with context {1}, isAuthenticated:{2} and hasConsented {3}",Ue="Visitor profile has been loaded {0}",Ge="The visitor ID '{0}' has been retrieved from ABTasty tag",je="Visitor identifier is empty. A UUID {0} has been generated.",Be="Predefined Context have been loaded {0}",Ke="Visitor {0}, the key '{1}' must be a non null String.\nLearn more: ".concat(lt,"#updating-the-visitor-context"),Qe="Visitor {0}, 'value' for key '{1}[], must be one of the following types : String, Number, Boolean\nLearn more: ".concat(lt,"#updating-the-visitor-context"),qe="visitor {0}, Predefined Context {0} must be of type {1}\nLearn more: ".concat(lt,"#predefined-user-context-keys-"),Ye="visitor `{0}`, context have been updated: key {1}, value {2}, Context {3}",We="visitor `{0}`, context has been cleared cleared `{1}`",ze="CLEAR_CONTEXT",Xe="Visitor `{0}` consent has been changed : {1}",Je="SET_CONSENT",Ze="Visitor {0}, anonymousId {1} with context {2} has just fetched campaigns {3} in {4} ms",$e="Visitor {0}, anonymousId {1} with context {2} has just fetched campaigns from cache {3} in {4} ms",tn="Visitor {0}, anonymousId {1} with context {2} has just fetched flags {3} from Campaigns",en="visitor `{0}` fetchFlags process is started",nn="Panic mode is enabled : all feature are disabled except fetchFlags.",rn="FETCH_FLAGS",on='For the visitor "{0}", no flags were found with the key "{1}". Therefore, the default value "{2}" has been returned.',sn='For the visitor "{0}", no flags were found with the key "{1}". Therefore, an empty flag has been returned.',an="FLAG_VALUE",cn="GET_FLAG",un='For the visitor "{0}", the flag with key "{1}" has a different type compared to the default value. Therefore, the default value "{2}" has been returned.',ln="Visitor {0}, Flag for key {1} returns value {2}",fn='For the visitor "{0}", no flags were found with the key "{1}". As a result, user exposure will not be sent.',hn="For the visitor `{0}`,assuming the getValue() method has not previously been invoked for the flag `{0}`. Therefore, the exposure is canceled",dn="FLAG_VISITOR_EXPOSED",gn="For the visitor `{0}, the flag with the key `{0}` has a different type compared to the default value. Therefore, the exposure is interrupted",pn="FLAG_METADATA",vn="Visitor {0}, No Flags found for key {1}:  Empty metadata object is returned",In="Visitor {0}, Flag for key {1} Method Flag.metadata is deactivated while SDK status is NOT_READY: Empty metadata object is returned {2}\nLearn more: ".concat(lt,"#getting-flags-campaigns-metadata"),_n="Visitor {0}, Flag for key {1} Method Flag.metadata is deactivated while SDK status is PANIC: Empty metadata object is returned {2}\nLearn more: ".concat("https://docs.developers.flagship.io/docs/glossary#panic-mode"),yn="AUTHENTICATE",En="The visitor is authenticated with new visitor ID {0} anonymous ID {1}",Tn="The visitor is already authenticated with visitor ID {0}",An="Visitor {0}, visitorId must not be null or empty\nLearn more: ".concat(lt,"#authenticate"),Sn="The visitor is unauthenticated with visitor ID {0}",mn="UNAUTHENTICATE",Cn="Visitor {0} is not authenticated yet",On="ALLOCATION",kn="Visitor {0}, Variation {1} selected from cache.",bn="Visitor {0}, Variation {1} selected with allocation {2}.",Rn="lookupVisitor method has loaded a bad format version ({0}) for visitor {1}.\nLearn more: ".concat(lt,"#managing-visitor-cache"),Nn="CACHE",Dn="visitor {0}. {1} threw an exception {2}",wn="{0} threw an exception {1}",xn="Visitor {0}, visitor cache has been loaded from database: {1}",Pn="Visitor {0}, visitor cache has been saved into database : {0}",Ln="Visitor {0}, visitor cache has been flushed from database.",Mn="Hits cache has been loaded from database: {0}",Hn="Hit cache has been saved into database : {0}",Fn="The following hit keys have been flushed from database : {0}",Vn="All hits cache has been flushed from database",Un="The Batch Loop has been started with a time interval of {0} ms",Gn="TRACKING_MANAGER",jn="The Batch Loop has been stopped",Bn="{0} Unexpected Error occurred {1}",Kn="{0} has been sent : {1}",Qn="ACTIVATE HIT",qn="BATCH HIT",Yn="HIT",Wn="GET_THIRD_PARTY_SEGMENT",zn="Consent has not been specified. By default, consent is set to false, which may result in some features being deactivated.",Xn="Action Tracking",Jn="Hit received: {0}",Zn="Invalid hit data: {0}",$n="Invalid nonce: {0}",ti="action tracking hits have been dispatched {0}",ei=["https://local-qa-assistant.abtasty.com:5000","https://staging-qa-assistant.abtasty.com","https://qa-assistant.abtasty.com","https://qa-assistant.flagship.io","https://local-qa-assistant.flagship.io:5000","https://staging-qa-assistant.flagship.io"]},2953:(t,e,n)=>{"use strict";var i=n(2195),r=n(7400),o=n(9296),s=n(3792),a=n(6699),c=n(687),u=n(8227)("iterator"),l=s.values,f=function(t,e){if(t){if(t[u]!==l)try{a(t,u,l)}catch(e){t[u]=l}if(c(t,e,!0),r[e])for(var n in s)if(t[n]!==s[n])try{a(t,n,s[n])}catch(e){t[n]=s[n]}}};for(var h in r)f(i[h]&&i[h].prototype,h);f(o,"DOMTokenList")},2967:(t,e,n)=>{"use strict";var i=n(6706),r=n(34),o=n(7750),s=n(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=i(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,i){return o(n),s(i),r(n)?(e?t(n,i):n.__proto__=i,n):n}}():void 0)},3063:(t,e,n)=>{"use strict";var i=n(2839);t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(i)},3110:(t,e,n)=>{"use strict";var i=n(6518),r=n(7751),o=n(8745),s=n(9565),a=n(9504),c=n(9039),u=n(4901),l=n(757),f=n(7680),h=n(6933),d=n(4495),g=String,p=r("JSON","stringify"),v=a(/./.exec),I=a("".charAt),_=a("".charCodeAt),y=a("".replace),E=a(1..toString),T=/[\uD800-\uDFFF]/g,A=/^[\uD800-\uDBFF]$/,S=/^[\uDC00-\uDFFF]$/,m=!d||c((function(){var t=r("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))})),C=c((function(){return'"\\udf06\\ud834"'!==p("\udf06\ud834")||'"\\udead"'!==p("\udead")})),O=function(t,e){var n=f(arguments),i=h(e);if(u(i)||void 0!==t&&!l(t))return n[1]=function(t,e){if(u(i)&&(e=s(i,this,g(t),e)),!l(e))return e},o(p,null,n)},k=function(t,e,n){var i=I(n,e-1),r=I(n,e+1);return v(A,t)&&!v(S,r)||v(S,t)&&!v(A,i)?"\\u"+E(_(t,0),16):t};p&&i({target:"JSON",stat:!0,arity:3,forced:m||C},{stringify:function(t,e,n){var i=f(arguments),r=o(m?O:p,null,i);return C&&"string"==typeof r?y(r,T,k):r}})},3138:t=>{"use strict";t.exports=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}}},3167:(t,e,n)=>{"use strict";var i=n(4901),r=n(34),o=n(2967);t.exports=function(t,e,n){var s,a;return o&&i(s=e.constructor)&&s!==n&&r(a=s.prototype)&&a!==n.prototype&&o(t,a),t}},3179:(t,e,n)=>{"use strict";var i=n(2140),r=n(6955);t.exports=i?{}.toString:function(){return"[object "+r(this)+"]"}},3362:(t,e,n)=>{"use strict";n(436),n(6499),n(2003),n(7743),n(1481),n(280)},3389:(t,e,n)=>{"use strict";var i=n(2195),r=n(3724),o=Object.getOwnPropertyDescriptor;t.exports=function(t){if(!r)return i[t];var e=o(i,t);return e&&e.value}},3392:(t,e,n)=>{"use strict";var i=n(9504),r=0,o=Math.random(),s=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++r+o,36)}},3418:(t,e,n)=>{"use strict";var i=n(6518),r=n(7916);i({target:"Array",stat:!0,forced:!n(4428)((function(t){Array.from(t)}))},{from:r})},3438:(t,e,n)=>{"use strict";var i=n(8551),r=n(34),o=n(6043);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},3451:(t,e,n)=>{"use strict";var i=n(6518),r=n(9504),o=n(421),s=n(34),a=n(9297),c=n(4913).f,u=n(8480),l=n(298),f=n(4124),h=n(3392),d=n(2744),g=!1,p=h("meta"),v=0,I=function(t){c(t,p,{value:{objectID:"O"+v++,weakData:{}}})},_=t.exports={enable:function(){_.enable=function(){},g=!0;var t=u.f,e=r([].splice),n={};n[p]=1,t(n).length&&(u.f=function(n){for(var i=t(n),r=0,o=i.length;r<o;r++)if(i[r]===p){e(i,r,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:l.f}))},fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,p)){if(!f(t))return"F";if(!e)return"E";I(t)}return t[p].objectID},getWeakData:function(t,e){if(!a(t,p)){if(!f(t))return!0;if(!e)return!1;I(t)}return t[p].weakData},onFreeze:function(t){return d&&g&&f(t)&&!a(t,p)&&I(t),t}};o[p]=!0},3500:(t,e,n)=>{"use strict";var i=n(2195),r=n(7400),o=n(9296),s=n(235),a=n(6699),c=function(t){if(t&&t.forEach!==s)try{a(t,"forEach",s)}catch(e){t.forEach=s}};for(var u in r)r[u]&&c(i[u]&&i[u].prototype);c(o)},3506:(t,e,n)=>{"use strict";var i=n(3925),r=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw new o("Can't set "+r(t)+" as a prototype")}},3517:(t,e,n)=>{"use strict";var i=n(9504),r=n(9039),o=n(4901),s=n(6955),a=n(7751),c=n(3706),u=function(){},l=a("Reflect","construct"),f=/^\s*(?:class|function)\b/,h=i(f.exec),d=!f.test(u),g=function(t){if(!o(t))return!1;try{return l(u,[],t),!0}catch(t){return!1}},p=function(t){if(!o(t))return!1;switch(s(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return d||!!h(f,c(t))}catch(t){return!0}};p.sham=!0,t.exports=!l||r((function(){var t;return g(g.call)||!g(Object)||!g((function(){t=!0}))||t}))?p:g},3635:(t,e,n)=>{"use strict";var i=n(9039),r=n(2195).RegExp;t.exports=i((function(){var t=r(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)}))},3706:(t,e,n)=>{"use strict";var i=n(9504),r=n(4901),o=n(7629),s=i(Function.toString);r(o.inspectSource)||(o.inspectSource=function(t){return s(t)}),t.exports=o.inspectSource},3717:(t,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},3724:(t,e,n)=>{"use strict";var i=n(9039);t.exports=!i((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3738:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},3792:(t,e,n)=>{"use strict";var i=n(5397),r=n(6469),o=n(6269),s=n(1181),a=n(4913).f,c=n(1088),u=n(2529),l=n(6395),f=n(3724),h="Array Iterator",d=s.set,g=s.getterFor(h);t.exports=c(Array,"Array",(function(t,e){d(this,{type:h,target:i(t),index:0,kind:e})}),(function(){var t=g(this),e=t.target,n=t.index++;if(!e||n>=e.length)return t.target=null,u(void 0,!0);switch(t.kind){case"keys":return u(n,!1);case"values":return u(e[n],!1)}return u([n,e[n]],!1)}),"values");var p=o.Arguments=o.Array;if(r("keys"),r("values"),r("entries"),!l&&f&&"values"!==p.name)try{a(p,"name",{value:"values"})}catch(t){}},3802:(t,e,n)=>{"use strict";var i=n(9504),r=n(7750),o=n(655),s=n(7452),a=i("".replace),c=RegExp("^["+s+"]+"),u=RegExp("(^|[^"+s+"])["+s+"]+$"),l=function(t){return function(e){var n=o(r(e));return 1&t&&(n=a(n,c,"")),2&t&&(n=a(n,u,"$1")),n}};t.exports={start:l(1),end:l(2),trim:l(3)}},3851:(t,e,n)=>{"use strict";var i=n(6518),r=n(9039),o=n(5397),s=n(7347).f,a=n(3724);i({target:"Object",stat:!0,forced:!a||r((function(){s(1)})),sham:!a},{getOwnPropertyDescriptor:function(t,e){return s(o(t),e)}})},3925:(t,e,n)=>{"use strict";var i=n(34);t.exports=function(t){return i(t)||null===t}},3988:(t,e,n)=>{"use strict";n.r(e),n.d(e,{PageView:()=>r});var i=n(2901),r=function(){return(0,i.default)((function(t){var e=t.customerAccountId,n=t.visitorId,i=t.hasAdBlocker,r=t.screenDepth,o=t.screenSize,s=t.doNotTrack,a=t.fonts,c=t.hasFakeBrowserInfos,u=t.hasFakeLanguageInfos,l=t.hasFakeOsInfos,f=t.hasFakeResolutionInfos,h=t.userLanguage,d=t.deviceCategory,g=t.pixelRatio,p=t.plugins,v=t.documentReferer,I=t.viewportSize,_=t.touchSupport,y=t.currentUrl,E=t.userAgent,T=t.customerUserId,A=t.timezoneOffset,S=t.eventCategory;this._customerAccountId=e,this._visitorId=n,this._hasAdBlocker=i,this._screenDepth=r,this._screenSize=o,this._doNotTrack=s,this._fonts=a,this._hasFakeBrowserInfos=c,this._hasFakeLanguageInfos=u,this._hasFakeOsInfos=l,this._hasFakeResolutionInfos=f,this._userLanguage=h,this._deviceCategory=d,this._pixelRatio=g,this._plugins=p,this._documentReferer=v,this._viewportSize=I,this._touchSupport=_,this._currentUrl=y,this._userAgent=E,this._customerUserId=T,this._timezoneOffset=A,this._eventCategory=S}),[{key:"customerAccountId",get:function(){return this._customerAccountId}},{key:"visitorId",get:function(){return this._visitorId}},{key:"hasAdBlocker",get:function(){return this._hasAdBlocker}},{key:"screenDepth",get:function(){return this._screenDepth}},{key:"screenSize",get:function(){return this._screenSize}},{key:"doNotTrack",get:function(){return this._doNotTrack}},{key:"fonts",get:function(){return this._fonts}},{key:"hasFakeBrowserInfos",get:function(){return this._hasFakeBrowserInfos}},{key:"hasFakeLanguageInfos",get:function(){return this._hasFakeLanguageInfos}},{key:"hasFakeOsInfos",get:function(){return this._hasFakeOsInfos}},{key:"hasFakeResolutionInfos",get:function(){return this._hasFakeResolutionInfos}},{key:"userLanguage",get:function(){return this._userLanguage}},{key:"deviceCategory",get:function(){return this._deviceCategory}},{key:"pixelRatio",get:function(){return this._pixelRatio}},{key:"plugins",get:function(){return this._plugins}},{key:"documentReferer",get:function(){return this._documentReferer}},{key:"viewportSize",get:function(){return this._viewportSize}},{key:"touchSupport",get:function(){return this._touchSupport}},{key:"currentUrl",get:function(){return this._currentUrl}},{key:"userAgent",get:function(){return this._userAgent}},{key:"customerUserId",get:function(){return this._customerUserId}},{key:"timezoneOffset",get:function(){return this._timezoneOffset}},{key:"eventCategory",get:function(){return this._eventCategory}},{key:"toApiKeys",value:function(){var t={cid:this._customerAccountId,vid:this._visitorId,adb:this._hasAdBlocker,sd:this._screenDepth,sr:this._screenSize,dnt:this._doNotTrack,fnt:this._fonts,hlb:this._hasFakeBrowserInfos,hll:this._hasFakeLanguageInfos,hlo:this._hasFakeOsInfos,hlr:this._hasFakeResolutionInfos,ul:this._userLanguage,dc:this._deviceCategory,pxr:this._pixelRatio,dr:this._documentReferer,vp:this._viewportSize,tof:this._timezoneOffset,tsp:this._touchSupport,dl:this._currentUrl,ua:this._userAgent,ec:this._eventCategory,t:"PAGEVIEW"};return this._plugins&&(t.plu=this._plugins),this._customerUserId&&(t.cuid=this._customerUserId),t}}])}()},3994:(t,e,n)=>{"use strict";var i=n(7657).IteratorPrototype,r=n(2360),o=n(6980),s=n(687),a=n(6269),c=function(){return this};t.exports=function(t,e,n,u){var l=e+" Iterator";return t.prototype=r(i,{next:o(+!u,n)}),s(t,l,!1,!0),a[l]=c,t}},4055:(t,e,n)=>{"use strict";var i=n(2195),r=n(34),o=i.document,s=r(o)&&r(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},4116:(t,e,n)=>{"use strict";n.d(e,{version:()=>i});var i="5.1.6"},4117:t=>{"use strict";t.exports=function(t){return null==t}},4124:(t,e,n)=>{"use strict";var i=n(9039),r=n(34),o=n(4576),s=n(5652),a=Object.isExtensible,c=i((function(){a(1)}));t.exports=c||s?function(t){return!!r(t)&&(!s||"ArrayBuffer"!==o(t))&&(!a||a(t))}:a},4209:(t,e,n)=>{"use strict";var i=n(8227),r=n(6269),o=i("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||s[o]===t)}},4215:(t,e,n)=>{"use strict";var i=n(2195),r=n(2839),o=n(4576),s=function(t){return r.slice(0,t.length)===t};t.exports=s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":i.Bun&&"string"==typeof Bun.version?"BUN":i.Deno&&"object"==typeof Deno.version?"DENO":"process"===o(i.process)?"NODE":i.window&&i.document?"BROWSER":"REST"},4265:(t,e,n)=>{"use strict";var i=n(2839);t.exports=/ipad|iphone|ipod/i.test(i)&&"undefined"!=typeof Pebble},4270:(t,e,n)=>{"use strict";var i=n(9565),r=n(4901),o=n(34),s=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&r(n=t.toString)&&!o(a=i(n,t)))return a;if(r(n=t.valueOf)&&!o(a=i(n,t)))return a;if("string"!==e&&r(n=t.toString)&&!o(a=i(n,t)))return a;throw new s("Can't convert object to primitive value")}},4288:(t,e,n)=>{"use strict";n.d(e,{LogLevel:()=>i});var i=function(t){return t[t.NONE=0]="NONE",t[t.EMERGENCY=1]="EMERGENCY",t[t.ALERT=2]="ALERT",t[t.CRITICAL=3]="CRITICAL",t[t.ERROR=4]="ERROR",t[t.WARNING=5]="WARNING",t[t.NOTICE=6]="NOTICE",t[t.INFO=7]="INFO",t[t.DEBUG=8]="DEBUG",t[t.ALL=9]="ALL",t}({})},4376:(t,e,n)=>{"use strict";var i=n(4576);t.exports=Array.isArray||function(t){return"Array"===i(t)}},4423:(t,e,n)=>{"use strict";var i=n(6518),r=n(9617).includes,o=n(9039),s=n(6469);i({target:"Array",proto:!0,forced:o((function(){return!Array(1).includes()}))},{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),s("includes")},4428:(t,e,n)=>{"use strict";var i=n(8227)("iterator"),r=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){r=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(t){}t.exports=function(t,e){try{if(!e&&!r)return!1}catch(t){return!1}var n=!1;try{var o={};o[i]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}},4467:(t,e,n)=>{"use strict";n.d(e,{default:()=>r});var i=n(816);function r(t,e,n){return(e=(0,i.default)(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},4495:(t,e,n)=>{"use strict";var i=n(9519),r=n(9039),o=n(2195).String;t.exports=!!Object.getOwnPropertySymbols&&!r((function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},4576:(t,e,n)=>{"use strict";var i=n(9504),r=i({}.toString),o=i("".slice);t.exports=function(t){return o(r(t),8,-1)}},4598:(t,e,n)=>{"use strict";var i=n(9039);t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){return 1},1)}))}},4633:(t,e,n)=>{var i=n(3738).default;function r(){"use strict";t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var e,n={},o=Object.prototype,s=o.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",f=c.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof E?e:E,o=Object.create(r.prototype),s=new x(i||[]);return a(o,"_invoke",{value:R(t,n,s)}),o}function g(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",v="suspendedYield",I="executing",_="completed",y={};function E(){}function T(){}function A(){}var S={};h(S,u,(function(){return this}));var m=Object.getPrototypeOf,C=m&&m(m(P([])));C&&C!==o&&s.call(C,u)&&(S=C);var O=A.prototype=E.prototype=Object.create(S);function k(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function n(r,o,a,c){var u=g(t[r],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==i(f)&&s.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var r;a(this,"_invoke",{value:function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}})}function R(t,n,i){var r=p;return function(o,s){if(r===I)throw Error("Generator is already running");if(r===_){if("throw"===o)throw s;return{value:e,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var c=N(a,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=_,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=I;var u=g(t,n,i);if("normal"===u.type){if(r=i.done?_:v,u.arg===y)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=_,i.method="throw",i.arg=u.arg)}}}function N(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=g(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(s.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(i(t)+" is not iterable")}return T.prototype=A,a(O,"constructor",{value:A,configurable:!0}),a(A,"constructor",{value:T,configurable:!0}),T.displayName=h(A,f,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===T||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,A):(t.__proto__=A,h(t,f,"GeneratorFunction")),t.prototype=Object.create(O),t},n.awrap=function(t){return{__await:t}},k(b.prototype),h(b.prototype,l,(function(){return this})),n.AsyncIterator=b,n.async=function(t,e,i,r,o){void 0===o&&(o=Promise);var s=new b(d(t,e,i,r),o);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},k(O),h(O,f,"Generator"),h(O,u,(function(){return this})),h(O,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(w),!t)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return a.type="throw",a.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),u=s.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&s.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),w(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;w(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},4659:(t,e,n)=>{"use strict";var i=n(3724),r=n(4913),o=n(6980);t.exports=function(t,e,n){i?r.f(t,e,o(0,n)):t[e]=n}},4756:(t,e,n)=>{var i=n(4633)();t.exports=i;try{regeneratorRuntime=i}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},4782:(t,e,n)=>{"use strict";var i=n(6518),r=n(4376),o=n(3517),s=n(34),a=n(5610),c=n(6198),u=n(5397),l=n(4659),f=n(8227),h=n(597),d=n(7680),g=h("slice"),p=f("species"),v=Array,I=Math.max;i({target:"Array",proto:!0,forced:!g},{slice:function(t,e){var n,i,f,h=u(this),g=c(h),_=a(t,g),y=a(void 0===e?g:e,g);if(r(h)&&(n=h.constructor,(o(n)&&(n===v||r(n.prototype))||s(n)&&null===(n=n[p]))&&(n=void 0),n===v||void 0===n))return d(h,_,y);for(i=new(void 0===n?v:n)(I(y-_,0)),f=0;_<y;_++,f++)_ in h&&l(i,f,h[_]);return i.length=f,i}})},4864:(t,e,n)=>{"use strict";var i=n(3724),r=n(2195),o=n(9504),s=n(2796),a=n(3167),c=n(6699),u=n(2360),l=n(8480).f,f=n(1625),h=n(788),d=n(655),g=n(1034),p=n(8429),v=n(1056),I=n(6840),_=n(9039),y=n(9297),E=n(1181).enforce,T=n(7633),A=n(8227),S=n(3635),m=n(8814),C=A("match"),O=r.RegExp,k=O.prototype,b=r.SyntaxError,R=o(k.exec),N=o("".charAt),D=o("".replace),w=o("".indexOf),x=o("".slice),P=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,L=/a/g,M=/a/g,H=new O(L)!==L,F=p.MISSED_STICKY,V=p.UNSUPPORTED_Y;if(s("RegExp",i&&(!H||F||S||m||_((function(){return M[C]=!1,O(L)!==L||O(M)===M||"/a/i"!==String(O(L,"i"))}))))){for(var U=function(t,e){var n,i,r,o,s,l,p=f(k,this),v=h(t),I=void 0===e,_=[],T=t;if(!p&&v&&I&&t.constructor===U)return t;if((v||f(k,t))&&(t=t.source,I&&(e=g(T))),t=void 0===t?"":d(t),e=void 0===e?"":d(e),T=t,S&&"dotAll"in L&&(i=!!e&&w(e,"s")>-1)&&(e=D(e,/s/g,"")),n=e,F&&"sticky"in L&&(r=!!e&&w(e,"y")>-1)&&V&&(e=D(e,/y/g,"")),m&&(o=function(t){for(var e,n=t.length,i=0,r="",o=[],s=u(null),a=!1,c=!1,l=0,f="";i<=n;i++){if("\\"===(e=N(t,i)))e+=N(t,++i);else if("]"===e)a=!1;else if(!a)switch(!0){case"["===e:a=!0;break;case"("===e:if(r+=e,"?:"===x(t,i+1,i+3))continue;R(P,x(t,i+1))&&(i+=2,c=!0),l++;continue;case">"===e&&c:if(""===f||y(s,f))throw new b("Invalid capture group name");s[f]=!0,o[o.length]=[f,l],c=!1,f="";continue}c?f+=e:r+=e}return[r,o]}(t),t=o[0],_=o[1]),s=a(O(t,e),p?this:k,U),(i||r||_.length)&&(l=E(s),i&&(l.dotAll=!0,l.raw=U(function(t){for(var e,n=t.length,i=0,r="",o=!1;i<=n;i++)"\\"!==(e=N(t,i))?o||"."!==e?("["===e?o=!0:"]"===e&&(o=!1),r+=e):r+="[\\s\\S]":r+=e+N(t,++i);return r}(t),n)),r&&(l.sticky=!0),_.length&&(l.groups=_)),t!==T)try{c(s,"source",""===T?"(?:)":T)}catch(t){}return s},G=l(O),j=0;G.length>j;)v(U,O,G[j++]);k.constructor=U,U.prototype=k,I(r,"RegExp",U,{constructor:!0})}T("RegExp")},4901:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},4913:(t,e,n)=>{"use strict";var i=n(3724),r=n(5917),o=n(8686),s=n(8551),a=n(6969),c=TypeError,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor,f="enumerable",h="configurable",d="writable";e.f=i?o?function(t,e,n){if(s(t),e=a(e),s(n),"function"==typeof t&&"prototype"===e&&"value"in n&&d in n&&!n[d]){var i=l(t,e);i&&i[d]&&(t[e]=n.value,n={configurable:h in n?n[h]:i[h],enumerable:f in n?n[f]:i[f],writable:!1})}return u(t,e,n)}:u:function(t,e,n){if(s(t),e=a(e),s(n),r)try{return u(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},5031:(t,e,n)=>{"use strict";var i=n(7751),r=n(9504),o=n(8480),s=n(3717),a=n(8551),c=r([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=o.f(a(t)),n=s.f;return n?c(e,n(t)):e}},5081:(t,e,n)=>{"use strict";var i=n(6518),r=n(2195);i({global:!0,forced:r.globalThis!==r},{globalThis:r})},5086:(t,e,n)=>{"use strict";var i=n(6518),r=n(9213).some;i({target:"Array",proto:!0,forced:!n(4598)("some")},{some:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},5397:(t,e,n)=>{"use strict";var i=n(7055),r=n(7750);t.exports=function(t){return i(r(t))}},5440:(t,e,n)=>{"use strict";var i=n(8745),r=n(9565),o=n(9504),s=n(9228),a=n(9039),c=n(8551),u=n(4901),l=n(4117),f=n(1291),h=n(8014),d=n(655),g=n(7750),p=n(7829),v=n(5966),I=n(2478),_=n(6682),y=n(8227)("replace"),E=Math.max,T=Math.min,A=o([].concat),S=o([].push),m=o("".indexOf),C=o("".slice),O="$0"==="a".replace(/./,"$0"),k=!!/./[y]&&""===/./[y]("a","$0");s("replace",(function(t,e,n){var o=k?"$":"$0";return[function(t,n){var i=g(this),o=l(t)?void 0:v(t,y);return o?r(o,t,i,n):r(e,d(i),t,n)},function(t,r){var s=c(this),a=d(t);if("string"==typeof r&&-1===m(r,o)&&-1===m(r,"$<")){var l=n(e,s,a,r);if(l.done)return l.value}var g=u(r);g||(r=d(r));var v,y=s.global;y&&(v=s.unicode,s.lastIndex=0);for(var O,k=[];null!==(O=_(s,a))&&(S(k,O),y);)""===d(O[0])&&(s.lastIndex=p(a,h(s.lastIndex),v));for(var b,R="",N=0,D=0;D<k.length;D++){for(var w,x=d((O=k[D])[0]),P=E(T(f(O.index),a.length),0),L=[],M=1;M<O.length;M++)S(L,void 0===(b=O[M])?b:String(b));var H=O.groups;if(g){var F=A([x],L,P,a);void 0!==H&&S(F,H),w=d(i(r,void 0,F))}else w=I(x,a,P,L,H,r);P>=N&&(R+=C(a,N,P)+w,N=P+x.length)}return R+C(a,N)}]}),!!a((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!O||k)},5506:(t,e,n)=>{"use strict";var i=n(6518),r=n(2357).entries;i({target:"Object",stat:!0},{entries:function(t){return r(t)}})},5548:(t,e,n)=>{"use strict";var i=n(3517),r=n(6823),o=TypeError;t.exports=function(t){if(i(t))return t;throw new o(r(t)+" is not a constructor")}},5610:(t,e,n)=>{"use strict";var i=n(1291),r=Math.max,o=Math.min;t.exports=function(t,e){var n=i(t);return n<0?r(n+e,0):o(n,e)}},5652:(t,e,n)=>{"use strict";var i=n(9039);t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},5701:(t,e,n)=>{"use strict";var i=n(6518),r=n(533).end;i({target:"String",proto:!0,forced:n(3063)},{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},5745:(t,e,n)=>{"use strict";var i=n(7629);t.exports=function(t,e){return i[t]||(i[t]=e||{})}},5917:(t,e,n)=>{"use strict";var i=n(3724),r=n(9039),o=n(4055);t.exports=!i&&!r((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},5966:(t,e,n)=>{"use strict";var i=n(9306),r=n(4117);t.exports=function(t,e){var n=t[e];return r(n)?void 0:i(n)}},6033:(t,e,n)=>{"use strict";n(8523)},6034:(t,e,n)=>{"use strict";var i=n(6518),r=n(2357).values;i({target:"Object",stat:!0},{values:function(t){return r(t)}})},6043:(t,e,n)=>{"use strict";var i=n(9306),r=TypeError,o=function(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw new r("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new o(t)}},6080:(t,e,n)=>{"use strict";var i=n(7476),r=n(9306),o=n(616),s=i(i.bind);t.exports=function(t,e){return r(t),void 0===e?t:o?s(t,e):function(){return t.apply(e,arguments)}}},6099:(t,e,n)=>{"use strict";var i=n(2140),r=n(6840),o=n(3179);i||r(Object.prototype,"toString",o,{unsafe:!0})},6119:(t,e,n)=>{"use strict";var i=n(5745),r=n(3392),o=i("keys");t.exports=function(t){return o[t]||(o[t]=r(t))}},6193:(t,e,n)=>{"use strict";var i=n(4215);t.exports="NODE"===i},6198:(t,e,n)=>{"use strict";var i=n(8014);t.exports=function(t){return i(t.length)}},6269:t=>{"use strict";t.exports={}},6279:(t,e,n)=>{"use strict";var i=n(6840);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},6319:(t,e,n)=>{"use strict";var i=n(8551),r=n(9539);t.exports=function(t,e,n,o){try{return o?e(i(n)[0],n[1]):e(n)}catch(e){r(t,"throw",e)}}},6395:t=>{"use strict";t.exports=!1},6468:(t,e,n)=>{"use strict";var i=n(6518),r=n(2195),o=n(9504),s=n(2796),a=n(6840),c=n(3451),u=n(2652),l=n(679),f=n(4901),h=n(4117),d=n(34),g=n(9039),p=n(4428),v=n(687),I=n(3167);t.exports=function(t,e,n){var _=-1!==t.indexOf("Map"),y=-1!==t.indexOf("Weak"),E=_?"set":"add",T=r[t],A=T&&T.prototype,S=T,m={},C=function(t){var e=o(A[t]);a(A,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(y&&!d(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return y&&!d(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(y&&!d(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})};if(s(t,!f(T)||!(y||A.forEach&&!g((function(){(new T).entries().next()})))))S=n.getConstructor(e,t,_,E),c.enable();else if(s(t,!0)){var O=new S,k=O[E](y?{}:-0,1)!==O,b=g((function(){O.has(1)})),R=p((function(t){new T(t)})),N=!y&&g((function(){for(var t=new T,e=5;e--;)t[E](e,e);return!t.has(-0)}));R||((S=e((function(t,e){l(t,A);var n=I(new T,t,S);return h(e)||u(e,n[E],{that:n,AS_ENTRIES:_}),n}))).prototype=A,A.constructor=S),(b||N)&&(C("delete"),C("has"),_&&C("get")),(N||k)&&C(E),y&&A.clear&&delete A.clear}return m[t]=S,i({global:!0,constructor:!0,forced:S!==T},m),v(S,t),y||n.setStrong(S,t,_),S}},6469:(t,e,n)=>{"use strict";var i=n(8227),r=n(2360),o=n(4913).f,s=i("unscopables"),a=Array.prototype;void 0===a[s]&&o(a,s,{configurable:!0,value:r(null)}),t.exports=function(t){a[s][t]=!0}},6499:(t,e,n)=>{"use strict";var i=n(6518),r=n(9565),o=n(9306),s=n(6043),a=n(1103),c=n(2652);i({target:"Promise",stat:!0,forced:n(537)},{all:function(t){var e=this,n=s.f(e),i=n.resolve,u=n.reject,l=a((function(){var n=o(e.resolve),s=[],a=0,l=1;c(t,(function(t){var o=a++,c=!1;l++,r(n,e,t).then((function(t){c||(c=!0,s[o]=t,--l||i(s))}),u)})),--l||i(s)}));return l.error&&u(l.value),n.promise}})},6517:(t,e,n)=>{"use strict";n.d(e,{deepEqual:()=>m,errorFormat:()=>E,formatLogOutput:()=>O,hasSameType:()=>_,hexToValue:()=>S,isBrowser:()=>I,logDebug:()=>v,logDebugSprintf:()=>p,logError:()=>l,logErrorSprintf:()=>u,logInfo:()=>g,logInfoSprintf:()=>d,logWarning:()=>h,logWarningSprintf:()=>f,onDomReady:()=>C,sprintf:()=>c,uuidV4:()=>y,valueToHex:()=>A,visitorFlagSyncStatusMessage:()=>T});var i=n(4467),r=n(2284),o=(n(8706),n(3418),n(4423),n(3792),n(8598),n(4782),n(739),n(6033),n(9432),n(6099),n(8940),n(4864),n(7495),n(8781),n(1699),n(7764),n(5701),n(8156),n(5440),n(2953),n(1734)),s=n(4288),a=n(2932);function c(t){for(var e=t,n=0;n<(arguments.length<=1?0:arguments.length-1);n++){var i=n+1<1||arguments.length<=n+1?void 0:arguments[n+1],r="string"==typeof i?i:JSON.stringify(i instanceof Map?Array.from(i.values()):i);e=e.replace(new RegExp("\\{".concat(n,"\\}"),"g"),r)}return e}function u(t,e,n){if(t&&t.logLevel&&!(t.logLevel<s.LogLevel.ERROR)){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];l(t,c.apply(void 0,[n].concat(r)),e)}}function l(t,e,n){!t||!t.logLevel||t.logLevel<s.LogLevel.ERROR||("function"==typeof t.onLog&&t.onLog(s.LogLevel.ERROR,n,e),t.logManager&&"function"==typeof t.logManager.error&&t.logManager.error(e,n))}function f(t,e,n){if(t&&t.logLevel&&!(t.logLevel<s.LogLevel.WARNING)){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];h(t,c.apply(void 0,[n].concat(r)),e)}}function h(t,e,n){!t||!t.logLevel||t.logLevel<s.LogLevel.WARNING||("function"==typeof t.onLog&&t.onLog(s.LogLevel.WARNING,n,e),t.logManager&&"function"==typeof t.logManager.warning&&t.logManager.warning(e,n))}function d(t,e,n){if(t&&t.logLevel&&!(t.logLevel<s.LogLevel.INFO)){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];g(t,c.apply(void 0,[n].concat(r)),e)}}function g(t,e,n){!t||!t.logLevel||t.logLevel<s.LogLevel.INFO||("function"==typeof t.onLog&&t.onLog(s.LogLevel.INFO,n,e),t.logManager&&"function"==typeof t.logManager.info&&t.logManager.info(e,n))}function p(t,e,n){if(t&&t.logLevel&&!(t.logLevel<s.LogLevel.DEBUG)){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];v(t,c.apply(void 0,[n].concat(r)),e)}}function v(t,e,n){!t||!t.logLevel||t.logLevel<s.LogLevel.DEBUG||("function"==typeof t.onLog&&t.onLog(s.LogLevel.DEBUG,n,e),t.logManager&&"function"==typeof t.logManager.debug&&t.logManager.debug(e,n))}function I(){return"undefined"!=typeof window&&void 0!==window.document}function _(t,e){return(0,r.default)(t)===(0,r.default)(e)&&("object"!==(0,r.default)(t)||"object"!==(0,r.default)(e)||Array.isArray(t)===Array.isArray(e))}function y(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function E(t,e){return JSON.stringify({message:t,data:e})}function T(t){var e="";switch(t){case o.FSFetchReasons.FLAGS_NEVER_FETCHED:e="Visitor `{0}` has been created ".concat(a.VISITOR_SYNC_FLAGS_MESSAGE);break;case o.FSFetchReasons.UPDATE_CONTEXT:e="Visitor context for visitor `{0}` has been updated ".concat(a.VISITOR_SYNC_FLAGS_MESSAGE);break;case o.FSFetchReasons.AUTHENTICATE:e="Visitor `{0}` has been authenticated ".concat(a.VISITOR_SYNC_FLAGS_MESSAGE);break;case o.FSFetchReasons.UNAUTHENTICATE:e="Visitor `{0}` has been unauthenticated ".concat(a.VISITOR_SYNC_FLAGS_MESSAGE);break;case o.FSFetchReasons.FLAGS_FETCHING_ERROR:e='There was an error while fetching flags for visitor `{0}`. So the value of the flag `{1}` may be outdated"';break;case o.FSFetchReasons.FLAGS_FETCHED_FROM_CACHE:e="Flags for visitor `{0}` have been fetched from cache"}return e}function A(t){var e=JSON.stringify(t);return Array.from(e,(function(t){return t.charCodeAt(0).toString(16)})).join("")}function S(t,e){if("string"!=typeof t)return u(e,"hexToValue","Invalid hex string: {0}",t),null;for(var n="",i=0;i<t.length;i+=2){var r=t.slice(i,i+2),o=parseInt(r,16);if(isNaN(o))return u(e,"hexToValue","Invalid hex character: {0}",r),null;n+=String.fromCharCode(o)}try{return JSON.parse(n)}catch(t){return u(e,"hexToValue","Error while parsing JSON: {0}",t),null}}function m(t,e){if(t===e)return!0;if("object"!==(0,r.default)(t)||"object"!==(0,r.default)(e)||null==t||null==e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var o=0,s=n;o<s.length;o++){var a=s[o];if(!i.includes(a)||!m(t[a],e[a]))return!1}return!0}function C(t){if(!I())return!1;var e="interactive"===document.readyState||"complete"===document.readyState;if("function"!=typeof t)return e;if(e)t();else{var n=function(){document.removeEventListener("DOMContentLoaded",n),t()};document.addEventListener("DOMContentLoaded",n)}return e}function O(t,e,n){var r=new Date,o=function(t){return t.toString().padStart(2,"0")},c=(0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)({},s.LogLevel.EMERGENCY,"[1;37;41m"),s.LogLevel.ALERT,"[1;37;45m"),s.LogLevel.CRITICAL,"[1;37;41m"),s.LogLevel.ERROR,"[1;37;41m"),s.LogLevel.WARNING,"[33;1m"),s.LogLevel.NOTICE,"[36;1m"),s.LogLevel.INFO,"[32;1m"),s.LogLevel.DEBUG,"[90;1m"),s.LogLevel.NONE,""),s.LogLevel.ALL,"[90;1m")[t]||"",u=r.getFullYear(),l=o(r.getMonth()+1),f=o(r.getDate()),h=o(r.getHours()),d=o(r.getMinutes()),g=o(r.getSeconds()),p=r.getMilliseconds().toString().padStart(3,"0"),v="".concat(u,"-").concat(l,"-").concat(f," ").concat(h,":").concat(d,":").concat(g,".").concat(p),I=s.LogLevel[t].padEnd(2);return"".concat(c,"[").concat(v,"] [").concat(a.FLAGSHIP_SDK,"] [").concat(I,"] [").concat(n,"] ").concat(e).concat("[0m")}},6518:(t,e,n)=>{"use strict";var i=n(2195),r=n(7347).f,o=n(6699),s=n(6840),a=n(9433),c=n(7740),u=n(2796);t.exports=function(t,e){var n,l,f,h,d,g=t.target,p=t.global,v=t.stat;if(n=p?i:v?i[g]||a(g,{}):i[g]&&i[g].prototype)for(l in e){if(h=e[l],f=t.dontCallGetSet?(d=r(n,l))&&d.value:n[l],!u(p?l:g+(v?".":"#")+l,t.forced)&&void 0!==f){if(typeof h==typeof f)continue;c(h,f)}(t.sham||f&&f.sham)&&o(h,"sham",!0),s(n,l,h,t)}}},6682:(t,e,n)=>{"use strict";var i=n(9565),r=n(8551),o=n(4901),s=n(4576),a=n(7323),c=TypeError;t.exports=function(t,e){var n=t.exec;if(o(n)){var u=i(n,t,e);return null!==u&&r(u),u}if("RegExp"===s(t))return i(a,t,e);throw new c("RegExp#exec called on incompatible receiver")}},6699:(t,e,n)=>{"use strict";var i=n(3724),r=n(4913),o=n(6980);t.exports=i?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},6706:(t,e,n)=>{"use strict";var i=n(9504),r=n(9306);t.exports=function(t,e,n){try{return i(r(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}}},6761:(t,e,n)=>{"use strict";var i=n(6518),r=n(2195),o=n(9565),s=n(9504),a=n(6395),c=n(3724),u=n(4495),l=n(9039),f=n(9297),h=n(1625),d=n(8551),g=n(5397),p=n(6969),v=n(655),I=n(6980),_=n(2360),y=n(1072),E=n(8480),T=n(298),A=n(3717),S=n(7347),m=n(4913),C=n(6801),O=n(8773),k=n(6840),b=n(2106),R=n(5745),N=n(6119),D=n(421),w=n(3392),x=n(8227),P=n(1951),L=n(2892),M=n(8242),H=n(687),F=n(1181),V=n(9213).forEach,U=N("hidden"),G="Symbol",j="prototype",B=F.set,K=F.getterFor(G),Q=Object[j],q=r.Symbol,Y=q&&q[j],W=r.RangeError,z=r.TypeError,X=r.QObject,J=S.f,Z=m.f,$=T.f,tt=O.f,et=s([].push),nt=R("symbols"),it=R("op-symbols"),rt=R("wks"),ot=!X||!X[j]||!X[j].findChild,st=function(t,e,n){var i=J(Q,e);i&&delete Q[e],Z(t,e,n),i&&t!==Q&&Z(Q,e,i)},at=c&&l((function(){return 7!==_(Z({},"a",{get:function(){return Z(this,"a",{value:7}).a}})).a}))?st:Z,ct=function(t,e){var n=nt[t]=_(Y);return B(n,{type:G,tag:t,description:e}),c||(n.description=e),n},ut=function(t,e,n){t===Q&&ut(it,e,n),d(t);var i=p(e);return d(n),f(nt,i)?(n.enumerable?(f(t,U)&&t[U][i]&&(t[U][i]=!1),n=_(n,{enumerable:I(0,!1)})):(f(t,U)||Z(t,U,I(1,_(null))),t[U][i]=!0),at(t,i,n)):Z(t,i,n)},lt=function(t,e){d(t);var n=g(e),i=y(n).concat(gt(n));return V(i,(function(e){c&&!o(ft,n,e)||ut(t,e,n[e])})),t},ft=function(t){var e=p(t),n=o(tt,this,e);return!(this===Q&&f(nt,e)&&!f(it,e))&&(!(n||!f(this,e)||!f(nt,e)||f(this,U)&&this[U][e])||n)},ht=function(t,e){var n=g(t),i=p(e);if(n!==Q||!f(nt,i)||f(it,i)){var r=J(n,i);return!r||!f(nt,i)||f(n,U)&&n[U][i]||(r.enumerable=!0),r}},dt=function(t){var e=$(g(t)),n=[];return V(e,(function(t){f(nt,t)||f(D,t)||et(n,t)})),n},gt=function(t){var e=t===Q,n=$(e?it:g(t)),i=[];return V(n,(function(t){!f(nt,t)||e&&!f(Q,t)||et(i,nt[t])})),i};u||(k(Y=(q=function(){if(h(Y,this))throw new z("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?v(arguments[0]):void 0,e=w(t),n=function(t){var i=void 0===this?r:this;i===Q&&o(n,it,t),f(i,U)&&f(i[U],e)&&(i[U][e]=!1);var s=I(1,t);try{at(i,e,s)}catch(t){if(!(t instanceof W))throw t;st(i,e,s)}};return c&&ot&&at(Q,e,{configurable:!0,set:n}),ct(e,t)})[j],"toString",(function(){return K(this).tag})),k(q,"withoutSetter",(function(t){return ct(w(t),t)})),O.f=ft,m.f=ut,C.f=lt,S.f=ht,E.f=T.f=dt,A.f=gt,P.f=function(t){return ct(x(t),t)},c&&(b(Y,"description",{configurable:!0,get:function(){return K(this).description}}),a||k(Q,"propertyIsEnumerable",ft,{unsafe:!0}))),i({global:!0,constructor:!0,wrap:!0,forced:!u,sham:!u},{Symbol:q}),V(y(rt),(function(t){L(t)})),i({target:G,stat:!0,forced:!u},{useSetter:function(){ot=!0},useSimple:function(){ot=!1}}),i({target:"Object",stat:!0,forced:!u,sham:!c},{create:function(t,e){return void 0===e?_(t):lt(_(t),e)},defineProperty:ut,defineProperties:lt,getOwnPropertyDescriptor:ht}),i({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:dt}),M(),H(q,G),D[U]=!0},6801:(t,e,n)=>{"use strict";var i=n(3724),r=n(8686),o=n(4913),s=n(8551),a=n(5397),c=n(1072);e.f=i&&!r?Object.defineProperties:function(t,e){s(t);for(var n,i=a(e),r=c(e),u=r.length,l=0;u>l;)o.f(t,n=r[l++],i[n]);return t}},6823:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6837:t=>{"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6840:(t,e,n)=>{"use strict";var i=n(4901),r=n(4913),o=n(283),s=n(9433);t.exports=function(t,e,n,a){a||(a={});var c=a.enumerable,u=void 0!==a.name?a.name:e;if(i(n)&&o(n,u,a),a.global)c?t[e]=n:s(e,n);else{try{a.unsafe?t[e]&&(c=!0):delete t[e]}catch(t){}c?t[e]=n:r.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},6933:(t,e,n)=>{"use strict";var i=n(9504),r=n(4376),o=n(4901),s=n(4576),a=n(655),c=i([].push);t.exports=function(t){if(o(t))return t;if(r(t)){for(var e=t.length,n=[],i=0;i<e;i++){var u=t[i];"string"==typeof u?c(n,u):"number"!=typeof u&&"Number"!==s(u)&&"String"!==s(u)||c(n,a(u))}var l=n.length,f=!0;return function(t,e){if(f)return f=!1,e;if(r(this))return e;for(var i=0;i<l;i++)if(n[i]===t)return e}}}},6938:(t,e,n)=>{"use strict";var i=n(2360),r=n(2106),o=n(6279),s=n(6080),a=n(679),c=n(4117),u=n(2652),l=n(1088),f=n(2529),h=n(7633),d=n(3724),g=n(3451).fastKey,p=n(1181),v=p.set,I=p.getterFor;t.exports={getConstructor:function(t,e,n,l){var f=t((function(t,r){a(t,h),v(t,{type:e,index:i(null),first:null,last:null,size:0}),d||(t.size=0),c(r)||u(r,t[l],{that:t,AS_ENTRIES:n})})),h=f.prototype,p=I(e),_=function(t,e,n){var i,r,o=p(t),s=y(t,e);return s?s.value=n:(o.last=s={index:r=g(e,!0),key:e,value:n,previous:i=o.last,next:null,removed:!1},o.first||(o.first=s),i&&(i.next=s),d?o.size++:t.size++,"F"!==r&&(o.index[r]=s)),t},y=function(t,e){var n,i=p(t),r=g(e);if("F"!==r)return i.index[r];for(n=i.first;n;n=n.next)if(n.key===e)return n};return o(h,{clear:function(){for(var t=p(this),e=t.first;e;)e.removed=!0,e.previous&&(e.previous=e.previous.next=null),e=e.next;t.first=t.last=null,t.index=i(null),d?t.size=0:this.size=0},delete:function(t){var e=this,n=p(e),i=y(e,t);if(i){var r=i.next,o=i.previous;delete n.index[i.index],i.removed=!0,o&&(o.next=r),r&&(r.previous=o),n.first===i&&(n.first=r),n.last===i&&(n.last=o),d?n.size--:e.size--}return!!i},forEach:function(t){for(var e,n=p(this),i=s(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:n.first;)for(i(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!y(this,t)}}),o(h,n?{get:function(t){var e=y(this,t);return e&&e.value},set:function(t,e){return _(this,0===t?0:t,e)}}:{add:function(t){return _(this,t=0===t?0:t,t)}}),d&&r(h,"size",{configurable:!0,get:function(){return p(this).size}}),f},setStrong:function(t,e,n){var i=e+" Iterator",r=I(e),o=I(i);l(t,e,(function(t,e){v(this,{type:i,target:t,state:r(t),kind:e,last:null})}),(function(){for(var t=o(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?f("keys"===e?n.key:"values"===e?n.value:[n.key,n.value],!1):(t.target=null,f(void 0,!0))}),n?"entries":"values",!n,!0),h(e)}}},6955:(t,e,n)=>{"use strict";var i=n(2140),r=n(4901),o=n(4576),s=n(8227)("toStringTag"),a=Object,c="Arguments"===o(function(){return arguments}());t.exports=i?o:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=a(t),s))?n:c?o(e):"Object"===(i=o(e))&&r(e.callee)?"Arguments":i}},6969:(t,e,n)=>{"use strict";var i=n(2777),r=n(757);t.exports=function(t){var e=i(t,"string");return r(e)?e:e+""}},6980:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7007:t=>{"use strict";var e,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(n,i){function r(n){t.removeListener(e,o),i(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",r),n([].slice.call(arguments))}p(t,e,o,{once:!0}),"error"!==e&&function(t,e){"function"==typeof t.on&&p(t,"error",e,{once:!0})}(t,r)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function u(t,e,n,i){var r,o,s,u;if(a(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=c(t))>0&&s.length>r&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return t}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function h(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):g(r,r.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function p(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(o){i.once&&t.removeEventListener(e,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)i(c,this,e);else{var u=c.length,l=g(c,u);for(n=0;n<u;++n)i(l[n],this,e)}return!0},o.prototype.addListener=function(t,e){return u(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return u(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,f(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,f(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,i,r,o,s;if(a(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},o.prototype.listeners=function(t){return h(this,t,!0)},o.prototype.rawListeners=function(t){return h(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},7040:(t,e,n)=>{"use strict";var i=n(4495);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7055:(t,e,n)=>{"use strict";var i=n(9504),r=n(9039),o=n(4576),s=Object,a=i("".split);t.exports=r((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===o(t)?a(t,""):s(t)}:s},7188:(t,e,n)=>{"use strict";n.r(e),n.d(e,{VisitorEvent:()=>r});var i=n(2901),r=function(){return(0,i.default)((function(t){var e=t.customerAccountId,n=t.visitorId,i=t.currentUrl,r=t.clickPath,o=t.clickPosition,s=t.screenSize,a=t.scrollPosition;this._customerAccountId=e,this._visitorId=n,this._currentUrl=i,this._clickPath=r,this._clickPosition=o,this._screenSize=s,this._scrollPosition=a}),[{key:"customerAccountId",get:function(){return this._customerAccountId}},{key:"visitorId",get:function(){return this._visitorId}},{key:"currentUrl",get:function(){return this._currentUrl}},{key:"clickPath",get:function(){return this._clickPath}},{key:"clickPosition",get:function(){return this._clickPosition}},{key:"screenSize",get:function(){return this._screenSize}},{key:"scrollPosition",get:function(){return this._scrollPosition}},{key:"toApiKeys",value:function(){var t={cid:this._customerAccountId,vid:this._visitorId,dl:this._currentUrl,sr:this._screenSize,t:"VISITOREVENT"};return this._clickPath&&(t.cp=this._clickPath),this._clickPosition&&(t.cpo=this._clickPosition),this._scrollPosition&&(t.sp=this._scrollPosition),t}}])}()},7323:(t,e,n)=>{"use strict";var i,r,o=n(9565),s=n(9504),a=n(655),c=n(7979),u=n(8429),l=n(5745),f=n(2360),h=n(1181).get,d=n(3635),g=n(8814),p=l("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,I=v,_=s("".charAt),y=s("".indexOf),E=s("".replace),T=s("".slice),A=(r=/b*/g,o(v,i=/a/,"a"),o(v,r,"a"),0!==i.lastIndex||0!==r.lastIndex),S=u.BROKEN_CARET,m=void 0!==/()??/.exec("")[1];(A||m||S||d||g)&&(I=function(t){var e,n,i,r,s,u,l,d=this,g=h(d),C=a(t),O=g.raw;if(O)return O.lastIndex=d.lastIndex,e=o(I,O,C),d.lastIndex=O.lastIndex,e;var k=g.groups,b=S&&d.sticky,R=o(c,d),N=d.source,D=0,w=C;if(b&&(R=E(R,"y",""),-1===y(R,"g")&&(R+="g"),w=T(C,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==_(C,d.lastIndex-1))&&(N="(?: "+N+")",w=" "+w,D++),n=new RegExp("^(?:"+N+")",R)),m&&(n=new RegExp("^"+N+"$(?!\\s)",R)),A&&(i=d.lastIndex),r=o(v,b?n:d,w),b?r?(r.input=T(r.input,D),r[0]=T(r[0],D),r.index=d.lastIndex,d.lastIndex+=r[0].length):d.lastIndex=0:A&&r&&(d.lastIndex=d.global?r.index+r[0].length:i),m&&r&&r.length>1&&o(p,r[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r&&k)for(r.groups=u=f(null),s=0;s<k.length;s++)u[(l=k[s])[0]]=r[l[1]];return r}),t.exports=I},7347:(t,e,n)=>{"use strict";var i=n(3724),r=n(9565),o=n(8773),s=n(6980),a=n(5397),c=n(6969),u=n(9297),l=n(5917),f=Object.getOwnPropertyDescriptor;e.f=i?f:function(t,e){if(t=a(t),e=c(e),l)try{return f(t,e)}catch(t){}if(u(t,e))return s(!r(o.f,t,e),t[e])}},7400:t=>{"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7433:(t,e,n)=>{"use strict";var i=n(4376),r=n(3517),o=n(34),s=n(8227)("species"),a=Array;t.exports=function(t){var e;return i(t)&&(e=t.constructor,(r(e)&&(e===a||i(e.prototype))||o(e)&&null===(e=e[s]))&&(e=void 0)),void 0===e?a:e}},7452:t=>{"use strict";t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},7476:(t,e,n)=>{"use strict";var i=n(4576),r=n(9504);t.exports=function(t){if("Function"===i(t))return r(t)}},7495:(t,e,n)=>{"use strict";var i=n(6518),r=n(7323);i({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},7629:(t,e,n)=>{"use strict";var i=n(6395),r=n(2195),o=n(9433),s="__core-js_shared__",a=t.exports=r[s]||o(s,{});(a.versions||(a.versions=[])).push({version:"3.41.0",mode:i?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7633:(t,e,n)=>{"use strict";var i=n(7751),r=n(2106),o=n(8227),s=n(3724),a=o("species");t.exports=function(t){var e=i(t);s&&e&&!e[a]&&r(e,a,{configurable:!0,get:function(){return this}})}},7657:(t,e,n)=>{"use strict";var i,r,o,s=n(9039),a=n(4901),c=n(34),u=n(2360),l=n(2787),f=n(6840),h=n(8227),d=n(6395),g=h("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(r=l(l(o)))!==Object.prototype&&(i=r):p=!0),!c(i)||s((function(){var t={};return i[g].call(t)!==t}))?i={}:d&&(i=u(i)),a(i[g])||f(i,g,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:p}},7680:(t,e,n)=>{"use strict";var i=n(9504);t.exports=i([].slice)},7740:(t,e,n)=>{"use strict";var i=n(9297),r=n(5031),o=n(7347),s=n(4913);t.exports=function(t,e,n){for(var a=r(e),c=s.f,u=o.f,l=0;l<a.length;l++){var f=a[l];i(t,f)||n&&i(n,f)||c(t,f,u(e,f))}}},7743:(t,e,n)=>{"use strict";var i=n(6518),r=n(9565),o=n(9306),s=n(6043),a=n(1103),c=n(2652);i({target:"Promise",stat:!0,forced:n(537)},{race:function(t){var e=this,n=s.f(e),i=n.reject,u=a((function(){var s=o(e.resolve);c(t,(function(t){r(s,e,t).then(n.resolve,i)}))}));return u.error&&i(u.value),n.promise}})},7750:(t,e,n)=>{"use strict";var i=n(4117),r=TypeError;t.exports=function(t){if(i(t))throw new r("Can't call method on "+t);return t}},7751:(t,e,n)=>{"use strict";var i=n(2195),r=n(4901);t.exports=function(t,e){return arguments.length<2?(n=i[t],r(n)?n:void 0):i[t]&&i[t][e];var n}},7764:(t,e,n)=>{"use strict";var i=n(8183).charAt,r=n(655),o=n(1181),s=n(1088),a=n(2529),c="String Iterator",u=o.set,l=o.getterFor(c);s(String,"String",(function(t){u(this,{type:c,string:r(t),index:0})}),(function(){var t,e=l(this),n=e.string,r=e.index;return r>=n.length?a(void 0,!0):(t=i(n,r),e.index+=t.length,a(t,!1))}))},7812:(t,e,n)=>{"use strict";var i=n(6518),r=n(9297),o=n(757),s=n(6823),a=n(5745),c=n(1296),u=a("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!c},{keyFor:function(t){if(!o(t))throw new TypeError(s(t)+" is not a symbol");if(r(u,t))return u[t]}})},7829:(t,e,n)=>{"use strict";var i=n(8183).charAt;t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},7860:(t,e,n)=>{"use strict";var i=n(2839);t.exports=/web0s(?!.*chrome)/i.test(i)},7916:(t,e,n)=>{"use strict";var i=n(6080),r=n(9565),o=n(8981),s=n(6319),a=n(4209),c=n(3517),u=n(6198),l=n(4659),f=n(81),h=n(851),d=Array;t.exports=function(t){var e=o(t),n=c(this),g=arguments.length,p=g>1?arguments[1]:void 0,v=void 0!==p;v&&(p=i(p,g>2?arguments[2]:void 0));var I,_,y,E,T,A,S=h(e),m=0;if(!S||this===d&&a(S))for(I=u(e),_=n?new this(I):d(I);I>m;m++)A=v?p(e[m],m):e[m],l(_,m,A);else for(_=n?new this:[],T=(E=f(e,S)).next;!(y=r(T,E)).done;m++)A=v?s(E,p,[y.value,m],!0):y.value,l(_,m,A);return _.length=m,_}},7979:(t,e,n)=>{"use strict";var i=n(8551);t.exports=function(){var t=i(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},8014:(t,e,n)=>{"use strict";var i=n(1291),r=Math.min;t.exports=function(t){var e=i(t);return e>0?r(e,9007199254740991):0}},8156:(t,e,n)=>{"use strict";var i=n(6518),r=n(533).start;i({target:"String",proto:!0,forced:n(3063)},{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},8183:(t,e,n)=>{"use strict";var i=n(9504),r=n(1291),o=n(655),s=n(7750),a=i("".charAt),c=i("".charCodeAt),u=i("".slice),l=function(t){return function(e,n){var i,l,f=o(s(e)),h=r(n),d=f.length;return h<0||h>=d?t?"":void 0:(i=c(f,h))<55296||i>56319||h+1===d||(l=c(f,h+1))<56320||l>57343?t?a(f,h):i:t?u(f,h,h+2):l-56320+(i-55296<<10)+65536}};t.exports={codeAt:l(!1),charAt:l(!0)}},8227:(t,e,n)=>{"use strict";var i=n(2195),r=n(5745),o=n(9297),s=n(3392),a=n(4495),c=n(7040),u=i.Symbol,l=r("wks"),f=c?u.for||u:u&&u.withoutSetter||s;t.exports=function(t){return o(l,t)||(l[t]=a&&o(u,t)?u[t]:f("Symbol."+t)),l[t]}},8242:(t,e,n)=>{"use strict";var i=n(9565),r=n(7751),o=n(8227),s=n(6840);t.exports=function(){var t=r("Symbol"),e=t&&t.prototype,n=e&&e.valueOf,a=o("toPrimitive");e&&!e[a]&&s(e,a,(function(t){return i(n,this)}),{arity:1})}},8265:t=>{"use strict";var e=function(){this.head=null,this.tail=null};e.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},t.exports=e},8429:(t,e,n)=>{"use strict";var i=n(9039),r=n(2195).RegExp,o=i((function(){var t=r("a","y");return t.lastIndex=2,null!==t.exec("abcd")})),s=o||i((function(){return!r("a","y").sticky})),a=o||i((function(){var t=r("^r","gy");return t.lastIndex=2,null!==t.exec("str")}));t.exports={BROKEN_CARET:a,MISSED_STICKY:s,UNSUPPORTED_Y:o}},8431:(t,e,n)=>{"use strict";var i=n(6518),r=n(9213).every;i({target:"Array",proto:!0,forced:!n(4598)("every")},{every:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},8480:(t,e,n)=>{"use strict";var i=n(1828),r=n(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},8523:(t,e,n)=>{"use strict";n(6468)("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(6938))},8551:(t,e,n)=>{"use strict";var i=n(34),r=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw new o(r(t)+" is not an object")}},8598:(t,e,n)=>{"use strict";var i=n(6518),r=n(9504),o=n(7055),s=n(5397),a=n(4598),c=r([].join);i({target:"Array",proto:!0,forced:o!==Object||!a("join",",")},{join:function(t){return c(s(this),void 0===t?",":t)}})},8622:(t,e,n)=>{"use strict";var i=n(2195),r=n(4901),o=i.WeakMap;t.exports=r(o)&&/native code/.test(String(o))},8686:(t,e,n)=>{"use strict";var i=n(3724),r=n(9039);t.exports=i&&r((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8706:(t,e,n)=>{"use strict";var i=n(6518),r=n(9039),o=n(4376),s=n(34),a=n(8981),c=n(6198),u=n(6837),l=n(4659),f=n(1469),h=n(597),d=n(8227),g=n(9519),p=d("isConcatSpreadable"),v=g>=51||!r((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),I=function(t){if(!s(t))return!1;var e=t[p];return void 0!==e?!!e:o(t)};i({target:"Array",proto:!0,arity:1,forced:!v||!h("concat")},{concat:function(t){var e,n,i,r,o,s=a(this),h=f(s,0),d=0;for(e=-1,i=arguments.length;e<i;e++)if(I(o=-1===e?s:arguments[e]))for(r=c(o),u(d+r),n=0;n<r;n++,d++)n in o&&l(h,d,o[n]);else u(d+1),l(h,d++,o);return h.length=d,h}})},8727:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:(t,e,n)=>{"use strict";var i=n(616),r=Function.prototype,o=r.apply,s=r.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?s.bind(o):function(){return s.apply(o,arguments)})},8773:(t,e)=>{"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);e.f=r?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},8781:(t,e,n)=>{"use strict";var i=n(350).PROPER,r=n(6840),o=n(8551),s=n(655),a=n(9039),c=n(1034),u="toString",l=RegExp.prototype,f=l[u],h=a((function(){return"/a/b"!==f.call({source:"a",flags:"b"})})),d=i&&f.name!==u;(h||d)&&r(l,u,(function(){var t=o(this);return"/"+s(t.source)+"/"+s(c(t))}),{unsafe:!0})},8814:(t,e,n)=>{"use strict";var i=n(9039),r=n(2195).RegExp;t.exports=i((function(){var t=r("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},8940:(t,e,n)=>{"use strict";var i=n(6518),r=n(2703);i({global:!0,forced:parseInt!==r},{parseInt:r})},8981:(t,e,n)=>{"use strict";var i=n(7750),r=Object;t.exports=function(t){return r(i(t))}},9039:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},9167:(t,e,n)=>{"use strict";var i=n(2195);t.exports=i},9213:(t,e,n)=>{"use strict";var i=n(6080),r=n(9504),o=n(7055),s=n(8981),a=n(6198),c=n(1469),u=r([].push),l=function(t){var e=1===t,n=2===t,r=3===t,l=4===t,f=6===t,h=7===t,d=5===t||f;return function(g,p,v,I){for(var _,y,E=s(g),T=o(E),A=a(T),S=i(p,v),m=0,C=I||c,O=e?C(g,A):n||h?C(g,0):void 0;A>m;m++)if((d||m in T)&&(y=S(_=T[m],m,E),t))if(e)O[m]=y;else if(y)switch(t){case 3:return!0;case 5:return _;case 6:return m;case 2:u(O,_)}else switch(t){case 4:return!1;case 7:u(O,_)}return f?-1:r||l?l:O}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},9225:(t,e,n)=>{"use strict";var i,r,o,s,a=n(2195),c=n(8745),u=n(6080),l=n(4901),f=n(9297),h=n(9039),d=n(397),g=n(7680),p=n(4055),v=n(2812),I=n(9544),_=n(6193),y=a.setImmediate,E=a.clearImmediate,T=a.process,A=a.Dispatch,S=a.Function,m=a.MessageChannel,C=a.String,O=0,k={},b="onreadystatechange";h((function(){i=a.location}));var R=function(t){if(f(k,t)){var e=k[t];delete k[t],e()}},N=function(t){return function(){R(t)}},D=function(t){R(t.data)},w=function(t){a.postMessage(C(t),i.protocol+"//"+i.host)};y&&E||(y=function(t){v(arguments.length,1);var e=l(t)?t:S(t),n=g(arguments,1);return k[++O]=function(){c(e,void 0,n)},r(O),O},E=function(t){delete k[t]},_?r=function(t){T.nextTick(N(t))}:A&&A.now?r=function(t){A.now(N(t))}:m&&!I?(s=(o=new m).port2,o.port1.onmessage=D,r=u(s.postMessage,s)):a.addEventListener&&l(a.postMessage)&&!a.importScripts&&i&&"file:"!==i.protocol&&!h(w)?(r=w,a.addEventListener("message",D,!1)):r=b in p("script")?function(t){d.appendChild(p("script"))[b]=function(){d.removeChild(this),R(t)}}:function(t){setTimeout(N(t),0)}),t.exports={set:y,clear:E}},9228:(t,e,n)=>{"use strict";n(7495);var i=n(9565),r=n(6840),o=n(7323),s=n(9039),a=n(8227),c=n(6699),u=a("species"),l=RegExp.prototype;t.exports=function(t,e,n,f){var h=a(t),d=!s((function(){var e={};return e[h]=function(){return 7},7!==""[t](e)})),g=d&&!s((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[u]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!d||!g||n){var p=/./[h],v=e(h,""[t],(function(t,e,n,r,s){var a=e.exec;return a===o||a===l.exec?d&&!s?{done:!0,value:i(p,e,n,r)}:{done:!0,value:i(t,n,e,r)}:{done:!1}}));r(String.prototype,t,v[0]),r(l,h,v[1])}f&&c(l[h],"sham",!0)}},9296:(t,e,n)=>{"use strict";var i=n(4055)("span").classList,r=i&&i.constructor&&i.constructor.prototype;t.exports=r===Object.prototype?void 0:r},9297:(t,e,n)=>{"use strict";var i=n(9504),r=n(8981),o=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(r(t),e)}},9306:(t,e,n)=>{"use strict";var i=n(4901),r=n(6823),o=TypeError;t.exports=function(t){if(i(t))return t;throw new o(r(t)+" is not a function")}},9432:(t,e,n)=>{"use strict";var i=n(6518),r=n(8981),o=n(1072);i({target:"Object",stat:!0,forced:n(9039)((function(){o(1)}))},{keys:function(t){return o(r(t))}})},9433:(t,e,n)=>{"use strict";var i=n(2195),r=Object.defineProperty;t.exports=function(t,e){try{r(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e}},9449:(t,e,n)=>{"use strict";var i,r=n(6518),o=n(7476),s=n(7347).f,a=n(8014),c=n(655),u=n(511),l=n(7750),f=n(1436),h=n(6395),d=o("".slice),g=Math.min,p=f("endsWith");r({target:"String",proto:!0,forced:!(!h&&!p&&(i=s(String.prototype,"endsWith"),i&&!i.writable)||p)},{endsWith:function(t){var e=c(l(this));u(t);var n=arguments.length>1?arguments[1]:void 0,i=e.length,r=void 0===n?i:g(a(n),i),o=c(t);return d(e,r-o.length,r)===o}})},9463:(t,e,n)=>{"use strict";var i=n(6518),r=n(3724),o=n(2195),s=n(9504),a=n(9297),c=n(4901),u=n(1625),l=n(655),f=n(2106),h=n(7740),d=o.Symbol,g=d&&d.prototype;if(r&&c(d)&&(!("description"in g)||void 0!==d().description)){var p={},v=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),e=u(g,this)?new d(t):void 0===t?d():d(t);return""===t&&(p[e]=!0),e};h(v,d),v.prototype=g,g.constructor=v;var I="Symbol(description detection)"===String(d("description detection")),_=s(g.valueOf),y=s(g.toString),E=/^Symbol\((.*)\)[^)]+$/,T=s("".replace),A=s("".slice);f(g,"description",{configurable:!0,get:function(){var t=_(this);if(a(p,t))return"";var e=y(t),n=I?A(e,7,-1):T(e,E,"$1");return""===n?void 0:n}}),i({global:!0,constructor:!0,forced:!0},{Symbol:v})}},9479:(t,e,n)=>{"use strict";var i=n(2195),r=n(3724),o=n(2106),s=n(7979),a=n(9039),c=i.RegExp,u=c.prototype;r&&a((function(){var t=!0;try{c(".","d")}catch(e){t=!1}var e={},n="",i=t?"dgimsy":"gimsy",r=function(t,i){Object.defineProperty(e,t,{get:function(){return n+=i,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var s in t&&(o.hasIndices="d"),o)r(s,o[s]);return Object.getOwnPropertyDescriptor(u,"flags").get.call(e)!==i||n!==i}))&&o(u,"flags",{configurable:!0,get:s})},9504:(t,e,n)=>{"use strict";var i=n(616),r=Function.prototype,o=r.call,s=i&&r.bind.bind(o,o);t.exports=i?s:function(t){return function(){return o.apply(t,arguments)}}},9519:(t,e,n)=>{"use strict";var i,r,o=n(2195),s=n(2839),a=o.process,c=o.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(r=(i=l.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(r=+i[1]),t.exports=r},9539:(t,e,n)=>{"use strict";var i=n(9565),r=n(8551),o=n(5966);t.exports=function(t,e,n){var s,a;r(t);try{if(!(s=o(t,"return"))){if("throw"===e)throw n;return n}s=i(s,t)}catch(t){a=!0,s=t}if("throw"===e)throw n;if(a)throw s;return r(s),n}},9544:(t,e,n)=>{"use strict";var i=n(2839);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},9565:(t,e,n)=>{"use strict";var i=n(616),r=Function.prototype.call;t.exports=i?r.bind(r):function(){return r.apply(r,arguments)}},9617:(t,e,n)=>{"use strict";var i=n(5397),r=n(5610),o=n(6198),s=function(t){return function(e,n,s){var a=i(e),c=o(a);if(0===c)return!t&&-1;var u,l=r(s,c);if(t&&n!=n){for(;c>l;)if((u=a[l++])!=u)return!0}else for(;c>l;l++)if((t||l in a)&&a[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},9773:(t,e,n)=>{"use strict";var i=n(6518),r=n(4495),o=n(9039),s=n(3717),a=n(8981);i({target:"Object",stat:!0,forced:!r||o((function(){s.f(1)}))},{getOwnPropertySymbols:function(t){var e=s.f;return e?e(a(t)):[]}})}},i={};function r(t){var e=i[t];if(void 0!==e)return e.exports;var o=i[t]={exports:{}};return n[t].call(o.exports,o,o.exports,r),o.exports}r.m=n,r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((e,n)=>(r.f[n](t,e),e)),[])),r.u=t=>"chunks/browser/umd/"+t+"."+{532:"633ace213f3afd9caf0c",692:"8551cacafd5012e1f291"}[t]+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="@flagship.io/js-sdk:",r.l=(n,i,o,s)=>{if(t[n])t[n].push(i);else{var a,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var f=u[l];if(f.getAttribute("src")==n||f.getAttribute("data-webpack")==e+o){a=f;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",e+o),a.src=n),t[n]=[i];var h=(e,i)=>{a.onerror=a.onload=null,clearTimeout(d);var r=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(i))),e)return e(i)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=n[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={792:0};r.f.j=(e,n)=>{var i=r.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise(((n,r)=>i=t[e]=[n,r]));n.push(i[2]=o);var s=r.p+r.u(e),a=new Error;r.l(s,(n=>{if(r.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,o,[s,a,c]=n,u=0;if(s.some((e=>0!==t[e]))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);c&&c(r)}for(e&&e(n);u<s.length;u++)o=s[u],r.o(t,o)&&t[o]&&t[o][0](),t[o]=0},n=self.webpackChunk_flagship_io_js_sdk=self.webpackChunk_flagship_io_js_sdk||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var o={};return(()=>{"use strict";function t(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function e(e){return function(){var n=this,i=arguments;return new Promise((function(r,o){var s=e.apply(n,i);function a(e){t(s,r,o,a,c,"next",e)}function c(e){t(s,r,o,a,c,"throw",e)}a(void 0)}))}}r.r(o),r.d(o,{ABTastyWebSDKPostMessageType:()=>M,APP_VERSION_CODE:()=>Ne,APP_VERSION_NAME:()=>Re,CARRIER_NAME:()=>ke,CacheStrategy:()=>T,DEVICE_LOCALE:()=>pe,DEVICE_MODEL:()=>Ie,DEVICE_TYPE:()=>ve,DecisionApiConfig:()=>w,DecisionMode:()=>I,EventCategory:()=>rt,FLAGSHIP_CLIENT:()=>we,FLAGSHIP_CONTEXT:()=>Le,FLAGSHIP_VERSION:()=>xe,FLAGSHIP_VISITOR:()=>Pe,FSFetchReasons:()=>Fe.FSFetchReasons,FSFetchStatus:()=>He,FSFlag:()=>rn,FSFlagCollection:()=>on,FSFlagMetadata:()=>Me,FSFlagStatus:()=>en,FSSdkStatus:()=>v,Flagship:()=>Fn,HitType:()=>$,INTERFACE_NAME:()=>De,INTERNET_CONNECTION:()=>be,IP:()=>Se,LOCATION_CITY:()=>_e,LOCATION_COUNTRY:()=>Ee,LOCATION_LAT:()=>Te,LOCATION_LONG:()=>Ae,LOCATION_REGION:()=>ye,LogLevel:()=>y.LogLevel,OS_NAME:()=>me,OS_VERSION_CODE:()=>Oe,OS_VERSION_NAME:()=>Ce,TroubleshootingLabel:()=>P,Visitor:()=>p,VisitorCacheStatus:()=>L,default:()=>Vn});var n=r(2901),i=(r(3792),r(1688),r(6099),r(3362),r(7764),r(2480),r(2953),r(4756)),s=r.n(i),a=(r(825),r(2284));function c(t,e){if(e&&("object"==(0,a.default)(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}var h=r(7007),d=r(2932);function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(g=function(){return!!t})()}var p=function(t){function e(t){var n,i,r,o;i=this,r=u(r=e),(n=c(i,g()?Reflect.construct(r,[],u(i).constructor):r.apply(i,o))).visitorDelegate=t,n._onReady=function(t){n.emit(d.EMIT_READY,t)},n.visitorDelegate.on(d.EMIT_READY,n._onReady);var s=n;return s.sendEaiVisitorEvent=function(t){n.visitorDelegate.sendEaiVisitorEvent(t)},s.sendEaiPageView=function(t){n.visitorDelegate.sendEaiPageView(t)},s.onEAICollectStatusChange=function(t){n.visitorDelegate.onEAICollectStatusChange(t)},n}return f(e,t),(0,n.default)(e,[{key:"visitorId",get:function(){return this.visitorDelegate.visitorId},set:function(t){this.visitorDelegate.visitorId=t}},{key:"anonymousId",get:function(){return this.visitorDelegate.anonymousId}},{key:"config",get:function(){return this.visitorDelegate.config}},{key:"context",get:function(){return this.visitorDelegate.context}},{key:"flagsStatus",get:function(){return this.visitorDelegate.flagsStatus}},{key:"hasConsented",get:function(){return this.visitorDelegate.hasConsented}},{key:"setConsent",value:function(t){this.visitorDelegate.setConsent(t)}},{key:"updateContext",value:function(t,e){this.visitorDelegate.updateContext(t,e)}},{key:"clearContext",value:function(){this.visitorDelegate.clearContext()}},{key:"getFlag",value:function(t){return this.visitorDelegate.getFlag(t)}},{key:"getFlags",value:function(){return this.visitorDelegate.getFlags()}},{key:"fetchFlags",value:function(){return this.visitorDelegate.fetchFlags()}},{key:"sendHit",value:function(t){return this.visitorDelegate.sendHit(t)}},{key:"sendHits",value:function(t){return this.visitorDelegate.sendHits(t)}},{key:"authenticate",value:function(t){this.visitorDelegate.authenticate(t)}},{key:"unauthenticate",value:function(){this.visitorDelegate.unauthenticate()}},{key:"collectEAIEventsAsync",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.length>0&&(t=n[0]),this.visitorDelegate.collectEAIEventsAsync(t)}},{key:"cleanup",value:function(){this.visitorDelegate.cleanup(),this.visitorDelegate.off(d.EMIT_READY,this._onReady)}}])}(h.EventEmitter),v=function(t){return t[t.SDK_NOT_INITIALIZED=0]="SDK_NOT_INITIALIZED",t[t.SDK_INITIALIZING=1]="SDK_INITIALIZING",t[t.SDK_PANIC=2]="SDK_PANIC",t[t.SDK_INITIALIZED=3]="SDK_INITIALIZED",t}({}),I=function(t){return t.DECISION_API="DECISION-API",t.BUCKETING="BUCKETING",t.BUCKETING_EDGE="BUCKETING_EDGE",t}({}),_=(r(2675),r(2008),r(1629),r(3851),r(1278),r(9432),r(3500),r(4467)),y=(r(2010),r(4288)),E=r(6517),T=function(t){return t[t.CONTINUOUS_CACHING=0]="CONTINUOUS_CACHING",t[t.PERIODIC_CACHING=1]="PERIODIC_CACHING",t}({}),A=function(){return(0,n.default)((function(t){this.batchIntervals=null==t?void 0:t.batchIntervals,this.poolMaxSize=null==t?void 0:t.poolMaxSize,this._batchStrategy=this.getCacheStrategy(null==t?void 0:t.cacheStrategy)}),[{key:"getCacheStrategy",value:function(t){return"number"==typeof t?t:(0,E.isBrowser)()?T.CONTINUOUS_CACHING:T.PERIODIC_CACHING}},{key:"batchIntervals",get:function(){return this._batchIntervals},set:function(t){("number"!=typeof t||t<0||t>10800)&&(t=(0,E.isBrowser)()?d.DEFAULT_BROWSER_TIME_INTERVAL:d.DEFAULT_SERVER_TIME_INTERVAL),this._batchIntervals=t}},{key:"poolMaxSize",get:function(){return this._poolMaxSize},set:function(t){("number"!=typeof t||t<5)&&(t=(0,E.isBrowser)()?d.DEFAULT_BROWSER_POOL_MAX_SIZE:d.DEFAULT_SERVER_POOL_MAX_SIZE),this._poolMaxSize=t}},{key:"cacheStrategy",get:function(){return this._batchStrategy}}])}(),S=r(4116),m=function(){return(0,n.default)((function(t){(0,_.default)(this,"_batchActivateHits",!1);var e=t.envId,n=t.apiKey,i=t.timeout,r=t.logLevel,o=t.logManager,s=t.onSdkStatusChanged,a=t.fetchNow,c=t.decisionMode,u=t.reuseVisitorIds,l=t.initialBucketing,f=t.decisionApiUrl,h=t.hitDeduplicationTime,g=t.visitorCacheImplementation,p=t.hitCacheImplementation,v=t.disableCache,E=t.language,T=t.sdkVersion,S=t.trackingManagerConfig,m=t.onLog,C=t.onVisitorExposed,O=t.nextFetchConfig,k=t.fetchFlagsBufferingTime,b=t.disableDeveloperUsageTracking,R=t.batchActivateHits;this.initQaMode(),this.initSDKInfo(E,T),o&&(this.logManager=o),this._batchActivateHits=R,this.fetchFlagsBufferingTime=null!=k?k:d.FETCH_FLAG_BUFFERING_DEFAULT_TIME,this.nextFetchConfig=O||{revalidate:20},this._trackingManagerConfig=new A(S||{}),this.onLog=m,this.decisionApiUrl=f||d.BASE_API_URL,this._envId=e,this._apiKey=n,this.logLevel=null!=r?r:y.LogLevel.INFO,this.timeout=i||d.REQUEST_TIME_OUT,this.setFetchNow(a),this.reuseVisitorIds=void 0===u||u,this._decisionMode=c||I.DECISION_API,this._initialBucketing=l,this.hitDeduplicationTime=null!=h?h:d.DEFAULT_DEDUPLICATION_TIME,this.disableCache=!!v,this.disableDeveloperUsageTracking=b||!1,g&&(this.visitorCacheImplementation=g),p&&(this.hitCacheImplementation=p),this.onSdkStatusChanged=s,this._onVisitorExposed=C}),[{key:"batchActivateHits",get:function(){return this._batchActivateHits},set:function(t){this._batchActivateHits=t}},{key:"isQAModeEnabled",get:function(){return this._isQAModeEnabled},set:function(t){this._isQAModeEnabled=t}},{key:"disableDeveloperUsageTracking",get:function(){return this._disableDeveloperUsageTracking},set:function(t){this._disableDeveloperUsageTracking=t}},{key:"fetchFlagsBufferingTime",get:function(){return this._fetchFlagsBufferingTime},set:function(t){this._fetchFlagsBufferingTime=t}},{key:"nextFetchConfig",get:function(){return this._nextFetchConfig},set:function(t){this._nextFetchConfig=t}},{key:"fetchThirdPartyData",get:function(){return this._fetchThirdPartyData},set:function(t){this._fetchThirdPartyData=t}},{key:"trackingManagerConfig",get:function(){return this._trackingManagerConfig}},{key:"onLog",get:function(){return this._onLog},set:function(t){this._onLog=t}},{key:"onVisitorExposed",get:function(){return this._onVisitorExposed}},{key:"setFetchNow",value:function(t){this.fetchNow=void 0===t||t}},{key:"initQaMode",value:function(){if((0,E.isBrowser)())try{var t=sessionStorage.getItem(d.FS_IS_QA_MODE_ENABLED);this.isQAModeEnabled=t?JSON.parse(t):void 0}catch(t){(0,E.logError)(this,(0,E.errorFormat)(t.message||t),"initQaMode"),this.isQAModeEnabled=!1}}},{key:"initSDKInfo",value:function(t,e){switch(t){case 1:d.SDK_INFO.name="ReactJS",d.SDK_INFO.version=null!=e?e:S.version;break;case 2:d.SDK_INFO.name="React-Native",d.SDK_INFO.version=null!=e?e:S.version;break;default:d.SDK_INFO.name="undefined"!=typeof window&&"Deno"in window?"Deno":"TypeScript",d.SDK_INFO.version=S.version}}},{key:"initialBucketing",get:function(){return this._initialBucketing},set:function(t){this._initialBucketing=t}},{key:"reuseVisitorIds",get:function(){return this._reuseVisitorIds},set:function(t){this._reuseVisitorIds=t}},{key:"onBucketingUpdated",get:function(){return this._onBucketingUpdated},set:function(t){this._onBucketingUpdated=t}},{key:"envId",get:function(){return this._envId},set:function(t){this._envId=t}},{key:"apiKey",get:function(){return this._apiKey},set:function(t){this._apiKey=t}},{key:"decisionMode",get:function(){return this._decisionMode}},{key:"timeout",get:function(){return this._timeout},set:function(t){this._timeout=t}},{key:"logLevel",get:function(){return this._logLevel},set:function(t){this._logLevel=t}},{key:"fetchNow",get:function(){return this._fetchNow},set:function(t){this._fetchNow=t}},{key:"pollingInterval",get:function(){return this._pollingInterval},set:function(t){this._pollingInterval=t}},{key:"hitDeduplicationTime",get:function(){return this._hitDeduplicationTime},set:function(t){"number"==typeof t?this._hitDeduplicationTime=t:(0,E.logError)(this,(0,E.sprintf)(d.TYPE_ERROR,"hitDeduplicationTime","number"),"hitDeduplicationTime")}},{key:"visitorCacheImplementation",get:function(){return this._visitorCacheImplementation},set:function(t){this._visitorCacheImplementation=t}},{key:"hitCacheImplementation",get:function(){return this._hitCacheImplementation},set:function(t){this._hitCacheImplementation=t}},{key:"disableCache",get:function(){return this._disableCache},set:function(t){this._disableCache=t}},{key:"onSdkStatusChanged",get:function(){return this._onSdkStatusChanged},set:function(t){t&&"function"!=typeof t?(0,E.logError)(this,"statusChangedCallback must be a function","onSdkStatusChanged"):this._onSdkStatusChanged=t}},{key:"logManager",get:function(){return this._logManager},set:function(t){this._logManager=t}},{key:"decisionApiUrl",get:function(){return this._decisionApiUrl},set:function(t){"string"==typeof t?this._decisionApiUrl=t:(0,E.logError)(this,(0,E.sprintf)(d.TYPE_ERROR,"decisionApiUrl","string"),"decisionApiUrl")}}])}();function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}var b=function(t){function e(t){var n,i,r,o,s;return r=this,o=e,s=[O(O({},t),{},{decisionMode:I.BUCKETING})],o=u(o),(i=c(r,k()?Reflect.construct(o,s||[],u(r).constructor):o.apply(r,s))).pollingInterval=null!=(n=null==t?void 0:t.pollingInterval)?n:d.DEFAULT_POLLING_INTERVAL,i.onBucketingUpdated=null==t?void 0:t.onBucketingUpdated,i.fetchThirdPartyData=null==t?void 0:t.fetchThirdPartyData,i}return f(e,t),(0,n.default)(e)}(m);function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(D=function(){return!!t})()}var w=function(t){function e(t){return n=this,i=e,r=[N(N({},t),{},{decisionMode:I.DECISION_API})],i=u(i),c(n,D()?Reflect.construct(i,r||[],u(n).constructor):i.apply(n,r));var n,i,r}return f(e,t),(0,n.default)(e)}(m),x=function(){return(0,n.default)((function(t,e,n,i){this._config=t,this._decisionManager=e,this._trackingManager=n,this._sharedActionTracking=i}),[{key:"config",get:function(){return this._config},set:function(t){this._config=t}},{key:"decisionManager",get:function(){return this._decisionManager},set:function(t){this._decisionManager=t}},{key:"trackingManager",get:function(){return this._trackingManager},set:function(t){this._trackingManager=t}},{key:"sharedActionTracking",get:function(){return this._sharedActionTracking}}])}(),P=(r(8706),r(6033),function(t){return t.VISITOR_SEND_HIT="VISITOR_SEND_HIT",t.VISITOR_FETCH_CAMPAIGNS_ERROR="VISITOR_FETCH_CAMPAIGNS_ERROR",t.VISITOR_FETCH_CAMPAIGNS="VISITOR_FETCH_CAMPAIGNS",t.VISITOR_AUTHENTICATE="VISITOR_AUTHENTICATE",t.VISITOR_UNAUTHENTICATE="VISITOR_UNAUTHENTICATE",t.VISITOR_EXPOSED_FLAG_NOT_FOUND="VISITOR_EXPOSED_FLAG_NOT_FOUND",t.FLAG_VALUE_NOT_CALLED="FLAG_VALUE_NOT_CALLED",t.GET_FLAG_VALUE_FLAG_NOT_FOUND="GET_FLAG_VALUE_FLAG_NOT_FOUND",t.GET_FLAG_METADATA_TYPE_WARNING="GET_FLAG_METADATA_TYPE_WARNING",t.GET_FLAG_VALUE_TYPE_WARNING="GET_FLAG_VALUE_TYPE_WARNING",t.VISITOR_EXPOSED_TYPE_WARNING="VISITOR_EXPOSED_TYPE_WARNING",t.VISITOR_SEND_ACTIVATE="VISITOR_SEND_ACTIVATE",t.GET_CAMPAIGNS_ROUTE_RESPONSE_ERROR="GET_CAMPAIGNS_ROUTE_RESPONSE_ERROR",t.GET_CAMPAIGNS_ROUTE_RESPONSE="GET_CAMPAIGNS_ROUTE_RESPONSE",t.SDK_BUCKETING_FILE="SDK_BUCKETING_FILE",t.SEND_ACTIVATE_HIT_ROUTE_ERROR="SEND_ACTIVATE_HIT_ROUTE_ERROR",t.SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR="SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR",t.SEND_HIT_ROUTE_ERROR="SEND_HIT_ROUTE_ERROR",t.SDK_BUCKETING_FILE_ERROR="SDK_BUCKETING_FILE_ERROR",t.SDK_CONFIG="SDK_CONFIG",t.ACCOUNT_SETTINGS="ACCOUNT_SETTINGS",t.ACCOUNT_SETTINGS_ERROR="ACCOUNT_SETTINGS_ERROR",t.EMOTION_AI_SCORE="EMOTION_EAI_SCORE",t.EMOTION_AI_SCORE_FROM_LOCAL_CACHE="EMOTION_AI_SCORE_FROM_LOCAL_CACHE",t.EMOTION_AI_SCORE_ERROR="EMOTION_EAI_SCORE_ERROR",t.EMOTION_AI_VISITOR_EVENT="EMOTION_AI_VISITOR_EVENT",t.EMOTION_AI_VISITOR_EVENT_ERROR="EMOTION_AI_VISITOR_EVENT_ERROR",t.EMOTION_AI_PAGE_VIEW="EMOTION_AI_PAGE_VIEW",t.EMOTION_AI_PAGE_VIEW_ERROR="EMOTION_AI_PAGE_VIEW_ERROR",t.EMOTION_AI_START_COLLECTING="EMOTION_AI_START_COLLECTING",t.EMOTION_AI_STOP_COLLECTING="EMOTION_AI_STOP_COLLECTING",t.EMOTION_AI_START_SCORING="EMOTION_AI_START_SCORING",t.EMOTION_AI_SCORING_FAILED="EMOTION_AI_SCORING_FAILED",t.EMOTION_AI_SCORING_SUCCESS="EMOTION_AI_SCORING_SUCCESS",t}({})),L=function(t){return t.NONE="NONE",t.ANONYMOUS_ID_CACHE="ANONYMOUS_ID_CACHE",t.VISITOR_ID_CACHE="VISITOR_ID_CACHE",t.VISITOR_ID_CACHE_WITH_ANONYMOUS_ID_CACHE="VISITOR_ID_CACHE_WITH_ANONYMOUS_ID_CACHE",t}({}),M=function(t){return t.AB_TASTY_WEB_SDK_INITIALIZED="AB_TASTY_WEB_SDK_INITIALIZED",t}({}),H=(r(3418),r(739),r(2637),function(){return(0,n.default)((function(t){var e=t.type,n=t.userIp,i=t.screenResolution,r=t.locale,o=t.sessionNumber,s=t.visitorId,a=t.anonymousId,c=t.ds,u=t.qaMode,l=t.isActionTrackingHit;this._type=e,n&&(this.userIp=n),i&&(this.screenResolution=i),r&&(this.locale=r),o&&(this.sessionNumber=o),this.visitorId=s,this._anonymousId=a||null,this.createdAt=Date.now(),this.ds=c||d.SDK_APP,this.qaMode=u,this.isActionTrackingHit=l}),[{key:"isActionTrackingHit",get:function(){return this._isActionTrackingHit},set:function(t){this._isActionTrackingHit=t}},{key:"key",get:function(){return this._key},set:function(t){this._key=t}},{key:"sessionNumber",get:function(){return this._sessionNumber},set:function(t){this._sessionNumber=t}},{key:"locale",get:function(){return this._locale},set:function(t){this._locale=t}},{key:"screenResolution",get:function(){return this._screenResolution},set:function(t){this._screenResolution=t}},{key:"userIp",get:function(){return this._userIp},set:function(t){this._userIp=t}},{key:"anonymousId",get:function(){return this._anonymousId},set:function(t){this._anonymousId=t}},{key:"visitorId",get:function(){return this._visitorId},set:function(t){this._visitorId=t}},{key:"ds",get:function(){return this._ds},set:function(t){this._ds=t}},{key:"type",get:function(){return this._type}},{key:"config",get:function(){return this._config},set:function(t){this._config=t}},{key:"createdAt",get:function(){return this._createdAt},set:function(t){this._createdAt=t}},{key:"qaMode",get:function(){return this._qaMode},set:function(t){this._qaMode=t}},{key:"isNotEmptyString",value:function(t,e){return!(!t||"string"!=typeof t)||((0,E.logError)(this.config,(0,E.sprintf)(d.TYPE_ERROR,e,"string"),e),!1)}},{key:"isNumeric",value:function(t,e){return!(!t||"number"!=typeof t)||((0,E.logError)(this.config,(0,E.sprintf)(d.TYPE_ERROR,e,"number"),e),!1)}},{key:"isInteger",value:function(t,e){return!!Number.isInteger(t)||((0,E.logError)(this.config,(0,E.sprintf)(d.TYPE_ERROR,e,"integer"),e),!1)}},{key:"toApiKeys",value:function(){var t,e=(0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.VISITOR_ID_API_ITEM,this.visitorId),d.DS_API_ITEM,this.ds),d.CUSTOMER_ENV_ID_API_ITEM,"".concat(null==(t=this.config)?void 0:t.envId)),d.T_API_ITEM,this.type),d.CUSTOMER_UID,null),d.QT_API_ITEM,Date.now()-this._createdAt);return this.qaMode&&(e[d.QA_MODE_API_ITEM]=!0),this.userIp&&(e[d.USER_IP_API_ITEM]=this.userIp),this.screenResolution&&(e[d.SCREEN_RESOLUTION_API_ITEM]=this.screenResolution),this.locale&&(e[d.USER_LANGUAGE]=this.locale),this.sessionNumber&&(e[d.SESSION_NUMBER]=this.sessionNumber),this.visitorId&&this.anonymousId&&(e[d.VISITOR_ID_API_ITEM]=this.anonymousId,e[d.CUSTOMER_UID]=this.visitorId),e}},{key:"toObject",value:function(){return{key:this.key,visitorId:this.visitorId,ds:this.ds,type:this.type,userIp:this.userIp,screenResolution:this.screenResolution,locale:this.locale,sessionNumber:this.sessionNumber,anonymousId:this.anonymousId,createdAt:this.createdAt,qaMode:this.qaMode}}},{key:"isReady",value:function(){return!!(this.visitorId&&this.ds&&this.config&&this.config.envId&&this.type)}}])}()),F=function(t){return t[t.Timer=0]="Timer",t[t.BatchLength=1]="BatchLength",t[t.Flush=2]="Flush",t[t.ActivateLength=3]="ActivateLength",t[t.DirectHit=4]="DirectHit",t[t.DirectActivate=5]="DirectActivate",t}({});function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function G(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(G=function(){return!!t})()}var j=function(t){function e(t){var n,i,r,o;return i=this,r=e,o=[{type:t.type,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId}],r=u(r),(n=c(i,G()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o))).data=U(U({},t),{},{version:t.version||"1",stackType:t.stackType||"SDK",stackName:t.stackName||d.SDK_INFO.name,stackVersion:t.stackVersion||d.SDK_INFO.version,label:t.label,logLevel:t.logLevel,timestamp:t.timestamp||new Date(Date.now()).toISOString(),timeZone:n.getTimezone(),ds:d.SDK_APP,envId:t.envId||t.config.envId}),n._traffic=t.traffic,n.config=t.config,n}return f(e,t),(0,n.default)(e,[{key:"traffic",get:function(){return this._traffic},set:function(t){this._traffic=t}},{key:"getTimezone",value:function(){var t;return("object"===("undefined"==typeof Intl?"undefined":(0,a.default)(Intl))?null==(t=Intl.DateTimeFormat())||null==(t=t.resolvedOptions())?void 0:t.timeZone:void 0)||"".concat((new Date).getTimezoneOffset()/60)}},{key:"toApiKeys",value:function(){var t,e=(0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.VISITOR_ID_API_ITEM,this.visitorId),d.DS_API_ITEM,this.data.ds),d.CUSTOMER_ENV_ID_API_ITEM,"".concat(null==(t=this.data.config)?void 0:t.envId)),d.T_API_ITEM,this.type),"cv",{}),n={version:"".concat(this.data.version),logLevel:"".concat(y.LogLevel[this.data.logLevel]),timestamp:"".concat(this.data.timestamp),timeZone:"".concat(this.data.timeZone),label:"".concat(this.data.label),"stack.type":"".concat(this.data.stackType),"stack.name":"".concat(this.data.stackName),"stack.version":"".concat(this.data.stackVersion)};if(void 0!==this.data.lastBucketingTimestamp&&(n.lastBucketingTimestamp="".concat(this.data.lastBucketingTimestamp)),void 0!==this.data.lastInitializationTimestamp&&(n.lastInitializationTimestamp="".concat(this.data.lastInitializationTimestamp)),void 0!==this.data.flagshipInstanceId&&(n.flagshipInstanceId="".concat(this.data.flagshipInstanceId)),this.data.accountId&&(n.accountId="".concat(this.data.accountId)),this.data.envId&&(n.envId="".concat(this.data.envId)),void 0!==this.data.sdkBucketingFile&&(n.sdkBucketingFile=JSON.stringify(this.data.sdkBucketingFile)),void 0!==this.data.stackOriginName&&(n["stack.origin.name"]="".concat(this.data.stackOriginName)),void 0!==this.data.stackOriginVersion&&(n["stack.origin.version"]="".concat(this.data.stackOriginVersion)),void 0!==this.data.sdkStatus&&(n["sdk.status"]="".concat(v[this.data.sdkStatus])),void 0!==this.data.sdkConfigLogLevel&&(n["sdk.config.logLevel"]="".concat(y.LogLevel[this.data.sdkConfigLogLevel])),void 0!==this.data.sdkConfigMode&&(n["sdk.config.mode"]="".concat(this.data.sdkConfigMode)),void 0!==this.data.sdkConfigCustomLogManager&&(n["sdk.config.customLogManager"]="".concat(this.data.sdkConfigCustomLogManager)),void 0!==this.data.sdkConfigCustomCacheManager&&(n["sdk.config.customCacheManager"]="".concat(this.data.sdkConfigCustomCacheManager)),void 0!==this.data.sdkConfigStatusListener&&(n["sdk.config.custom.StatusListener"]="".concat(this.data.sdkConfigStatusListener)),void 0!==this.data.sdkConfigTimeout&&(n["sdk.config.timeout"]="".concat(1e3*this.data.sdkConfigTimeout)),void 0!==this.data.sdkConfigPollingInterval&&(n["sdk.config.pollingTime"]="".concat(1e3*this.data.sdkConfigPollingInterval)),void 0!==this.data.sdkConfigTrackingManagerStrategy&&(n["sdk.config.trackingManager.strategy"]="".concat(T[this.data.sdkConfigTrackingManagerStrategy])),void 0!==this.data.sdkConfigTrackingManagerBatchIntervals&&(n["sdk.config.trackingManager.batchIntervals"]="".concat(1e3*this.data.sdkConfigTrackingManagerBatchIntervals)),void 0!==this.data.sdkConfigTrackingManagerPoolMaxSize&&(n["sdk.config.trackingManager.poolMaxSize"]="".concat(this.data.sdkConfigTrackingManagerPoolMaxSize)),void 0!==this.data.sdkConfigFetchNow&&(n["sdk.config.fetchNow"]="".concat(this.data.sdkConfigFetchNow)),void 0!==this.data.sdkConfigReuseVisitorIds&&(n["sdk.config.reuseVisitorIds"]="".concat(this.data.sdkConfigReuseVisitorIds)),void 0!==this.data.sdkConfigInitialBucketing&&(n["sdk.config.initialBucketing"]=JSON.stringify(this.data.sdkConfigInitialBucketing)),void 0!==this.data.sdkConfigDecisionApiUrl&&(n["sdk.config.decisionApiUrl"]="".concat(this.data.sdkConfigDecisionApiUrl)),void 0!==this.data.sdkConfigHitDeduplicationTime&&(n["sdk.config.hitDeduplicationTime"]="".concat(1e3*this.data.sdkConfigHitDeduplicationTime)),void 0!==this.data.sdkConfigUsingCustomHitCache&&(n["sdk.config.usingCustomHitCache"]=JSON.stringify(this.data.sdkConfigUsingCustomHitCache)),void 0!==this.data.sdkConfigUsingCustomVisitorCache&&(n["sdk.config.usingCustomVisitorCache"]=JSON.stringify(this.data.sdkConfigUsingCustomVisitorCache)),void 0!==this.data.sdkConfigUsingOnVisitorExposed&&(n["sdk.config.usingOnVisitorExposed"]=JSON.stringify(this.data.sdkConfigUsingOnVisitorExposed)),void 0!==this.data.sdkConfigFetchThirdPartyData&&(n["sdk.config.fetchThirdPartyData"]=JSON.stringify(this.data.sdkConfigFetchThirdPartyData)),void 0!==this.data.sdkConfigFetchFlagsBufferingTime&&(n["sdk.config.fetchFlagsBufferingTime"]=JSON.stringify(1e3*this.data.sdkConfigFetchFlagsBufferingTime)),void 0!==this.data.sdkConfigNextFetchConfig&&(n["sdk.config.nextFetchConfig"]=JSON.stringify(this.data.sdkConfigNextFetchConfig)),void 0!==this.data.sdkConfigDisableDeveloperUsageTracking&&(n["sdk.config.disableDeveloperUsageTracking"]=JSON.stringify(this.data.sdkConfigDisableDeveloperUsageTracking)),void 0!==this.data.sdkConfigDisableCache&&(n["sdk.config.disableCache"]=JSON.stringify(this.data.sdkConfigDisableCache)),void 0!==this.data.httpRequestUrl&&(n["http.request.url"]="".concat(this.data.httpRequestUrl)),void 0!==this.data.httpRequestMethod&&(n["http.request.method"]="".concat(this.data.httpRequestMethod)),void 0!==this.data.httpRequestHeaders&&(n["http.request.headers"]=JSON.stringify(this.data.httpRequestHeaders)),void 0!==this.data.httpRequestBody&&(n["http.request.body"]=JSON.stringify(this.data.httpRequestBody)),void 0!==this.data.httpResponseUrl&&(n["http.response.url"]="".concat(this.data.httpResponseUrl)),void 0!==this.data.httpResponseMethod&&(n["http.response.method"]="".concat(this.data.httpResponseMethod)),void 0!==this.data.httpResponseHeaders&&(n["http.response.headers"]=JSON.stringify(this.data.httpResponseHeaders)),void 0!==this.data.httpResponseCode&&(n["http.response.code"]="".concat(this.data.httpResponseCode)),void 0!==this.data.httpResponseBody&&(n["http.response.body"]=JSON.stringify(this.data.httpResponseBody)),void 0!==this.data.httpResponseTime&&(n["http.response.time"]="".concat(this.data.httpResponseTime)),void 0!==this.visitorId&&(n["visitor.visitorId"]="".concat(this.visitorId)),void 0!==this.anonymousId&&(n["visitor.anonymousId"]="".concat(this.anonymousId)),void 0!==this.data.visitorSessionId&&(n["visitor.sessionId"]="".concat(this.data.visitorSessionId)),void 0!==this.data.visitorStatus&&(n["visitor.status"]="".concat(this.data.visitorStatus)),void 0!==this.data.visitorInstanceType&&(n["visitor.instanceType"]="".concat(this.data.visitorInstanceType)),void 0!==this.data.visitorContext)for(var i in this.data.visitorContext){var r=this.data.visitorContext[i];n["visitor.context.[".concat(i,"]")]="".concat(r)}if(void 0!==this.data.visitorConsent&&(n["visitor.consent"]="".concat(this.data.visitorConsent)),void 0!==this.data.visitorAssignmentHistory)for(var o in this.data.visitorAssignmentHistory){var s=this.data.visitorAssignmentHistory[o];n["visitor.assignments.[".concat(o,"]")]=s}if(void 0!==this.data.visitorFlags&&this.data.visitorFlags.forEach((function(t,e){for(var i in t){var r=t[i],o="value"===i||"key"===i,s="string"==typeof r?r:JSON.stringify(r);n["visitor.flags.[".concat(e,"]").concat(o?"":".metadata",".").concat(i)]=s}})),void 0!==this.data.visitorIsAuthenticated&&(n["visitor.isAuthenticated"]="".concat(this.data.visitorIsAuthenticated)),void 0!==this.data.visitorInitialCampaigns&&(n["visitor.initialCampaigns"]=JSON.stringify(this.data.visitorInitialCampaigns)),void 0!==this.data.visitorInitialFlagsData&&(n["visitor.initialFlagsData"]=JSON.stringify(Array.isArray(this.data.visitorInitialFlagsData)?this.data.visitorInitialFlagsData:Array.from(this.data.visitorInitialFlagsData))),void 0!==this.data.visitorCampaigns&&(n["visitor.campaigns"]=JSON.stringify(this.data.visitorCampaigns)),void 0!==this.data.visitorCampaignFromCache&&(n["visitor.campaignFromCache"]=JSON.stringify(this.data.visitorCampaignFromCache)),void 0!==this.data.contextKey&&(n.contextKey="".concat(this.data.contextKey)),void 0!==this.data.contextValue&&(n.contextValue="".concat(this.data.contextValue)),void 0!==this.data.flagKey&&(n["flag.key"]="".concat(this.data.flagKey)),void 0!==this.data.flagValue&&(n["flag.value"]="".concat(this.data.flagValue)),void 0!==this.data.flagDefault&&(n["flag.default"]=JSON.stringify(this.data.flagDefault)),void 0!==this.data.flagMetadataCampaignId&&(n["flag.metadata.campaignId"]="".concat(this.data.flagMetadataCampaignId)),void 0!==this.data.flagMetadataCampaignName&&(n["flag.metadata.campaignName"]="".concat(this.data.flagMetadataCampaignName)),void 0!==this.data.flagMetadataVariationGroupId&&(n["flag.metadata.variationGroupId"]="".concat(this.data.flagMetadataVariationGroupId)),void 0!==this.data.flagMetadataVariationGroupName&&(n["flag.metadata.variationGroupName"]="".concat(this.data.flagMetadataVariationGroupName)),void 0!==this.data.flagMetadataVariationId&&(n["flag.metadata.variationId"]="".concat(this.data.flagMetadataVariationId)),void 0!==this.data.flagMetadataVariationName&&(n["flag.metadata.variationName"]="".concat(this.data.flagMetadataVariationName)),void 0!==this.data.flagMetadataCampaignSlug&&(n["flag.metadata.campaignSlug"]="".concat(this.data.flagMetadataCampaignSlug)),void 0!==this.data.flagMetadataCampaignType&&(n["flag.metadata.campaignType"]="".concat(this.data.flagMetadataCampaignType)),void 0!==this.data.flagMetadataCampaignIsReference&&(n["flag.metadata.isReference"]="".concat(this.data.flagMetadataCampaignIsReference)),void 0!==this.data.hitContent)for(var a in this.data.hitContent){var c=this.data.hitContent[a];n["hit.".concat(a)]="string"==typeof c?c:JSON.stringify(c)}if(void 0!==this.data.batchTriggeredBy&&(n.batchTriggeredBy="".concat(F[this.data.batchTriggeredBy])),void 0!==this.data.accountSettings)for(var u in this.data.accountSettings){var l=this.data.accountSettings[u];n["accountSettings.".concat(u)]="string"==typeof l?l:JSON.stringify(l)}return void 0!==this.data.eAIScore&&(n["eAIScore.eai.eas"]=this.data.eAIScore.eai.eas),void 0!==this.data.isEAIScoreFromLocalCache&&(n.isEAIScoreFromLocalCache="".concat(this.data.isEAIScoreFromLocalCache)),void 0!==this.data.eAIDataTimestamp&&(n.eAIDataTimestamp="".concat(this.data.eAIDataTimestamp)),e.cv=n,e}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this))}},{key:"getErrorMessage",value:function(){return"event category and event action are required"}}])}(H);function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Q(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Q=function(){return!!t})()}var q=function(t){function e(t){return n=this,i=e,r=[K(K({},t),{},{type:"TROUBLESHOOTING"})],i=u(i),c(n,Q()?Reflect.construct(i,r||[],u(n).constructor):i.apply(n,r));var n,i,r}return f(e,t),(0,n.default)(e)}(j),Y=function(){return(0,n.default)((function(t){var e=t.httpClient,n=t.config,i=t.trackingManager,r=t.flagshipInstanceId;(0,_.default)(this,"_panic",!1),this._config=n,this._httpClient=e,this._trackingManager=i,this._flagshipInstanceId=r||""}),[{key:"trackingManager",get:function(){return this._trackingManager},set:function(t){this._trackingManager=t}},{key:"flagshipInstanceId",get:function(){return this._flagshipInstanceId},set:function(t){this._flagshipInstanceId=t}},{key:"lastBucketingTimestamp",get:function(){return this._lastBucketingTimestamp}},{key:"troubleshooting",get:function(){return this._troubleshooting},set:function(t){this._troubleshooting=t}},{key:"config",get:function(){return this._config}},{key:"panic",set:function(t){this.updateFlagshipStatus(t?v.SDK_PANIC:v.SDK_INITIALIZED),this._panic=t,t&&(0,E.logDebug)(this.config,d.FETCH_FLAGS_PANIC_MODE,d.PROCESS_FETCHING_FLAGS)}},{key:"statusChangedCallback",value:function(t){this._statusChangedCallback=t}},{key:"updateFlagshipStatus",value:function(t){"function"==typeof this._statusChangedCallback&&this._statusChangedCallback&&this._statusChangedCallback(t)}},{key:"getModifications",value:function(t){var e=new Map;return t.forEach((function(t){var n=t.variation.modifications.value;for(var i in n){var r=n[i];e.set(i,{key:i,campaignId:t.id,campaignName:t.name||"",variationGroupId:t.variationGroupId,variationGroupName:t.variationGroupName||"",variationId:t.variation.id,variationName:t.variation.name||"",isReference:!!t.variation.reference,campaignType:t.type,slug:t.slug,value:r})}})),e}},{key:"isPanic",value:function(){return this._panic}},{key:"handleTroubleshootingError",value:function(t){var e,n=t.error,i=t.visitor,r=t.requestBody,o=t.headers,s=t.url,a=t.now,c=new q({label:P.GET_CAMPAIGNS_ROUTE_RESPONSE_ERROR,logLevel:y.LogLevel.ERROR,visitorId:i.visitorId,flagshipInstanceId:this.flagshipInstanceId,anonymousId:i.anonymousId,visitorSessionId:i.instanceId,traffic:100,config:this.config,visitorContext:i.context,httpRequestBody:r,httpRequestHeaders:o,httpRequestMethod:"POST",httpRequestUrl:s,httpResponseBody:null==n?void 0:n.message,httpResponseHeaders:null==n?void 0:n.headers,httpResponseCode:null==n?void 0:n.statusCode,httpResponseTime:Date.now()-a});null==(e=this.trackingManager)||e.addTroubleshootingHit(c);var u=(0,E.errorFormat)(n.message||n,{url:s,headers:o,body:r,duration:Date.now()-a});throw new Error(u)}},{key:"getDecisionApiCampaignsAsync",value:(t=e(s().mark((function t(e){var n,i,r,o,a,c,u,l,f,h;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.HEADER_X_API_KEY,"".concat(this.config.apiKey)),d.HEADER_X_SDK_CLIENT,d.SDK_INFO.name),d.HEADER_X_SDK_VERSION,d.SDK_INFO.version),d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),i={visitorId:e.visitorId,anonymousId:e.anonymousId,trigger_hit:!1,context:e.context,visitor_consent:e.hasConsented},r="".concat(this.config.decisionApiUrl||d.BASE_API_URL).concat(this.config.envId).concat(d.URL_CAMPAIGNS,"?").concat(d.EXPOSE_ALL_KEYS,"=true&extras[]=accountSettings"),o=Date.now(),t.prev=4,t.next=7,this._httpClient.postAsync(r,{headers:n,timeout:this.config.timeout,body:i,nextFetchConfig:this.config.nextFetchConfig});case 7:return l=t.sent,this.panic=!(null==l||null==(a=l.body)||!a.panic),f=null,null!=l&&null!=(c=l.body)&&c.campaigns&&(f=l.body.campaigns),(h=null==l||null==(u=l.body)||null==(u=u.extras)||null==(u=u.accountSettings)?void 0:u.troubleshooting)&&(this.troubleshooting={startDate:new Date(h.startDate),endDate:new Date(h.endDate),timezone:h.timezone,traffic:h.traffic}),t.abrupt("return",f);case 16:t.prev=16,t.t0=t.catch(4),this.handleTroubleshootingError({error:t.t0,visitor:e,requestBody:i,headers:n,url:r,now:o});case 19:case"end":return t.stop()}}),t,this,[[4,16]])}))),function(e){return t.apply(this,arguments)})}]);var t}();function W(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(W=function(){return!!t})()}var z=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,W()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"getCampaignsAsync",value:(r=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getDecisionApiCampaignsAsync(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r}(Y);function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function J(t,e){if(t){if("string"==typeof t)return X(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(t,e):void 0}}function Z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);c=!0);}catch(t){u=!0,r=t}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw r}}return a}}(t,e)||J(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r(5506);var $=function(t){return t.PAGE_VIEW="PAGEVIEW",t.PAGE="PAGEVIEW",t.SCREEN_VIEW="SCREENVIEW",t.SCREEN="SCREENVIEW",t.TRANSACTION="TRANSACTION",t.ITEM="ITEM",t.EVENT="EVENT",t}({});function tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function nt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(nt=function(){return!!t})()}var it=function(t){function e(t){var n,i,r,o;return i=this,r=e,o=[{type:"SEGMENT",userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode,isActionTrackingHit:t.isActionTrackingHit}],r=u(r),(n=c(i,nt()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o))).context=t.context,n}return f(e,t),(0,n.default)(e,[{key:"context",get:function(){return this._context},set:function(t){this._context=t}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this)||!this.context)}},{key:"toApiKeys",value:function(){var e=t.prototype.toApiKeys.call(this);return e[d.S_API_ITEM]=this.context,e}},{key:"toObject",value:function(){return et(et({},t.prototype.toObject.call(this)),{},{context:this.context})}},{key:"getErrorMessage",value:function(){return"data property is required"}}])}(H),rt=(r(4423),r(6034),r(1699),function(t){return t.ACTION_TRACKING="Action Tracking",t.USER_ENGAGEMENT="User Engagement",t}({}));function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function st(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function at(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(at=function(){return!!t})()}var ct=function(t){function e(t){var n,i,r,o;i=this,r=e,o=[{type:$.EVENT,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode,isActionTrackingHit:t.isActionTrackingHit}],r=u(r),n=c(i,at()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o));var s=t.category,a=t.action,l=t.label,f=t.value;return n.category=s,n.action=a,l&&(n.label=l),f&&(n.value=f),n}return f(e,t),(0,n.default)(e,[{key:"category",get:function(){return this._category},set:function(t){Object.values(rt).includes(t)?this._category=t:(0,E.logError)(this.config,"The category value must be either EventCategory::ACTION_TRACKING or EventCategory::ACTION_TRACKING","category")}},{key:"action",get:function(){return this._action},set:function(t){this.isNotEmptyString(t,"action")&&(this._action=t)}},{key:"label",get:function(){return this._label},set:function(t){this.isNotEmptyString(t,"label")&&(this._label=t)}},{key:"value",get:function(){return this._value},set:function(t){!Number.isInteger(t)||t<0?(0,E.logError)(this.config,"value must be an integer and be >= 0","value"):this._value=t}},{key:"toApiKeys",value:function(){var e=t.prototype.toApiKeys.call(this);return e[d.EVENT_CATEGORY_API_ITEM]=this.category,e[d.EVENT_ACTION_API_ITEM]=this.action,this.label&&(e[d.EVENT_LABEL_API_ITEM]=this.label),this.value&&(e[d.EVENT_VALUE_API_ITEM]=this.value),e}},{key:"toObject",value:function(){return st(st({},t.prototype.toObject.call(this)),{},{category:this.category,action:this.action,label:this.label,value:this.value})}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this)||!this.category||!this.action)}},{key:"getErrorMessage",value:function(){return"event category and event action are required"}}])}(H);function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ft(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ft=function(){return!!t})()}var ht=function(t){function e(t){var n,i,r,o;return i=this,r=e,o=[{type:$.SCREEN_VIEW,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode,isActionTrackingHit:t.isActionTrackingHit}],r=u(r),(n=c(i,ft()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o))).documentLocation=t.documentLocation,n}return f(e,t),(0,n.default)(e,[{key:"documentLocation",get:function(){return this._documentLocation},set:function(t){this.isNotEmptyString(t,"documentLocation")&&(this._documentLocation=t)}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this)||!this.documentLocation)}},{key:"toApiKeys",value:function(){var e=t.prototype.toApiKeys.call(this);return e[d.DL_API_ITEM]=this.documentLocation,e}},{key:"toObject",value:function(){return lt(lt({},t.prototype.toObject.call(this)),{},{documentLocation:this.documentLocation})}},{key:"getErrorMessage",value:function(){return"Screen name is required"}}])}(H),dt=(r(2062),r(4782),function(){return(0,n.default)((function(t,e){this._config=e,this._hits=t}),[{key:"hits",get:function(){return this._hits}},{key:"config",get:function(){return this._config}},{key:"toApiKeys",value:function(){var t;return(0,_.default)((0,_.default)({},d.CUSTOMER_ENV_ID_API_ITEM,"".concat(null==(t=this.config)?void 0:t.envId)),d.BATCH,this.hits.map((function(t){var e=t.toApiKeys();return delete e[d.CUSTOMER_ENV_ID_API_ITEM],e})))}}])}());function gt(t){return function(t){if(Array.isArray(t))return X(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||J(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function It(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(It=function(){return!!t})()}r(9463),r(2259),r(7495),r(8781);var _t=function(t){function e(t){var n,i,r,o;i=this,r=e,o=[{type:"ACTIVATE",userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode}],r=u(r),n=c(i,It()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o));var s=t.variationGroupId,a=t.variationId,l=t.flagKey,f=t.flagValue,h=t.flagDefaultValue,d=t.flagMetadata,g=t.visitorContext;return n.variationGroupId=s,n.variationId=a,n.flagKey=l,n.flagValue=f,n.flagDefaultValue=h,n.flagMetadata=d,n.visitorContext=g,n}return f(e,t),(0,n.default)(e,[{key:"variationGroupId",get:function(){return this._variationGroupId},set:function(t){this._variationGroupId=t}},{key:"variationId",get:function(){return this._variationId},set:function(t){this._variationId=t}},{key:"flagKey",get:function(){return this._flagKey},set:function(t){this._flagKey=t}},{key:"flagValue",get:function(){return this._flagValue},set:function(t){this._flagValue=t}},{key:"flagDefaultValue",get:function(){return this._flagDefaultValue},set:function(t){this._flagDefaultValue=t}},{key:"flagMetadata",get:function(){return this._flagMetadata},set:function(t){this._flagMetadata=t}},{key:"visitorContext",get:function(){return this._visitorContext},set:function(t){this._visitorContext=t}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this)||!this.variationGroupId||!this.variationId)}},{key:"toApiKeys",value:function(){var t=(0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.VISITOR_ID_API_ITEM,this.anonymousId||this.visitorId),d.VARIATION_ID_API_ITEM,this.variationId),d.VARIATION_GROUP_ID_API_ITEM_ACTIVATE,this.variationGroupId),d.CUSTOMER_ENV_ID_API_ACTIVATE,this.config.envId),d.ANONYMOUS_ID,null),d.QT_API_ITEM,Date.now()-this.createdAt);return this.visitorId&&this.anonymousId&&(t[d.VISITOR_ID_API_ITEM]=this.visitorId,t[d.ANONYMOUS_ID]=this.anonymousId),this.qaMode&&(t[d.QA_MODE_API_ITEM]=this.qaMode),t}},{key:"toObject",value:function(){return vt(vt({},t.prototype.toObject.call(this)),{},{variationGroupId:this.variationGroupId,variationId:this.variationId})}},{key:"getErrorMessage",value:function(){return"variationGroupId and variationId are required"}}])}(H);function yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yt(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Tt=function(){return!!t})()}r(8431);var At=function(t){function e(t){var n,i,r,o;return i=this,r=e,o=[Et(Et({},t),{},{visitorId:"",anonymousId:"",type:"BATCH"})],r=u(r),(n=c(i,Tt()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o))).hits=t.hits,n}return f(e,t),(0,n.default)(e,[{key:"hits",get:function(){return this._hits},set:function(t){this._hits=t}},{key:"isReady",value:function(){return!!(t.prototype.isReady.call(this)&&this.hits&&this.hits.length>0&&this.hits.every((function(t){return t.isReady(!1)})))}},{key:"toApiKeys",value:function(){var t,e=(0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.DS_API_ITEM,this.ds),d.CUSTOMER_ENV_ID_API_ITEM,"".concat(null==(t=this.config)?void 0:t.envId)),d.T_API_ITEM,this.type),d.QT_API_ITEM,Date.now()-this.createdAt);return e.h=this.hits.map((function(t){var e=t.toApiKeys();return delete e[d.DS_API_ITEM],delete e[d.CUSTOMER_ENV_ID_API_ITEM],e})),e}},{key:"getErrorMessage",value:function(){return"Please check required fields"}}])}(H);function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function mt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ct(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ot(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ot(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var kt=function(){return(0,n.default)((function(t){var e=t.config,n=t.hitsPoolQueue,i=t.httpClient,r=t.activatePoolQueue,o=t.troubleshootingQueue,s=t.flagshipInstanceId,a=t.analyticHitQueue,c=t.initTroubleshootingHit,u=t.sharedActionTracking;this._HitsToFsQa=[],this._hasInitTroubleshootingHitSent=!1,this._config=e,this._hitsPoolQueue=n,this._httpClient=i,this._activatePoolQueue=r,this._troubleshootingQueue=o,this._flagshipInstanceId=s,this._usageHitQueue=a,this._isUsageHitQueueSending=!1,this._isTroubleshootingQueueSending=!1,this._initTroubleshootingHit=c,this._sharedActionTracking=u}),[{key:"flagshipInstanceId",get:function(){return this._flagshipInstanceId}},{key:"troubleshootingData",get:function(){return this._troubleshootingData},set:function(t){this._troubleshootingData=t}},{key:"config",get:function(){return this._config}},{key:"initTroubleshootingHit",get:function(){return this._initTroubleshootingHit},set:function(t){this._initTroubleshootingHit=t}},{key:"dispatchHitsToTag",value:function(t){if((0,E.isBrowser)()){var e,n,i=[],r=Ct(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;if(o.type===$.EVENT&&o.category===rt.ACTION_TRACKING&&!o.isActionTrackingHit){var s=o;i.push({visitorId:s.visitorId,createdAt:s.createdAt,anonymousId:s.anonymousId,data:{ec:s.category,ea:s.action,el:s.label,ev:s.value}})}}}catch(t){r.e(t)}finally{r.f()}i.length&&(null==(n=this._sharedActionTracking)||n.dispatchEventHits(i))}}},{key:"sendHitsToFsQa",value:function(t){var e=this;(0,E.isBrowser)()&&this.config.isQAModeEnabled&&r.e(532).then(r.bind(r,6532)).then((function(n){var i;(i=e._HitsToFsQa).push.apply(i,gt(t)),e._HitsToFsQa.length>=10&&(n.sendFsHitToQA(e._HitsToFsQa.map((function(t){return t.toApiKeys()}))),e._HitsToFsQa=[]),e._sendFsHitToQATimeoutId&&clearTimeout(e._sendFsHitToQATimeoutId),e._HitsToFsQa.length&&(e._sendFsHitToQATimeoutId=setTimeout((function(){n.sendFsHitToQA(e._HitsToFsQa.map((function(t){return t.toApiKeys()}))),e._HitsToFsQa=[]}),3e3))}))}},{key:"addHit",value:(S=e(s().mark((function t(e){var n,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="".concat(e.visitorId,":").concat((0,E.uuidV4)()),e.key=i,t.next=4,this.addHitInPoolQueue(e);case 4:if(e.type!==$.EVENT||e.action!==d.FS_CONSENT||e.label!=="".concat(d.SDK_INFO.name,":false")){t.next=7;break}return t.next=7,this.notConsent(e.visitorId);case 7:(0,E.logDebugSprintf)(this.config,d.TRACKING_MANAGER,d.HIT_ADDED_IN_QUEUE,e.toApiKeys()),null!=(n=this.config.trackingManagerConfig)&&n.poolMaxSize&&this._hitsPoolQueue.size>=this.config.trackingManagerConfig.poolMaxSize&&this.config.decisionMode!==I.BUCKETING_EDGE&&this.sendBatch();case 9:case"end":return t.stop()}}),t,this)}))),function(t){return S.apply(this,arguments)})},{key:"activateFlag",value:(A=e(s().mark((function t(e){var n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=new _t(e)).config=this.config,i="".concat(n.visitorId,":").concat((0,E.uuidV4)()),n.key=i,this.config.decisionMode!==I.BUCKETING_EDGE&&!this.config.batchActivateHits){t.next=9;break}return t.next=7,this.activateFlagEdgeMode(n);case 7:return(0,E.logDebug)(this.config,(0,E.sprintf)(d.ACTIVATE_ADDED_IN_QUEUE,JSON.stringify(n.toApiKeys())),d.ADD_ACTIVATE),t.abrupt("return");case 9:return r=[],this._activatePoolQueue.size&&(r=Array.from(this._activatePoolQueue.values())),this._activatePoolQueue.clear(),t.next=14,this.sendActivate({activateHitsPool:r,currentActivate:n,batchTriggeredBy:F.ActivateLength});case 14:case"end":return t.stop()}}),t,this)}))),function(t){return A.apply(this,arguments)})},{key:"activateFlagEdgeMode",value:(T=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._activatePoolQueue.set(e.key,e),t.next=3,this.cacheHit(new Map([[e.key,e]]));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return T.apply(this,arguments)})},{key:"onVisitorExposed",value:function(t){var e=this.config.onVisitorExposed;if("function"==typeof e){var n={key:t.flagKey,value:t.flagValue,defaultValue:t.flagDefaultValue,metadata:t.flagMetadata};e({exposedVisitor:{id:t.visitorId,anonymousId:t.anonymousId,context:t.visitorContext},fromFlag:n})}}},{key:"sendBatch",value:(v=e(s().mark((function t(){var e,n,i,r,o,a,c,u,l,f,h,g,p,v=this,I=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=I.length>0&&void 0!==I[0]?I[0]:F.BatchLength,!this._activatePoolQueue.size){t.next=6;break}return n=Array.from(this._activatePoolQueue.values()),this._activatePoolQueue.clear(),t.next=6,this.sendActivate({activateHitsPool:n,batchTriggeredBy:e});case 6:(i=new At({hits:[],ds:d.SDK_APP})).config=this.config,r=[],o=Ct(this._hitsPoolQueue),t.prev=10,o.s();case 12:if((a=o.n()).done){t.next=24;break}if(c=Z(a.value,2),u=c[0],l=c[1],!(Date.now()-l.createdAt>=d.DEFAULT_HIT_CACHE_TIME_MS)){t.next=17;break}return r.push(u),t.abrupt("continue",22);case 17:if(!(JSON.stringify(i).length>d.BATCH_MAX_SIZE)){t.next=20;break}return t.abrupt("break",24);case 20:i.hits.push(l),r.push(u);case 22:t.next=12;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(10),o.e(t.t0);case 29:return t.prev=29,o.f(),t.finish(29);case 32:if(r.forEach((function(t){v._hitsPoolQueue.delete(t)})),i.hits.length){t.next=35;break}return t.abrupt("return");case 35:return f=(0,_.default)({},d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),h=i.toApiKeys(),g=Date.now(),t.prev=38,t.next=41,this._httpClient.postAsync(d.HIT_EVENT_URL,{headers:f,body:h,timeout:this.config.timeout,nextFetchConfig:this.config.nextFetchConfig});case 41:return(0,E.logDebugSprintf)(this.config,d.TRACKING_MANAGER,d.HIT_SENT_SUCCESS,d.BATCH_HIT,{url:d.HIT_EVENT_URL,body:h,headers:f,nextFetchConfig:this.config.nextFetchConfig,duration:Date.now()-g,batchTriggeredBy:F[e]}),t.next=44,this.flushHits(r);case 44:this.sendHitsToFsQa(i.hits),this.dispatchHitsToTag(i.hits),t.next=54;break;case 48:t.prev=48,t.t1=t.catch(38),i.hits.forEach((function(t){v._hitsPoolQueue.set(t.key,t)})),(0,E.logErrorSprintf)(this.config,d.TRACKING_MANAGER,d.TRACKING_MANAGER_ERROR,d.BATCH_HIT,{httpRequestBody:h,httpRequestHeaders:f,httpRequestMethod:"POST",httpRequestUrl:d.HIT_EVENT_URL,httpResponseBody:null==t.t1?void 0:t.t1.message,httpResponseHeaders:null==t.t1?void 0:t.t1.headers,httpResponseCode:null==t.t1?void 0:t.t1.statusCode,duration:Date.now()-g,batchTriggeredBy:F[e]}),p=new q({label:P.SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR,logLevel:y.LogLevel.ERROR,visitorId:"".concat(this._flagshipInstanceId),flagshipInstanceId:this._flagshipInstanceId,traffic:0,config:this.config,httpRequestBody:i.hits,httpRequestHeaders:f,httpResponseBody:null==t.t1?void 0:t.t1.message,httpResponseHeaders:null==t.t1?void 0:t.t1.headers,httpResponseMethod:"POST",httpResponseUrl:d.HIT_EVENT_URL,httpResponseCode:null==t.t1?void 0:t.t1.statusCode,httpResponseTime:Date.now()-g,batchTriggeredBy:e}),this.sendTroubleshootingHit(p);case 54:case"end":return t.stop()}}),t,this,[[10,26,29,32],[38,48]])}))),function(){return v.apply(this,arguments)})},{key:"notConsent",value:(p=e(s().mark((function t(e){var n,i,r,o=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Array.from(this._hitsPoolQueue).filter((function(t){var n=Z(t,2)[1];return!((null==n?void 0:n.type)===$.EVENT&&(null==n?void 0:n.action)===d.FS_CONSENT||n.visitorId!==e&&n.anonymousId!==e)})),i=Array.from(this._activatePoolQueue).filter((function(t){var n=Z(t,2)[1];return n.visitorId===e||n.anonymousId===e})),r=[],n.forEach((function(t){var e=Z(t,1)[0];o._hitsPoolQueue.delete(e),r.push(e)})),i.forEach((function(t){var e=Z(t,1)[0];o._activatePoolQueue.delete(e),r.push(e)})),r.length){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.flushHits(r);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"cacheHit",value:(g=e(s().mark((function t(e){var n,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=this.config.hitCacheImplementation,!this.config.disableCache&&n&&"function"==typeof n.cacheHit){t.next=4;break}return t.abrupt("return");case 4:return i={},e.forEach((function(t,e){var n={version:d.HIT_CACHE_VERSION,data:{visitorId:t.visitorId,anonymousId:t.anonymousId,type:t.type,content:t.toObject(),time:Date.now()}};i[e]=n})),t.next=8,n.cacheHit(i);case 8:(0,E.logDebugSprintf)(this.config,d.PROCESS_CACHE_HIT,d.HIT_CACHE_SAVED,i),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),(0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.HIT_CACHE_ERROR,"cacheHit",t.t0.message||t.t0);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return g.apply(this,arguments)})},{key:"flushHits",value:(h=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=this.config.hitCacheImplementation,!this.config.disableCache&&n&&"function"==typeof n.flushHits){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.flushHits(e);case 6:(0,E.logDebugSprintf)(this.config,d.PROCESS_CACHE,d.HIT_DATA_FLUSHED,e),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.HIT_CACHE_ERROR,"flushHits",t.t0.message||t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t){return h.apply(this,arguments)})},{key:"flushAllHits",value:(f=e(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.config.hitCacheImplementation,!this.config.disableCache&&e&&"function"==typeof e.flushAllHits){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e.flushAllHits();case 6:(0,E.logDebug)(this.config,d.ALL_HITS_FLUSHED,d.PROCESS_FLUSH_HIT),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.HIT_CACHE_ERROR,"flushAllHits",t.t0.message||t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return f.apply(this,arguments)})},{key:"isTroubleshootingActivated",value:function(){if(!this.troubleshootingData)return!1;var t=new Date;return t>=this.troubleshootingData.startDate&&(!(t>this.troubleshootingData.endDate)||(this._hasInitTroubleshootingHitSent=!1,!1))}},{key:"addTroubleshootingHit",value:(l=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.key||(n="".concat(e.visitorId,":").concat((0,E.uuidV4)()),e.key=n),this._troubleshootingQueue.set(e.key,e),(0,E.logDebug)(this.config,(0,E.sprintf)(d.TROUBLESHOOTING_HIT_ADDED_IN_QUEUE,JSON.stringify(e.toApiKeys())),d.ADD_TROUBLESHOOTING_HIT);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"sendTroubleshootingHit",value:(u=e(s().mark((function t(e){var n,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isTroubleshootingActivated()&&void 0!==e.traffic&&!(this.troubleshootingData.traffic<e.traffic)){t.next=2;break}return t.abrupt("return");case 2:return n=e.toApiKeys(),i=Date.now(),t.prev=4,t.next=7,this._httpClient.postAsync(d.TROUBLESHOOTING_HIT_URL,{body:n});case 7:if((0,E.logDebug)(this.config,(0,E.sprintf)(d.TROUBLESHOOTING_SENT_SUCCESS,JSON.stringify(mt(mt({},n),{},{duration:Date.now()-i}))),d.SEND_TROUBLESHOOTING),!e.key){t.next=12;break}return this._troubleshootingQueue.delete(e.key),t.next=12,this.flushHits([e.key]);case 12:t.next=20;break;case 14:if(t.prev=14,t.t0=t.catch(4),!this.isTroubleshootingActivated()){t.next=19;break}return t.next=19,this.addTroubleshootingHit(e);case 19:(0,E.logError)(this.config,(0,E.errorFormat)(t.t0.message||t.t0,{url:d.TROUBLESHOOTING_HIT_URL,headers:{},body:n,duration:Date.now()-i}),d.SEND_BATCH);case 20:case"end":return t.stop()}}),t,this,[[4,14]])}))),function(t){return u.apply(this,arguments)})},{key:"sendInitTroubleshootingHit",value:(c=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isTroubleshootingActivated()&&this._initTroubleshootingHit&&!this._hasInitTroubleshootingHitSent){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.sendTroubleshootingHit(this._initTroubleshootingHit);case 4:this._hasInitTroubleshootingHitSent=!0;case 5:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"sendTroubleshootingQueue",value:(a=e(s().mark((function t(){var e,n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendInitTroubleshootingHit();case 2:if(this.isTroubleshootingActivated()&&!this._isTroubleshootingQueueSending&&0!==this._troubleshootingQueue.size){t.next=4;break}return t.abrupt("return");case 4:this._isTroubleshootingQueueSending=!0,e=0,n=Array.from(this._troubleshootingQueue);case 6:if(!(e<n.length)){t.next=13;break}return(i=Z(n[e],2))[0],r=i[1],t.next=10,this.sendTroubleshootingHit(r);case 10:e++,t.next=6;break;case 13:this._isTroubleshootingQueueSending=!1;case 14:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"addUsageHit",value:(o=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.key||(n="".concat(e.visitorId,":").concat((0,E.uuidV4)()),e.key=n),this._usageHitQueue.set(e.key,e),(0,E.logDebug)(this.config,(0,E.sprintf)(d.ANALYTICS_HIT_ADDED_IN_QUEUE,JSON.stringify(e.toApiKeys())),d.ADD_USAGE_HIT);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"sendUsageHit",value:(i=e(s().mark((function t(e){var n,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.toApiKeys(),i=Date.now(),t.prev=2,t.next=5,this._httpClient.postAsync(d.USAGE_HIT_URL,{body:n});case 5:if((0,E.logDebug)(this.config,(0,E.sprintf)(d.ANALYTICS_HIT_SENT_SUCCESS,JSON.stringify(mt(mt({},n),{},{duration:Date.now()-i}))),d.SEND_USAGE_HIT),!e.key){t.next=10;break}return this._usageHitQueue.delete(e.key),t.next=10,this.flushHits([e.key]);case 10:t.next=17;break;case 12:return t.prev=12,t.t0=t.catch(2),t.next=16,this.addUsageHit(e);case 16:(0,E.logError)(this.config,(0,E.errorFormat)(t.t0.message||t.t0,{url:d.USAGE_HIT_URL,headers:{},body:n,duration:Date.now()-i}),d.SEND_BATCH);case 17:case"end":return t.stop()}}),t,this,[[2,12]])}))),function(t){return i.apply(this,arguments)})},{key:"sendUsageHitQueue",value:(t=e(s().mark((function t(){var e,n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isUsageHitQueueSending&&0!==this._usageHitQueue.size){t.next=2;break}return t.abrupt("return");case 2:this._isUsageHitQueueSending=!0,e=0,n=Array.from(this._usageHitQueue);case 4:if(!(e<n.length)){t.next=11;break}return i=Z(n[e],2),r=i[1],t.next=8,this.sendUsageHit(r);case 8:e++,t.next=4;break;case 11:this._isUsageHitQueueSending=!1;case 12:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t,i,o,a,c,u,l,f,h,g,p,v,T,A,S}();function bt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(bt=function(){return!!t})()}var Rt=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,bt()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"addHitInPoolQueue",value:(a=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._hitsPoolQueue.set(e.key,e),t.next=3,this.cacheHit(new Map([[e.key,e]]));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"sendActivateHitBatch",value:(o=e(s().mark((function t(e,n,i){var r,o,a,c,u,l,f=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.HEADER_X_API_KEY,this.config.apiKey),d.HEADER_X_SDK_CLIENT,d.SDK_INFO.name),d.HEADER_X_SDK_VERSION,d.SDK_INFO.version),d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),i&&e.hits.push(i),o=e.toApiKeys(),a=d.BASE_API_URL+d.URL_ACTIVATE_MODIFICATION,c=Date.now(),t.prev=5,t.next=8,this._httpClient.postAsync(a,{headers:r,body:o,timeout:this.config.timeout,nextFetchConfig:this.config.nextFetchConfig});case 8:if((0,E.logDebugSprintf)(this.config,d.TRACKING_MANAGER,d.HIT_SENT_SUCCESS,d.ACTIVATE_HIT,{httpRequestBody:o,httpRequestHeaders:r,httpRequestMethod:"POST",httpRequestUrl:a,duration:Date.now()-c,batchTriggeredBy:F[n]}),u=e.hits.filter((function(t){return t.key!==(null==i?void 0:i.key)})).map((function(t){return t.key})),e.hits.forEach((function(t){f.onVisitorExposed(t)})),!u.length){t.next=14;break}return t.next=14,this.flushHits(u);case 14:this.sendHitsToFsQa(e.hits),t.next=26;break;case 17:if(t.prev=17,t.t0=t.catch(5),e.hits.forEach((function(t){f._activatePoolQueue.set(t.key,t)})),!i){t.next=23;break}return t.next=23,this.cacheHit(new Map([[i.key,i]]));case 23:(0,E.logErrorSprintf)(this.config,d.TRACKING_MANAGER,d.TRACKING_MANAGER_ERROR,d.ACTIVATE_HIT,{httpRequestBody:o,httpRequestHeaders:r,httpRequestMethod:"POST",httpRequestUrl:a,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,duration:Date.now()-c,batchTriggeredBy:F[n]}),l=new q({label:P.SEND_ACTIVATE_HIT_ROUTE_ERROR,logLevel:y.LogLevel.ERROR,visitorId:"".concat(this._flagshipInstanceId),traffic:0,config:this.config,httpRequestBody:o,httpRequestHeaders:r,httpRequestMethod:"POST",httpRequestUrl:a,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,httpResponseTime:Date.now()-c,batchTriggeredBy:n}),this.sendTroubleshootingHit(l);case 26:case"end":return t.stop()}}),t,this,[[5,17]])}))),function(t,e,n){return o.apply(this,arguments)})},{key:"sendActivate",value:(r=e(s().mark((function t(e){var n,i,r,o,a,c,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.activateHitsPool,i=e.currentActivate,r=e.batchTriggeredBy,(o=Array.from(n.filter((function(t){return Date.now()-t.createdAt<d.DEFAULT_HIT_CACHE_TIME_MS})))).length||!i){t.next=7;break}return a=new dt([],this.config),t.next=6,this.sendActivateHitBatch(a,r,i);case 6:return t.abrupt("return");case 7:for(c=0;c<o.length;c+=d.MAX_ACTIVATE_HIT_PER_BATCH)u=new dt(o.slice(c,c+d.MAX_ACTIVATE_HIT_PER_BATCH),this.config),this.sendActivateHitBatch(u,r,0===c?i:void 0);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r,o,a}(kt);function Nt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Dt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function wt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(wt=function(){return!!t})()}var xt=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,wt()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"addHitInPoolQueue",value:(a=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._hitsPoolQueue.set(e.key,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"sendActivate",value:(o=e(s().mark((function t(e){var n,i,r,o,a,c,u,l,f,h=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.activateHitsPool,i=e.currentActivate,r=e.batchTriggeredBy,o=(0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.HEADER_X_API_KEY,this.config.apiKey),d.HEADER_X_SDK_CLIENT,d.SDK_INFO.name),d.HEADER_X_SDK_VERSION,d.SDK_INFO.version),d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),a=new dt(Array.from(n.filter((function(t){return Date.now()-t.createdAt<d.DEFAULT_HIT_CACHE_TIME_MS}))),this.config),i&&a.hits.push(i),c=a.toApiKeys(),u=d.BASE_API_URL+d.URL_ACTIVATE_MODIFICATION,l=Date.now(),t.prev=7,t.next=10,this._httpClient.postAsync(u,{headers:o,body:c,timeout:this.config.timeout,nextFetchConfig:this.config.nextFetchConfig});case 10:(0,E.logDebugSprintf)(this.config,d.TRACKING_MANAGER,d.HIT_SENT_SUCCESS,d.ACTIVATE_HIT,{httpRequestBody:c,httpRequestHeaders:o,httpRequestMethod:"POST",httpRequestUrl:u,duration:Date.now()-l,batchTriggeredBy:F[r]}),a.hits.forEach((function(t){h.onVisitorExposed(t)})),this.sendHitsToFsQa(a.hits),t.next=21;break;case 15:t.prev=15,t.t0=t.catch(7),a.hits.forEach((function(t){h._activatePoolQueue.set(t.key,t)})),(0,E.logErrorSprintf)(this.config,d.TRACKING_MANAGER,d.TRACKING_MANAGER_ERROR,d.ACTIVATE_HIT,{httpRequestBody:c,httpRequestHeaders:o,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,duration:Date.now()-l,batchTriggeredBy:F[r]}),f=new q({label:P.SEND_ACTIVATE_HIT_ROUTE_ERROR,logLevel:y.LogLevel.ERROR,visitorId:"".concat(this._flagshipInstanceId),traffic:0,config:this.config,httpRequestBody:c,httpRequestHeaders:o,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,httpResponseTime:Date.now()-l,batchTriggeredBy:r}),this.sendTroubleshootingHit(f);case 21:case"end":return t.stop()}}),t,this,[[7,15]])}))),function(t){return o.apply(this,arguments)})},{key:"sendBatch",value:(r=e(s().mark((function t(){var e,n,i,r,o,a,c,u,l,f,h,g,p,v,I,T=this,A=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=A.length>0&&void 0!==A[0]?A[0]:F.BatchLength,n=!1,!this._activatePoolQueue.size){t.next=8;break}return i=Array.from(this._activatePoolQueue.values()),this._activatePoolQueue.clear(),t.next=7,this.sendActivate({activateHitsPool:i,batchTriggeredBy:e});case 7:n=!0;case 8:r=(0,_.default)({},d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),(o=new At({hits:[]})).config=this.config,a=[],c=Nt(this._hitsPoolQueue),t.prev=14,c.s();case 16:if((u=c.n()).done){t.next=28;break}if(l=Z(u.value,2),f=l[0],h=l[1],!(Date.now()-h.createdAt>=d.DEFAULT_HIT_CACHE_TIME_MS)){t.next=21;break}return a.push(f),t.abrupt("continue",26);case 21:if(!(JSON.stringify(o).length>d.BATCH_MAX_SIZE)){t.next=24;break}return t.abrupt("break",28);case 24:o.hits.push(h),a.push(f);case 26:t.next=16;break;case 28:t.next=33;break;case 30:t.prev=30,t.t0=t.catch(14),c.e(t.t0);case 33:return t.prev=33,c.f(),t.finish(33);case 36:if(a.forEach((function(t){T._hitsPoolQueue.delete(t)})),o.hits.length){t.next=42;break}if(!n){t.next=41;break}return t.next=41,this.cacheHit(this._activatePoolQueue);case 41:return t.abrupt("return");case 42:return g=o.toApiKeys(),p=Date.now(),t.prev=44,t.next=47,this._httpClient.postAsync(d.HIT_EVENT_URL,{headers:r,body:g,timeout:this.config.timeout,nextFetchConfig:this.config.nextFetchConfig});case 47:(0,E.logDebugSprintf)(this.config,d.TRACKING_MANAGER,d.HIT_SENT_SUCCESS,d.BATCH_HIT,{httpRequestBody:g,httpRequestHeaders:r,httpRequestMethod:"POST",httpRequestUrl:d.HIT_EVENT_URL,duration:Date.now()-p,batchTriggeredBy:F[e]}),this.sendHitsToFsQa(o.hits),this.dispatchHitsToTag(o.hits),t.next=58;break;case 52:t.prev=52,t.t1=t.catch(44),o.hits.forEach((function(t){T._hitsPoolQueue.set(t.key,t)})),(0,E.logErrorSprintf)(this.config,d.TRACKING_MANAGER,d.TRACKING_MANAGER_ERROR,d.BATCH_HIT,{httpRequestBody:g,httpRequestHeaders:r,httpRequestMethod:"POST",httpRequestUrl:d.HIT_EVENT_URL,httpResponseBody:null==t.t1?void 0:t.t1.message,httpResponseHeaders:null==t.t1?void 0:t.t1.headers,httpResponseCode:null==t.t1?void 0:t.t1.statusCode,duration:Date.now()-p,batchTriggeredBy:F[e]}),v=new q({label:P.SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR,logLevel:y.LogLevel.ERROR,visitorId:"".concat(this._flagshipInstanceId),traffic:0,config:this.config,httpRequestBody:g,httpRequestHeaders:r,httpResponseBody:null==t.t1?void 0:t.t1.message,httpResponseHeaders:null==t.t1?void 0:t.t1.headers,httpResponseMethod:"POST",httpResponseUrl:d.HIT_EVENT_URL,httpResponseCode:null==t.t1?void 0:t.t1.statusCode,httpResponseTime:Date.now()-p}),this.addTroubleshootingHit(v);case 58:return I=new Map([].concat(gt(this._hitsPoolQueue),gt(this._activatePoolQueue))),t.next=61,this.flushAllHits();case 61:return t.next=63,this.cacheHit(I);case 63:case"end":return t.stop()}}),t,this,[[14,30,33,36],[44,52]])}))),function(){return r.apply(this,arguments)})}]);var r,o,a}(kt);function Pt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Lt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Mt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Mt=function(){return!!t})()}var Ht=function(t){function i(t){var e,n,r,o;return n=this,o=[t],r=u(r=i),(e=c(n,Mt()?Reflect.construct(r,o||[],u(n).constructor):r.apply(n,o))).cacheHitKeys={},e}return f(i,t),(0,n.default)(i,[{key:"activateFlag",value:(h=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(e.visitorId,":").concat((0,E.uuidV4)()),e.key=n,t.next=4,this.sendActivate({activateHitsPool:[],currentActivate:e,batchTriggeredBy:F.ActivateLength});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"addHit",value:(l=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="".concat(e.visitorId,":").concat((0,E.uuidV4)()),e.key=n,e.type!==$.EVENT||e.action!==d.FS_CONSENT||e.label!=="".concat(d.SDK_INFO.name,":false")){t.next=5;break}return t.next=5,this.notConsent(e.visitorId);case 5:return t.next=7,this.sendHit(e);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"addHitInPoolQueue",value:function(t){return Promise.resolve()}},{key:"sendHit",value:(a=e(s().mark((function t(e){var n,i,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,_.default)({},d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),i=e.toApiKeys(),r=Date.now(),t.prev=3,t.next=6,this._httpClient.postAsync(d.HIT_EVENT_URL,{headers:n,body:i,timeout:this.config.timeout,nextFetchConfig:this.config.nextFetchConfig});case 6:(0,E.logDebugSprintf)(this.config,d.TRACKING_MANAGER,d.HIT_SENT_SUCCESS,d.DIRECT_HIT,{httpRequestBody:i,httpRequestHeaders:n,httpRequestMethod:"POST",httpRequestUrl:d.HIT_EVENT_URL,duration:Date.now()-r,batchTriggeredBy:F[F.DirectHit]}),this.sendHitsToFsQa([e]),this.dispatchHitsToTag([e]),t.next=19;break;case 11:return t.prev=11,t.t0=t.catch(3),e.type===$.EVENT&&e.action===d.FS_CONSENT||(this.cacheHitKeys[e.key]=e.visitorId),t.next=16,this.cacheHit((new Map).set(e.key,e));case 16:(0,E.logErrorSprintf)(this.config,d.TRACKING_MANAGER,d.TRACKING_MANAGER_ERROR,d.DIRECT_HIT,{httpRequestBody:i,httpRequestHeaders:n,httpRequestMethod:"POST",httpRequestUrl:d.HIT_EVENT_URL,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,duration:Date.now()-r,batchTriggeredBy:F[F.DirectHit]}),o=new q({label:P.SEND_HIT_ROUTE_ERROR,logLevel:y.LogLevel.ERROR,visitorId:"".concat(this._flagshipInstanceId),traffic:0,config:this.config,httpRequestBody:i,httpRequestHeaders:n,httpRequestMethod:"POST",httpRequestUrl:d.HIT_EVENT_URL,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,httpResponseTime:Date.now()-r,batchTriggeredBy:F.DirectHit}),this.sendTroubleshootingHit(o);case 19:case"end":return t.stop()}}),t,this,[[3,11]])}))),function(t){return a.apply(this,arguments)})},{key:"notConsent",value:(o=e(s().mark((function t(e){var n,i,r,o,a,c,u,l,f,h,g=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object.entries(this.cacheHitKeys).filter((function(t){var n=Z(t,2);return n[0],n[1]===e})),i=[],r=Pt(n);try{for(r.s();!(o=r.n()).done;)a=Z(o.value,1),c=a[0],i.push(c)}catch(t){r.e(t)}finally{r.f()}if(u=Array.from(this._hitsPoolQueue).filter((function(t){var n=Z(t,2),i=(n[0],n[1]);return!((null==i?void 0:i.type)===$.EVENT&&(null==i?void 0:i.action)===d.FS_CONSENT||i.visitorId!==e&&i.anonymousId!==e)})),l=Array.from(this._activatePoolQueue).filter((function(t){var n=Z(t,2),i=(n[0],n[1]);return i.visitorId===e||i.anonymousId===e})),f=[],u.forEach((function(t){var e=Z(t,1)[0];g._hitsPoolQueue.delete(e),f.push(e)})),l.forEach((function(t){var e=Z(t,1)[0];g._activatePoolQueue.delete(e),f.push(e)})),(h=[].concat(i,f)).length){t.next=12;break}return t.abrupt("return");case 12:return t.next=14,this.flushHits(h);case 14:this.cacheHitKeys={};case 15:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"sendActivate",value:(r=e(s().mark((function t(e){var n,i,r,o,a,c,u,l,f,h,g=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.activateHitsPool,i=e.currentActivate,r=e.batchTriggeredBy,o=(0,_.default)((0,_.default)((0,_.default)((0,_.default)({},d.HEADER_X_API_KEY,this.config.apiKey),d.HEADER_X_SDK_CLIENT,d.SDK_INFO.name),d.HEADER_X_SDK_VERSION,d.SDK_INFO.version),d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),a=new dt(Array.from(n.filter((function(t){return Date.now()-t.createdAt<d.DEFAULT_HIT_CACHE_TIME_MS}))),this.config),i&&a.hits.push(i),c=a.toApiKeys(),u=d.BASE_API_URL+d.URL_ACTIVATE_MODIFICATION,l=Date.now(),t.prev=7,t.next=10,this._httpClient.postAsync(u,{headers:o,body:c,timeout:this.config.timeout,nextFetchConfig:this.config.nextFetchConfig});case 10:if((0,E.logDebugSprintf)(this.config,d.TRACKING_MANAGER,d.HIT_SENT_SUCCESS,d.ACTIVATE_HIT,{httpRequestBody:c,httpRequestHeaders:o,httpRequestMethod:"POST",httpRequestUrl:u,duration:Date.now()-l,batchTriggeredBy:F[r]}),f=n.map((function(t){return t.key})),a.hits.forEach((function(t){g.onVisitorExposed(t)})),!f.length){t.next=16;break}return t.next=16,this.flushHits(f);case 16:this.sendHitsToFsQa(a.hits),t.next=28;break;case 19:if(t.prev=19,t.t0=t.catch(7),a.hits.forEach((function(t){g.cacheHitKeys[t.key]=t.visitorId})),!i){t.next=25;break}return t.next=25,this.cacheHit(new Map([[i.key,i]]));case 25:(0,E.logErrorSprintf)(this.config,d.TRACKING_MANAGER,d.TRACKING_MANAGER_ERROR,d.ACTIVATE_HIT,{httpRequestBody:c,httpRequestHeaders:o,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,duration:Date.now()-l,batchTriggeredBy:F[r]}),h=new q({label:P.SEND_ACTIVATE_HIT_ROUTE_ERROR,logLevel:y.LogLevel.ERROR,visitorId:"".concat(this._flagshipInstanceId),traffic:0,config:this.config,httpRequestBody:c,httpRequestHeaders:o,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t.t0?void 0:t.t0.message,httpResponseHeaders:null==t.t0?void 0:t.t0.headers,httpResponseMethod:"POST",httpResponseUrl:u,httpResponseCode:null==t.t0?void 0:t.t0.statusCode,httpResponseTime:Date.now()-l,batchTriggeredBy:r}),this.sendTroubleshootingHit(h);case 28:case"end":return t.stop()}}),t,this,[[7,19]])}))),function(t){return r.apply(this,arguments)})}]);var r,o,a,l,h}(kt);function Ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ft(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ut=function(){return!!t})()}r(761);var Gt=function(t){function e(t){var n,i,r,o;i=this,r=e,o=[{type:$.ITEM,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode,isActionTrackingHit:t.isActionTrackingHit}],r=u(r),n=c(i,Ut()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o));var s=t.transactionId,a=t.productName,l=t.productSku,f=t.itemCategory,h=t.itemPrice,d=t.itemQuantity;return n.transactionId=s,n.productName=a,n.productSku=l,f&&(n.itemCategory=f),h&&(n.itemPrice=h),d&&(n.itemQuantity=d),n}return f(e,t),(0,n.default)(e,[{key:"transactionId",get:function(){return this._transactionId},set:function(t){this.isNotEmptyString(t,"transactionId")&&(this._transactionId=t)}},{key:"productName",get:function(){return this._productName},set:function(t){this.isNotEmptyString(t,"productName")&&(this._productName=t)}},{key:"productSku",get:function(){return this._productSku},set:function(t){this.isNotEmptyString(t,"productSku")&&(this._productSku=t)}},{key:"itemPrice",get:function(){return this._itemPrice},set:function(t){this.isNumeric(t,"itemPrice")&&(this._itemPrice=t)}},{key:"itemQuantity",get:function(){return this._itemQuantity},set:function(t){this.isInteger(t,"itemQuantity")&&(this._itemQuantity=Math.trunc(t))}},{key:"itemCategory",get:function(){return this._itemCategory},set:function(t){this.isNotEmptyString(t,"itemCategory")&&(this._itemCategory=t)}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this)||!this.transactionId||!this.productName||!this.productSku)}},{key:"toApiKeys",value:function(){var e=t.prototype.toApiKeys.call(this);return e[d.TID_API_ITEM]=this.transactionId,e[d.IN_API_ITEM]=this.productName,e[d.IC_API_ITEM]=this.productSku,this.itemPrice&&(e[d.IP_API_ITEM]=this.itemPrice),this.itemQuantity&&(e[d.IQ_API_ITEM]=this.itemQuantity),this.itemCategory&&(e[d.IV_API_ITEM]=this.itemCategory),e}},{key:"toObject",value:function(){return Vt(Vt({},t.prototype.toObject.call(this)),{},{transactionId:this.transactionId,productName:this.productName,productSku:this.productSku,itemPrice:this.itemPrice,itemQuantity:this.itemQuantity,itemCategory:this.itemCategory})}},{key:"getErrorMessage",value:function(){return"Transaction Id, Item name and item code are required"}}])}(H);function jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Bt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jt(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Kt=function(){return!!t})()}var Qt=function(t){function e(t){var n,i,r,o;return i=this,r=e,o=[{type:$.PAGE_VIEW,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode,isActionTrackingHit:t.isActionTrackingHit}],r=u(r),(n=c(i,Kt()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o))).documentLocation=t.documentLocation,n}return f(e,t),(0,n.default)(e,[{key:"documentLocation",get:function(){return this._documentLocation},set:function(t){this.isNotEmptyString(t,"documentLocation")&&(this._documentLocation=t)}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this)||!this.documentLocation)}},{key:"toApiKeys",value:function(){var e=t.prototype.toApiKeys.call(this);return e[d.DL_API_ITEM]=this.documentLocation,e}},{key:"toObject",value:function(){return Bt(Bt({},t.prototype.toObject.call(this)),{},{documentLocation:this.documentLocation})}},{key:"getErrorMessage",value:function(){return"documentLocation url is required"}}])}(H);function qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Wt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Wt=function(){return!!t})()}var zt=function(t){function e(t){var n,i,r,o;i=this,r=e,o=[{type:$.TRANSACTION,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode,isActionTrackingHit:t.isActionTrackingHit}],r=u(r),n=c(i,Wt()?Reflect.construct(r,o||[],u(i).constructor):r.apply(i,o));var s=t.transactionId,a=t.affiliation,l=t.taxes,f=t.currency,h=t.couponCode,d=t.itemCount,g=t.shippingMethod,p=t.paymentMethod,v=t.totalRevenue,I=t.shippingCosts;return n.transactionId=s,n.affiliation=a,l&&(n.taxes=l),f&&(n.currency=f),h&&(n.couponCode=h),d&&(n.itemCount=d),g&&(n.shippingMethod=g),p&&(n.paymentMethod=p),v&&(n.totalRevenue=v),I&&(n.shippingCosts=I),n}return f(e,t),(0,n.default)(e,[{key:"transactionId",get:function(){return this._transactionId},set:function(t){this.isNotEmptyString(t,"transactionId")&&(this._transactionId=t)}},{key:"affiliation",get:function(){return this._affiliation},set:function(t){this.isNotEmptyString(t,"affiliation")&&(this._affiliation=t)}},{key:"taxes",get:function(){return this._taxes},set:function(t){this.isNumeric(t,"taxes")&&(this._taxes=t)}},{key:"currency",get:function(){return this._currency},set:function(t){t&&"string"==typeof t&&3===t.length?this._currency=t:(0,E.logError)(this.config,(0,E.sprintf)("{0} must be a string and have exactly 3 letters","currency"),"currency")}},{key:"couponCode",get:function(){return this._couponCode},set:function(t){this.isNotEmptyString(t,"couponCode")&&(this._couponCode=t)}},{key:"itemCount",get:function(){return this._itemCount},set:function(t){this.isInteger(t,"itemCount")&&(this._itemCount=Math.trunc(t))}},{key:"shippingMethod",get:function(){return this._shippingMethod},set:function(t){this.isNotEmptyString(t,"shippingMethod")&&(this._shippingMethod=t)}},{key:"paymentMethod",get:function(){return this._paymentMethod},set:function(t){this.isNotEmptyString(t,"paymentMethod")&&(this._paymentMethod=t)}},{key:"totalRevenue",get:function(){return this._totalRevenue},set:function(t){this.isNumeric(t,"totalRevenue")&&(this._totalRevenue=t)}},{key:"shippingCosts",get:function(){return this._shippingCosts},set:function(t){this.isNumeric(t,"shippingCosts")&&(this._shippingCosts=t)}},{key:"isReady",value:function(){return!((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&!t.prototype.isReady.call(this)||!this.transactionId||!this.affiliation)}},{key:"toApiKeys",value:function(){var e=t.prototype.toApiKeys.call(this);return e[d.TID_API_ITEM]=this.transactionId,e[d.TA_API_ITEM]=this.affiliation,this.taxes&&(e[d.TT_API_ITEM]=this.taxes),this.currency&&(e[d.TC_API_ITEM]=this.currency),this.couponCode&&(e[d.TCC_API_ITEM]=this.couponCode),this.itemCount&&(e[d.ICN_API_ITEM]=this.itemCount),this.shippingMethod&&(e[d.SM_API_ITEM]=this.shippingMethod),this.paymentMethod&&(e[d.PM_API_ITEM]=this.paymentMethod),this.totalRevenue&&(e[d.TR_API_ITEM]=this.totalRevenue),this.shippingCosts&&(e[d.TS_API_ITEM]=this.shippingCosts),e}},{key:"toObject",value:function(){return Yt(Yt({},t.prototype.toObject.call(this)),{},{transactionId:this.transactionId,affiliation:this.affiliation,taxes:this.taxes,currency:this.currency,couponCode:this.couponCode,itemCount:this.itemCount,shippingMethod:this.shippingMethod,paymentMethod:this.paymentMethod,totalRevenue:this.totalRevenue,shippingCosts:this.shippingCosts})}},{key:"getErrorMessage",value:function(){return"Transaction Id and Transaction affiliation are required"}}])}(H);function Xt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Xt=function(){return!!t})()}var Jt=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,Xt()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"activateFlag",value:(a=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.strategy.activateFlag(e);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"addHit",value:(o=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.strategy.addHit(e);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"sendBatch",value:(r=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.strategy.sendBatch(F.Flush);case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}]);var r,o,a}(function(){return(0,n.default)((function(t,e,n,i){(0,_.default)(this,"_isPooling",!1),this._flagshipInstanceId=n,this._hitsPoolQueue=new Map,this._activatePoolQueue=new Map,this._troubleshootingQueue=new Map,this._analyticHitQueue=new Map,this._httpClient=t,this._config=e,this._sharedActionTracking=i,this.strategy=this.initStrategy(),this.lookupHits()}),[{key:"initTroubleshootingHit",get:function(){return this._initTroubleshootingHit},set:function(t){this._initTroubleshootingHit=t,this.strategy.initTroubleshootingHit=t}},{key:"flagshipInstanceId",get:function(){return this._flagshipInstanceId}},{key:"troubleshootingData",get:function(){return this.strategy.troubleshootingData},set:function(t){this.strategy.troubleshootingData=t}},{key:"initStrategy",value:function(){var t,e,n={config:this.config,httpClient:this.httpClient,hitsPoolQueue:this._hitsPoolQueue,activatePoolQueue:this._activatePoolQueue,troubleshootingQueue:this._troubleshootingQueue,analyticHitQueue:this._analyticHitQueue,flagshipInstanceId:this.flagshipInstanceId,initTroubleshootingHit:this.initTroubleshootingHit,sharedActionTracking:this._sharedActionTracking};switch(null==(t=this.config.trackingManagerConfig)?void 0:t.cacheStrategy){case T.PERIODIC_CACHING:e=new xt(n);break;case T.CONTINUOUS_CACHING:e=new Rt(n);break;default:e=new Ht(n)}return e}},{key:"httpClient",get:function(){return this._httpClient}},{key:"config",get:function(){return this._config}},{key:"sendTroubleshootingHit",value:(u=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.strategy.sendTroubleshootingHit(e);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"startBatchingLoop",value:function(){var t,e=this,n=null==(t=this.config.trackingManagerConfig)?void 0:t.batchIntervals;if(0!==n){var i=1e3*n;(0,E.logInfoSprintf)(this.config,d.TRACKING_MANAGER,d.BATCH_LOOP_STARTED,i),this._intervalID=setInterval((function(){e.batchingLoop()}),i)}}},{key:"stopBatchingLoop",value:function(){clearInterval(this._intervalID),this._isPooling=!1,(0,E.logInfo)(this.config,d.BATCH_LOOP_STOPPED,d.TRACKING_MANAGER)}},{key:"batchingLoop",value:(c=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isPooling){t.next=2;break}return t.abrupt("return");case 2:return this._isPooling=!0,t.next=5,this.strategy.sendBatch(F.Timer);case 5:return t.next=7,this.strategy.sendTroubleshootingQueue();case 7:return t.next=9,this.strategy.sendUsageHitQueue();case 9:this._isPooling=!1;case 10:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"checkLookupHitData",value:function(t){var e,n;return!(1!==(null==t?void 0:t.version)||null==t||null==(e=t.data)||!e.type||null==t||null==(n=t.data)||!n.content)||((0,E.logError)(this.config,"JSON DATA must fit the type HitCacheDTO",d.PROCESS_LOOKUP_HIT),!1)}},{key:"extractHitData",value:(a=e(s().mark((function t(e,n){var i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.data.type,t.next=t.t0===$.EVENT?3:t.t0===$.ITEM?5:t.t0===$.PAGE?7:t.t0===$.SCREEN?9:"SEGMENT"===t.t0?11:t.t0===$.TRANSACTION?13:15;break;case 3:return i=new ct(n.data.content),t.abrupt("break",15);case 5:return i=new Gt(n.data.content),t.abrupt("break",15);case 7:return i=new Qt(n.data.content),t.abrupt("break",15);case 9:return i=new ht(n.data.content),t.abrupt("break",15);case 11:return i=new it(n.data.content),t.abrupt("break",15);case 13:return i=new zt(n.data.content),t.abrupt("break",15);case 15:return t.abrupt("return",i);case 16:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)})},{key:"processCachedHits",value:(o=e(s().mark((function t(e){var n,i,r,o,a,c,u,l,f,h;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=function(t){return Date.now()-t<=d.DEFAULT_HIT_CACHE_TIME_MS},i=[],r=Object.entries(e),o=0,a=r;case 4:if(!(o<a.length)){t.next=29;break}if(c=Z(a[o],2),u=c[0],l=c[1],this.checkLookupHitData(l)&&n(l.data.time)){t.next=9;break}return i.push(u),t.abrupt("continue",26);case 9:if("ACTIVATE"!==l.data.type){t.next=16;break}return(f=new _t(l.data.content)).key=u,f.createdAt=l.data.content.createdAt,f.config=this.config,this._activatePoolQueue.set(u,f),t.abrupt("continue",26);case 16:return t.next=18,this.extractHitData(u,l);case 18:if(h=t.sent){t.next=22;break}return i.push(u),t.abrupt("continue",26);case 22:h.key=u,h.createdAt=l.data.content.createdAt,h.config=this.config,this._hitsPoolQueue.set(u,h);case 26:o++,t.next=4;break;case 29:if(!i.length){t.next=32;break}return t.next=32,this.strategy.flushHits(i);case 32:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"lookupHits",value:(r=e(s().mark((function t(){var e,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.config.hitCacheImplementation,!this.config.disableCache&&e&&"function"==typeof e.lookupHits){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e.lookupHits();case 6:if(n=t.sent,(0,E.logDebugSprintf)(this.config,d.PROCESS_CACHE,d.HIT_CACHE_LOADED,n),n&&Object.keys(n).length){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,this.processCachedHits(n);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.HIT_CACHE_ERROR,"lookupHits",t.t0.message||t.t0);case 17:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(){return r.apply(this,arguments)})},{key:"sendUsageHit",value:(i=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.strategy.sendUsageHit(e);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"addTroubleshootingHit",value:(t=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.strategy.addTroubleshootingHit(e);case 2:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})}]);var t,i,r,o,a,c,u}()),Zt=function(){return(0,n.default)((function(){var t,e,n;this.consoleError=null!=(t=console.error)?t:console.log,this.consoleWarn=null!=(e=console.warn)?e:console.log,this.consoleDebug=null!=(n=console.debug)?n:console.log}),[{key:"emergency",value:function(t,e){this.consoleError((0,E.formatLogOutput)(y.LogLevel.EMERGENCY,t,e))}},{key:"alert",value:function(t,e){this.consoleError((0,E.formatLogOutput)(y.LogLevel.ALERT,t,e))}},{key:"critical",value:function(t,e){this.consoleError((0,E.formatLogOutput)(y.LogLevel.CRITICAL,t,e))}},{key:"error",value:function(t,e){this.consoleError((0,E.formatLogOutput)(y.LogLevel.ERROR,t,e))}},{key:"warning",value:function(t,e){this.consoleWarn((0,E.formatLogOutput)(y.LogLevel.WARNING,t,e))}},{key:"notice",value:function(t,e){this.log(y.LogLevel.NOTICE,t,e)}},{key:"info",value:function(t,e){console.info((0,E.formatLogOutput)(y.LogLevel.INFO,t,e))}},{key:"debug",value:function(t,e){this.consoleDebug((0,E.formatLogOutput)(y.LogLevel.DEBUG,t,e))}},{key:"log",value:function(t,e,n){console.log((0,E.formatLogOutput)(t,e,n))}}])}();function $t(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ee(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?te(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ne(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ne=function(){return!!t})()}r(9479);var ie=function(t){function e(t){return n=this,i=e,r=[ee(ee({},t),{},{type:"USAGE"})],i=u(i),c(n,ne()?Reflect.construct(i,r||[],u(n).constructor):i.apply(n,r));var n,i,r}return f(e,t),(0,n.default)(e)}(j);function re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?re(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var se="FS_DEFAULT_HIT_CACHE",ae=function(){return(0,n.default)((function(){}),[{key:"cacheHit",value:function(t){var e=localStorage.getItem(se)||"{}",n=oe(oe({},JSON.parse(e)),t);return localStorage.setItem(se,JSON.stringify(n)),Promise.resolve()}},{key:"lookupHits",value:function(){var t=localStorage.getItem(se)||"{}",e=JSON.parse(t);return Promise.resolve(e)}},{key:"flushHits",value:function(t){var e=localStorage.getItem(se)||"{}",n=JSON.parse(e);return t.forEach((function(t){delete n[t]})),localStorage.setItem(se,JSON.stringify(n)),Promise.resolve()}},{key:"flushAllHits",value:function(){return localStorage.removeItem(se),Promise.resolve()}}])}(),ce="FS_VISITOR_CACHE_",ue=function(){return(0,n.default)((function(){}),[{key:"cacheVisitor",value:function(t,e){return localStorage.setItem(ce+t,JSON.stringify(e)),Promise.resolve()}},{key:"lookupVisitor",value:function(t){var e=localStorage.getItem(ce+t);return Promise.resolve(e?JSON.parse(e):null)}},{key:"flushVisitor",value:function(t){return localStorage.removeItem(ce+t),Promise.resolve()}}])}();function le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?le(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var he,de="Visitor ID mismatch: {0} vs {1}",ge=function(){return(0,n.default)((function(t){var e=t.visitor,n=t.murmurHash;this.visitor=e,this._murmurHash=n}),[{key:"configManager",get:function(){return this.visitor.configManager}},{key:"trackingManager",get:function(){return this.configManager.trackingManager}},{key:"decisionManager",get:function(){return this.configManager.decisionManager}},{key:"config",get:function(){return this.visitor.config}},{key:"collectEAIEventsAsync",value:function(t){return this.visitor.emotionAi.collectEAIEventsAsync(t)}},{key:"reportEaiVisitorEvent",value:function(t){var e=this;Promise.resolve().then(r.bind(r,7188)).then((function(n){var i=n.VisitorEvent;e.visitor.emotionAi.reportVisitorEvent(new i(t))}))}},{key:"reportEaiPageView",value:function(t){var e=this;Promise.resolve().then(r.bind(r,3988)).then((function(n){var i=n.PageView;e.visitor.emotionAi.reportPageView(new i(t))}))}},{key:"onEAICollectStatusChange",value:function(t){this.visitor.emotionAi.onEAICollectStatusChange(t)}},{key:"cleanup",value:function(){this.visitor.emotionAi.cleanup()}},{key:"updateCampaigns",value:function(t){try{this.visitor.campaigns=t,this.visitor.flagsData=this.decisionManager.getModifications(t)}catch(t){(0,E.logError)(this.config,t.message||t,"updateCampaigns")}}},{key:"hasTrackingManager",value:function(t){var e=this.trackingManager;return e||(0,E.logError)(this.config,(0,E.sprintf)(d.TRACKER_MANAGER_MISSING_ERROR),t),!!e}},{key:"setConsent",value:function(t){var e;if(this.visitor.hasConsented=t,t||this.flushVisitor(),this.hasTrackingManager("setConsent")){var n=new ct({visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,label:"".concat(d.SDK_INFO.name,":").concat(this.visitor.hasConsented),action:d.FS_CONSENT,category:rt.USER_ENGAGEMENT});n.qaMode=this.config.isQAModeEnabled,n.ds=d.SDK_APP,n.config=this.config,this.trackingManager.addHit(n);var i=new q({label:P.VISITOR_SEND_HIT,logLevel:y.LogLevel.INFO,traffic:this.visitor.traffic||0,visitorId:this.visitor.visitorId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(e=this.visitor.sdkInitialData)?void 0:e.instanceId,anonymousId:this.visitor.anonymousId,config:this.config,hitContent:n.toApiKeys()});this.decisionManager.troubleshooting?this.trackingManager.sendTroubleshootingHit(i):(this.visitor.consentHitTroubleshooting=i,(0,E.logDebugSprintf)(this.config,d.PROCESS_SET_CONSENT,d.CONSENT_CHANGED,this.visitor.visitorId,t))}}},{key:"checKLookupVisitorDataV1",value:function(t){if(!t||!t.data||!t.data.visitorId)return!1;var e=t.data.campaigns;return!e||!!Array.isArray(e)&&(this.visitor.visitorCacheStatus!==L.VISITOR_ID_CACHE&&this.visitor.visitorCacheStatus!==L.VISITOR_ID_CACHE_WITH_ANONYMOUS_ID_CACHE||t.data.visitorId===this.visitor.visitorId?this.visitor.visitorCacheStatus===L.ANONYMOUS_ID_CACHE&&t.data.visitorId!==this.visitor.anonymousId?((0,E.logInfoSprintf)(this.config,d.PROCESS_CACHE,de,t.data.visitorId,this.visitor.anonymousId),!1):e.every((function(t){return t.campaignId&&t.type&&t.variationGroupId&&t.variationId})):((0,E.logInfoSprintf)(this.config,d.PROCESS_CACHE,de,t.data.visitorId,this.visitor.visitorId),!1))}},{key:"checKLookupVisitorData",value:function(t){return 1===t.version&&this.checKLookupVisitorDataV1(t)}},{key:"tryLookupCache",value:(h=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.config.visitorCacheImplementation)&&"function"==typeof n.lookupVisitor){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,n.lookupVisitor(e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"processValidCache",value:function(t){return this.checKLookupVisitorData(t)?(this.visitor.visitorCache=t,!0):((0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.LOOKUP_VISITOR_JSON_OBJECT_ERROR,d.VISITOR_CACHE_VERSION,this.visitor.visitorId),!1)}},{key:"lookupVisitor",value:(f=e(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.config.disableCache&&!this.visitor.visitorCache){t.next=3;break}return t.abrupt("return");case 3:return this.visitor.visitorCacheStatus=L.NONE,t.next=6,this.tryLookupCache(this.visitor.visitorId);case 6:if(!(e=t.sent)){t.next=11;break}this.visitor.visitorCacheStatus=L.VISITOR_ID_CACHE,t.next=16;break;case 11:if(!this.visitor.anonymousId){t.next=16;break}return t.next=14,this.tryLookupCache(this.visitor.anonymousId);case 14:(e=t.sent)&&(this.visitor.visitorCacheStatus=L.ANONYMOUS_ID_CACHE);case 16:if((0,E.logDebugSprintf)(this.config,d.PROCESS_CACHE,d.VISITOR_CACHE_LOADED,this.visitor.visitorId,e),e&&this.processValidCache(e)){t.next=19;break}return t.abrupt("return");case 19:if(this.visitor.visitorCacheStatus!==L.VISITOR_ID_CACHE||!this.visitor.anonymousId){t.next=24;break}return t.next=22,this.tryLookupCache(this.visitor.anonymousId);case 22:t.sent&&(this.visitor.visitorCacheStatus=L.VISITOR_ID_CACHE_WITH_ANONYMOUS_ID_CACHE);case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(0),(0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.VISITOR_CACHE_ERROR,this.visitor.visitorId,"lookupVisitor",t.t0.message||t.t0);case 29:case"end":return t.stop()}}),t,this,[[0,26]])}))),function(){return f.apply(this,arguments)})},{key:"createVisitorCacheDTO",value:function(t,e){var n,i,r,o={},s={version:d.VISITOR_CACHE_VERSION,data:{visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,consent:this.visitor.hasConsented,context:this.visitor.context,eAIScore:(null==(n=this.visitor.visitorCache)||null==(n=n.data)?void 0:n.eAIScore)||t,isEAIDataCollected:(null==(i=this.visitor.visitorCache)||null==(i=i.data)?void 0:i.isEAIDataCollected)||e,campaigns:this.visitor.campaigns.map((function(t){return o[t.variationGroupId]=t.variation.id,{campaignId:t.id,slug:t.slug,variationGroupId:t.variationGroupId,variationId:t.variation.id,isReference:t.variation.reference,type:t.variation.modifications.type,activated:!1,flags:t.variation.modifications.value}}))}};return s.data.assignmentsHistory=fe(fe({},null==(r=this.visitor.visitorCache)||null==(r=r.data)?void 0:r.assignmentsHistory),o),s}},{key:"cacheAnonymousVisitor",value:(l=e(s().mark((function t(e,n){var i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.visitor.visitorCacheStatus,!this.visitor.anonymousId||i!==L.NONE&&i!==L.VISITOR_ID_CACHE){t.next=5;break}return r=fe(fe({},n),{},{data:fe(fe({},n.data),{},{visitorId:this.visitor.anonymousId,anonymousId:null})}),t.next=5,e.cacheVisitor(this.visitor.anonymousId,r);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"cacheVisitor",value:(u=e(s().mark((function t(e,n){var i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=this.config.visitorCacheImplementation,!this.config.disableCache&&i&&"function"==typeof i.cacheVisitor){t.next=4;break}return t.abrupt("return");case 4:return r=this.createVisitorCacheDTO(e,n),t.next=7,i.cacheVisitor(this.visitor.visitorId,r);case 7:return t.next=9,this.cacheAnonymousVisitor(i,r);case 9:(0,E.logDebugSprintf)(this.config,d.PROCESS_CACHE,d.VISITOR_CACHE_SAVED,this.visitor.visitorId,r),this.visitor.visitorCache=r,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.VISITOR_CACHE_ERROR,this.visitor.visitorId,"cacheVisitor",t.t0.message||t.t0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(t,e){return u.apply(this,arguments)})},{key:"flushVisitor",value:(c=e(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.config.visitorCacheImplementation,!this.config.disableCache&&e&&"function"==typeof e.flushVisitor){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e.flushVisitor(this.visitor.visitorId);case 6:(0,E.logDebugSprintf)(this.config,d.PROCESS_CACHE,d.VISITOR_CACHE_FLUSHED,this.visitor.visitorId),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,E.logErrorSprintf)(this.config,d.PROCESS_CACHE,d.VISITOR_CACHE_ERROR,this.visitor.visitorId,"flushVisitor",t.t0.message||t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return c.apply(this,arguments)})},{key:"addInTrackingManager",value:function(t){return this.trackingManager.addHit(t)}},{key:"sendTroubleshootingHit",value:(a=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.trackingManager.sendTroubleshootingHit(e);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"sendUsageHit",value:(o=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.config.disableDeveloperUsageTracking){t.next=2;break}return t.abrupt("return");case 2:if(!(this.visitor.analyticTraffic>d.ANALYTIC_HIT_ALLOCATION)){t.next=5;break}return t.abrupt("return");case 5:return t.abrupt("return",this.trackingManager.sendUsageHit(e));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"getCurrentDateTime",value:function(){return new Date}},{key:"getSdkConfigDecisionMode",value:function(){return this.config.decisionMode===I.DECISION_API?"DECISION_API":this.config.decisionMode}},{key:"sendSdkConfigAnalyticHit",value:(i=e(s().mark((function t(){var e,n,i,r,o,a,c,u,l,f,h;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.config.disableDeveloperUsageTracking){t.next=2;break}return t.abrupt("return");case 2:c=this.config.hitCacheImplementation,u=this.config.visitorCacheImplementation,!1,!1,l=!(!c||c instanceof ae),f=!(!u||u instanceof ue),h=new ie({label:P.SDK_CONFIG,logLevel:y.LogLevel.INFO,visitorId:null==(e=this.visitor.sdkInitialData)?void 0:e.instanceId,flagshipInstanceId:null==(n=this.visitor.sdkInitialData)?void 0:n.instanceId,config:this.config,sdkStatus:this.visitor.getSdkStatus(),lastBucketingTimestamp:this.configManager.decisionManager.lastBucketingTimestamp,lastInitializationTimestamp:null==(i=this.visitor.sdkInitialData)?void 0:i.lastInitializationTimestamp,sdkConfigMode:this.getSdkConfigDecisionMode(),sdkConfigLogLevel:this.config.logLevel,sdkConfigTimeout:this.config.timeout,sdkConfigPollingInterval:this.config.pollingInterval,sdkConfigTrackingManagerStrategy:null==(r=this.config.trackingManagerConfig)?void 0:r.cacheStrategy,sdkConfigTrackingManagerBatchIntervals:null==(o=this.config.trackingManagerConfig)?void 0:o.batchIntervals,sdkConfigTrackingManagerPoolMaxSize:null==(a=this.config.trackingManagerConfig)?void 0:a.poolMaxSize,sdkConfigFetchNow:this.config.fetchNow,sdkConfigReuseVisitorIds:this.config.reuseVisitorIds,sdkConfigInitialBucketing:this.config.initialBucketing,sdkConfigDecisionApiUrl:this.config.decisionApiUrl,sdkConfigHitDeduplicationTime:this.config.hitDeduplicationTime,sdkConfigUsingOnVisitorExposed:!!this.config.onVisitorExposed,sdkConfigUsingCustomHitCache:!!l,sdkConfigUsingCustomVisitorCache:!!f,sdkConfigFetchThirdPartyData:this.config.fetchThirdPartyData,sdkConfigFetchFlagsBufferingTime:this.config.fetchFlagsBufferingTime,sdkConfigDisableDeveloperUsageTracking:this.config.disableDeveloperUsageTracking,sdkConfigNextFetchConfig:this.config.nextFetchConfig,sdkConfigDisableCache:this.config.disableCache}),this.sendUsageHit(h);case 9:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"sendFetchFlagsTroubleshooting",value:(t=e(s().mark((function t(e){var n,i,r,o,a,c,u,l,f,h,d,g,p,v,I,_,E,T,A,S;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=e.isFromCache,h=e.campaigns,d=e.now,g={},this.visitor.flagsData.forEach((function(t){g[t.variationGroupId]=t.variationId})),p=this.visitor.visitorId+(null==(n=this.decisionManager.troubleshooting)?void 0:n.endDate.toUTCString()),v=this._murmurHash.murmurHash3Int32(p),I=v%100,this.visitor.traffic=I,_=this.config.hitCacheImplementation,E=this.config.visitorCacheImplementation,!1,!1,T=!(!_||_ instanceof ae),A=!(!E||E instanceof ue),S=new q({label:P.VISITOR_FETCH_CAMPAIGNS,logLevel:y.LogLevel.INFO,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(i=this.visitor.sdkInitialData)?void 0:i.instanceId,traffic:I,config:this.config,sdkStatus:this.visitor.getSdkStatus(),visitorContext:this.visitor.context,visitorCampaigns:h,visitorCampaignFromCache:f?h:void 0,visitorConsent:this.visitor.hasConsented,visitorIsAuthenticated:!!this.visitor.anonymousId,visitorFlags:this.visitor.flagsData,visitorAssignmentHistory:g,visitorInitialCampaigns:null==(r=this.visitor.sdkInitialData)?void 0:r.initialCampaigns,visitorInitialFlagsData:null==(o=this.visitor.sdkInitialData)?void 0:o.initialFlagsData,lastBucketingTimestamp:this.configManager.decisionManager.lastBucketingTimestamp,lastInitializationTimestamp:null==(a=this.visitor.sdkInitialData)?void 0:a.lastInitializationTimestamp,httpResponseTime:Date.now()-d,sdkConfigLogLevel:this.config.logLevel,sdkConfigMode:this.getSdkConfigDecisionMode(),sdkConfigTimeout:this.config.timeout,sdkConfigPollingInterval:this.config.pollingInterval,sdkConfigTrackingManagerStrategy:null==(c=this.config.trackingManagerConfig)?void 0:c.cacheStrategy,sdkConfigTrackingManagerBatchIntervals:null==(u=this.config.trackingManagerConfig)?void 0:u.batchIntervals,sdkConfigTrackingManagerPoolMaxSize:null==(l=this.config.trackingManagerConfig)?void 0:l.poolMaxSize,sdkConfigFetchNow:this.config.fetchNow,sdkConfigReuseVisitorIds:this.config.reuseVisitorIds,sdkConfigInitialBucketing:this.config.initialBucketing,sdkConfigDecisionApiUrl:this.config.decisionApiUrl,sdkConfigHitDeduplicationTime:this.config.hitDeduplicationTime,sdkConfigUsingOnVisitorExposed:!!this.config.onVisitorExposed,sdkConfigUsingCustomHitCache:!!T,sdkConfigUsingCustomVisitorCache:!!A,sdkConfigFetchThirdPartyData:this.config.fetchThirdPartyData,sdkConfigFetchFlagsBufferingTime:this.config.fetchFlagsBufferingTime,sdkConfigDisableDeveloperUsageTracking:this.config.disableDeveloperUsageTracking,sdkConfigNextFetchConfig:this.config.nextFetchConfig,sdkConfigDisableCache:this.config.disableCache}),t.next=15,this.sendTroubleshootingHit(S);case 15:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})},{key:"sendConsentHitTroubleshooting",value:function(){var t=this.visitor.consentHitTroubleshooting;t&&(t.traffic=this.visitor.traffic,this.trackingManager.sendTroubleshootingHit(t),this.visitor.consentHitTroubleshooting=void 0)}},{key:"sendSegmentHitTroubleshooting",value:function(){var t=this.visitor.segmentHitTroubleshooting;t&&(t.traffic=this.visitor.traffic,this.trackingManager.sendTroubleshootingHit(t),this.visitor.segmentHitTroubleshooting=void 0)}}]);var t,i,o,a,c,u,l,f,h}(),pe="sdk_deviceLanguage",ve="sdk_deviceType",Ie="sdk_deviceModel",_e="sdk_city",ye="sdk_region",Ee="sdk_country",Te="sdk_lat",Ae="sdk_long",Se="sdk_ip",me="sdk_osName",Ce="sdk_osVersionName",Oe="sdk_osVersionCode",ke="sdk_carrierName",be="sdk_internetConnection",Re="sdk_versionName",Ne="sdk_versionCode",De="sdk_interfaceName",we="fs_client",xe="fs_version",Pe="fs_users",Le=(he={},(0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)(he,pe,"string"),ve,"string"),Ie,"string"),_e,"string"),ye,"string"),Ee,"string"),Te,"number"),Ae,"number"),Se,"string"),me,"string"),(0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)((0,_.default)(he,Ce,"string"),Oe,"string"),ke,"string"),be,"string"),Re,"string"),Ne,"string"),De,"string"),we,"string"),xe,"string"),Pe,"string")),Me=function(){function t(t){var e=t.campaignId,n=t.variationGroupId,i=t.variationId,r=t.isReference,o=t.campaignType,s=t.slug,a=t.variationGroupName,c=t.variationName,u=t.campaignName;this.campaignId=e,this.variationGroupId=n,this.variationId=i,this.isReference=r,this.campaignType=o,this.campaignName=u,this.variationGroupName=a,this.variationName=c,this.slug=s}return(0,n.default)(t,null,[{key:"Empty",value:function(){return new t({campaignId:"",campaignName:"",campaignType:"",variationId:"",variationName:"",variationGroupId:"",variationGroupName:"",isReference:!1,slug:null})}}])}(),He=function(t){return t.FETCHED="FETCHED",t.FETCHING="FETCHING",t.FETCH_REQUIRED="FETCH_REQUIRED",t.PANIC="PANIC",t.INITIAL_DATA="INITIAL_DATA",t}({}),Fe=r(1734),Ve=["createdAt"];function Ue(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ge(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ge(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Be(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?je(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ke(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ke=function(){return!!t})()}var Qe=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,Ke()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"checkPredefinedContext",value:function(t,e){var n=Le[t];if(!n)return null;var i=!1;return"string"===n?i="string"==typeof e:"number"===n&&(i="number"==typeof e),i||(0,E.logErrorSprintf)(this.config,d.PROCESS_UPDATE_CONTEXT,d.PREDEFINED_CONTEXT_TYPE_ERROR,this.visitor.visitorId,t,n),i}},{key:"updateContextKeyValue",value:function(t,e){var n=(0,a.default)(e);if("string"==typeof t&&""!==t)if("string"===n||"number"===n||"boolean"===n){if(t!==we&&t!==xe&&t!==Pe){var i=this.checkPredefinedContext(t,e);("boolean"!=typeof i||i)&&(this.visitor.context[t]=e)}}else(0,E.logErrorSprintf)(this.config,d.PROCESS_UPDATE_CONTEXT,d.CONTEXT_VALUE_ERROR,this.visitor.visitorId,t);else(0,E.logErrorSprintf)(this.config,d.PROCESS_UPDATE_CONTEXT,d.CONTEXT_KEY_ERROR,this.visitor.visitorId,t)}},{key:"checkAndUpdateContext",value:function(t,e,n){(0,E.deepEqual)(t,e)||(this.visitor.hasContextBeenUpdated=!0,this.visitor.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.UPDATE_CONTEXT},(0,E.logDebugSprintf)(this.config,d.PROCESS_UPDATE_CONTEXT,d.CONTEXT_KEY_VALUE_UPDATE,this.visitor.visitorId,e,n,this.visitor.context))}},{key:"updateContext",value:function(t,e){var n=Be({},this.visitor.context);if("string"!=typeof t)if(t){for(var i in t){var r=t[i];this.updateContextKeyValue(i,r)}var o=this.visitor.context;this.checkAndUpdateContext(n,o,t)}else(0,E.logError)(this.visitor.config,d.CONTEXT_NULL_ERROR,d.PROCESS_UPDATE_CONTEXT);else{this.updateContextKeyValue(t,e);var s=this.visitor.context;this.checkAndUpdateContext(n,s,e)}}},{key:"clearContext",value:function(){var t=Be({},this.visitor.context);this.visitor.context={},this.visitor.loadPredefinedContext();var e=this.visitor.context;(0,E.deepEqual)(t,e)||(this.visitor.hasContextBeenUpdated=!0,this.visitor.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.UPDATE_CONTEXT},(0,E.logDebugSprintf)(this.config,d.PROCESS_CLEAR_CONTEXT,d.CLEAR_CONTEXT,this.visitor.visitorId,this.visitor.context))}},{key:"isDeDuplicated",value:function(t,e){if(0===e)return!1;var n=this.visitor.deDuplicationCache[t];return!!(n&&Date.now()-n<=1e3*e)||(this.visitor.deDuplicationCache[t]=Date.now(),this.visitor.clearDeDuplicationCache(e),!1)}},{key:"sendActivate",value:(_=e(s().mark((function t(e,n){var i,r,o,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r={variationGroupId:e.variationGroupId,variationId:e.variationId,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,flagKey:e.key,flagValue:e.value,flagDefaultValue:n,visitorContext:this.visitor.context,flagMetadata:{campaignName:e.campaignName,campaignId:e.campaignId,campaignType:e.campaignType,variationGroupId:e.variationGroupId,variationGroupName:e.variationGroupName,variationId:e.variationId,variationName:e.variationName,slug:e.slug,isReference:e.isReference},qaMode:this.config.isQAModeEnabled},!this.isDeDuplicated(JSON.stringify(r),this.config.hitDeduplicationTime)){t.next=5;break}return o={visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,flag:e,delay:0},(0,E.logDebug)(this.config,(0,E.sprintf)("Activate {0} is deduplicated",JSON.stringify(o)),d.PROCESS_SEND_HIT),t.abrupt("return");case 5:return t.next=7,this.trackingManager.activateFlag(r);case 7:a=new q({label:P.VISITOR_SEND_ACTIVATE,logLevel:y.LogLevel.INFO,traffic:this.visitor.traffic,visitorId:r.visitorId,flagshipInstanceId:null==(i=this.visitor.sdkInitialData)?void 0:i.instanceId,visitorSessionId:this.visitor.instanceId,anonymousId:r.anonymousId,config:this.config,hitContent:r}),this.sendTroubleshootingHit(a);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return _.apply(this,arguments)})},{key:"sendHit",value:(I=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.hasTrackingManager(d.PROCESS_SEND_HIT)){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.prepareAndSendHit(e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return I.apply(this,arguments)})},{key:"sendHits",value:(v=e(s().mark((function t(e){var n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.hasTrackingManager(d.PROCESS_SEND_HIT)){t.next=2;break}return t.abrupt("return");case 2:n=Ue(e),t.prev=3,n.s();case 5:if((i=n.n()).done){t.next=11;break}return r=i.value,t.next=9,this.prepareAndSendHit(r);case 9:t.next=5;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),n.e(t.t0);case 16:return t.prev=16,n.f(),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[3,13,16,19]])}))),function(t){return v.apply(this,arguments)})},{key:"getHit",value:(p=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=null,t.t0=e.type.toUpperCase(),t.next=t.t0===$.EVENT?4:t.t0===$.ITEM?6:t.t0===$.PAGE_VIEW?8:t.t0===$.SCREEN_VIEW?10:t.t0===$.TRANSACTION?12:14;break;case 4:return n=new ct(e),t.abrupt("break",14);case 6:return n=new Gt(e),t.abrupt("break",14);case 8:return n=new Qt(e),t.abrupt("break",14);case 10:return n=new ht(e),t.abrupt("break",14);case 12:return n=new zt(e),t.abrupt("break",14);case 14:return t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)}))),function(t){return p.apply(this,arguments)})},{key:"isHitAbstract",value:function(t){return t&&"function"==typeof t.toApiKeys&&"function"==typeof t.isReady&&"function"==typeof t.getErrorMessage&&"function"==typeof t.toObject}},{key:"prepareAndSendHit",value:(g=e(s().mark((function t(e){var n,i,r,o,a,c,u,l=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:d.PROCESS_SEND_HIT,null!=e&&e.type){t.next=4;break}return(0,E.logError)(this.config,"Hit must not be null",n),t.abrupt("return");case 4:if(!this.isHitAbstract(e)){t.next=8;break}i=e,t.next=15;break;case 8:return t.next=10,this.getHit(e);case 10:if(r=t.sent){t.next=14;break}return(0,E.logError)(this.config,"property type is required and must ",n),t.abrupt("return");case 14:i=r;case 15:if(i.visitorId=this.visitor.visitorId,i.ds=d.SDK_APP,i.config=this.config,i.anonymousId=this.visitor.anonymousId,i.qaMode=this.config.isQAModeEnabled,(o=i.toObject()).createdAt,a=$t(o,Ve),!this.isDeDuplicated(JSON.stringify(a),this.config.hitDeduplicationTime)){t.next=23;break}return t.abrupt("return");case 23:if(i.isReady()){t.next=26;break}return(0,E.logError)(this.config,i.getErrorMessage(),n),t.abrupt("return");case 26:return t.prev=26,t.next=29,this.trackingManager.addHit(i);case 29:if("SEGMENT"!==i.type){t.next=31;break}return t.abrupt("return");case 31:u=new q({label:P.VISITOR_SEND_HIT,logLevel:y.LogLevel.INFO,traffic:this.visitor.traffic,visitorId:i.visitorId,flagshipInstanceId:null==(c=this.visitor.sdkInitialData)?void 0:c.instanceId,visitorSessionId:this.visitor.instanceId,anonymousId:i.anonymousId,config:this.config,hitContent:i.toApiKeys()}),this.sendTroubleshootingHit(u),t.next=38;break;case 35:t.prev=35,t.t0=t.catch(26),(0,E.logError)(this.config,t.t0.message||t.t0,n);case 38:case"end":return t.stop()}}),t,this,[[26,35]])}))),function(t){return g.apply(this,arguments)})},{key:"authenticate",value:function(t){var e;if(t)if(this.visitor.anonymousId)(0,E.logWarningSprintf)(this.config,d.AUTHENTICATE,d.VISITOR_ALREADY_AUTHENTICATE,this.visitor.visitorId,this.visitor.anonymousId);else{this.visitor.anonymousId=this.visitor.visitorId,this.visitor.visitorId=t;var n=new q({label:P.VISITOR_AUTHENTICATE,logLevel:y.LogLevel.INFO,flagshipInstanceId:null==(e=this.visitor.sdkInitialData)?void 0:e.instanceId,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorContext:this.visitor.context,traffic:this.visitor.traffic,config:this.config});this.sendTroubleshootingHit(n),this.visitor.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.AUTHENTICATE},(0,E.logDebugSprintf)(this.config,d.AUTHENTICATE,d.VISITOR_AUTHENTICATE,this.visitor.visitorId,this.visitor.anonymousId)}else(0,E.logErrorSprintf)(this.config,d.AUTHENTICATE,d.VISITOR_AUTHENTICATE_VISITOR_ID_ERROR,this.visitor.visitorId)}},{key:"unauthenticate",value:function(){var t;if(this.visitor.anonymousId){this.visitor.visitorId=this.visitor.anonymousId,this.visitor.anonymousId=null;var e=new q({label:P.VISITOR_UNAUTHENTICATE,logLevel:y.LogLevel.INFO,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,flagshipInstanceId:null==(t=this.visitor.sdkInitialData)?void 0:t.instanceId,visitorContext:this.visitor.context,traffic:this.visitor.traffic,config:this.config});this.sendTroubleshootingHit(e),this.visitor.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.UNAUTHENTICATE},(0,E.logDebugSprintf)(this.config,d.UNAUTHENTICATE,d.VISITOR_UNAUTHENTICATE,this.visitor.visitorId)}else(0,E.logErrorSprintf)(this.config,d.UNAUTHENTICATE,d.FLAGSHIP_VISITOR_NOT_AUTHENTICATE,this.visitor.visitorId)}},{key:"handleFetchFlagsError",value:function(t,e,n){var i,r,o,s,a,c,u;this.visitor.emit(d.EMIT_READY,t);var l=t instanceof Error?t.message:t,f=(0,E.errorFormat)(l,{visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,context:this.visitor.context,statusReason:this.visitor.flagsStatus.reason,duration:Date.now()-e});(0,E.logError)(this.config,f,d.PROCESS_FETCHING_FLAGS),this.visitor.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.FLAGS_FETCHING_ERROR};var h=new q({label:P.VISITOR_FETCH_CAMPAIGNS_ERROR,logLevel:y.LogLevel.INFO,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(i=this.visitor.sdkInitialData)?void 0:i.instanceId,traffic:this.visitor.traffic,config:this.config,visitorContext:this.visitor.context,sdkStatus:this.visitor.getSdkStatus(),visitorCampaigns:n,visitorConsent:this.visitor.hasConsented,visitorIsAuthenticated:!!this.visitor.anonymousId,visitorFlags:this.visitor.flagsData,visitorInitialCampaigns:null==(r=this.visitor.sdkInitialData)?void 0:r.initialCampaigns,visitorInitialFlagsData:null==(o=this.visitor.sdkInitialData)?void 0:o.initialFlagsData,lastBucketingTimestamp:this.configManager.decisionManager.lastBucketingTimestamp,lastInitializationTimestamp:null==(s=this.visitor.sdkInitialData)?void 0:s.lastInitializationTimestamp,httpResponseTime:Date.now()-e,sdkConfigMode:this.getSdkConfigDecisionMode(),sdkConfigTimeout:this.config.timeout,sdkConfigPollingInterval:this.config.pollingInterval,sdkConfigTrackingManagerStrategy:null==(a=this.config.trackingManagerConfig)?void 0:a.cacheStrategy,sdkConfigTrackingManagerBatchIntervals:null==(c=this.config.trackingManagerConfig)?void 0:c.batchIntervals,sdkConfigTrackingManagerPoolMaxSize:null==(u=this.config.trackingManagerConfig)?void 0:u.poolMaxSize,sdkConfigFetchNow:this.config.fetchNow,sdkConfigReuseVisitorIds:this.config.reuseVisitorIds,sdkConfigInitialBucketing:this.config.initialBucketing,sdkConfigDecisionApiUrl:this.config.decisionApiUrl,sdkConfigHitDeduplicationTime:this.config.hitDeduplicationTime});this.trackingManager.addTroubleshootingHit(h)}},{key:"getCampaigns",value:(h=e(s().mark((function t(e){var n,i,r,o,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,i=d.PROCESS_FETCHING_FLAGS,t.prev=2,r=Date.now()-this.visitor.lastFetchFlagsTimestamp,(o=this.visitor.flagsStatus.status)!==He.FETCHING||!this.visitor.getCampaignsPromise){t.next=10;break}return t.next=8,this.visitor.getCampaignsPromise;case 8:return n=t.sent,t.abrupt("return",{campaigns:n,isFetching:!0});case 10:if(a=1e3*this.config.fetchFlagsBufferingTime,!(o===He.FETCHED&&r<a)){t.next=14;break}return(0,E.logInfoSprintf)(this.config,i,d.FETCH_FLAGS_BUFFERING_MESSAGE,this.visitor.visitorId,a-r),t.abrupt("return",{campaigns:n,isBuffered:!0});case 14:return(0,E.logDebugSprintf)(this.config,i,d.FETCH_FLAGS_STARTED,this.visitor.visitorId),this.visitor.flagsStatus={status:He.FETCHING,reason:Fe.FSFetchReasons.NONE},t.next=18,this.lookupVisitor();case 18:return t.next=20,this.visitor.emotionAi.fetchEAIScore();case 20:return this.visitor.getCampaignsPromise=this.decisionManager.getCampaignsAsync(this.visitor),t.next=23,this.visitor.getCampaignsPromise;case 23:return n=t.sent,this.visitor.lastFetchFlagsTimestamp=Date.now(),this.decisionManager.isPanic()&&(this.visitor.flagsStatus={status:He.PANIC,reason:Fe.FSFetchReasons.NONE}),this.configManager.trackingManager.troubleshootingData=this.decisionManager.troubleshooting,(0,E.logDebugSprintf)(this.config,i,d.FETCH_CAMPAIGNS_SUCCESS,this.visitor.visitorId,this.visitor.anonymousId,this.visitor.context,n,Date.now()-e),t.abrupt("return",{campaigns:n});case 31:return t.prev=31,t.t0=t.catch(2),(0,E.logError)(this.config,t.t0.message,d.PROCESS_FETCHING_FLAGS),this.visitor.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.FLAGS_FETCHING_ERROR},t.abrupt("return",{error:t.t0,campaigns:n});case 36:case"end":return t.stop()}}),t,this,[[2,31]])}))),function(t){return h.apply(this,arguments)})},{key:"fetchCampaignsFromCache",value:function(t){var e;return Array.isArray(null==t||null==(e=t.visitorCache)?void 0:e.data.campaigns)?t.visitorCache.data.campaigns.map((function(t){return{id:t.campaignId,variationGroupId:t.variationGroupId,slug:t.slug,variation:{id:t.variationId,reference:!!t.isReference,modifications:{type:t.type,value:t.flags}}}})):null}},{key:"handleNoCampaigns",value:function(t){var e=this.fetchCampaignsFromCache(this.visitor);return e&&(this.visitor.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.FLAGS_FETCHED_FROM_CACHE},(0,E.logDebugSprintf)(this.config,d.PROCESS_FETCHING_FLAGS,d.FETCH_CAMPAIGNS_FROM_CACHE,this.visitor.visitorId,this.visitor.anonymousId,this.visitor.context,e,Date.now()-t)),e}},{key:"sendVisitorAllocatedVariations",value:function(){var t=this,e={};this.visitor.flagsData.forEach((function(t){e[t.campaignId]={variationId:t.variationId,variationGroupId:t.variationGroupId,campaignId:t.campaignId}})),this.visitor.visitorVariationState.visitorVariations=e,this.config.isQAModeEnabled&&r.e(532).then(r.bind(r,6532)).then((function(e){e.sendVisitorAllocatedVariations(t.visitor.visitorVariationState)}))}},{key:"extractFlags",value:function(t){var e=new Map;return t.forEach((function(t){var n=t.variation.modifications.value;for(var i in n){var r=n[i];e.set(i,{key:i,campaignId:t.id,campaignName:t.name||"",variationGroupId:t.variationGroupId,variationGroupName:t.variationGroupName||"",variationId:t.variation.id,variationName:t.variation.name||"",isReference:!!t.variation.reference,campaignType:t.type,slug:t.slug,value:r})}})),e}},{key:"fetchFlags",value:(l=e(s().mark((function t(){var e,n,i,r,o,a,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Date.now(),n=null,t.next=4,this.getCampaigns(e);case 4:if(i=t.sent,r=i.campaigns,o=i.error,a=i.isFetching,c=i.isBuffered,!a&&!c){t.next=11;break}return t.abrupt("return");case 11:n=r;try{n||(n=this.handleNoCampaigns(e)),n=n||[],this.visitor.campaigns=n,this.visitor.flagsData=this.extractFlags(this.visitor.campaigns),this.cacheVisitor(),this.visitor.emit(d.EMIT_READY,o),this.visitor.flagsStatus.status===He.FETCHING&&(this.visitor.flagsStatus={status:He.FETCHED,reason:Fe.FSFetchReasons.NONE}),this.sendVisitorAllocatedVariations(),(0,E.logDebugSprintf)(this.config,d.PROCESS_FETCHING_FLAGS,d.FETCH_FLAGS_FROM_CAMPAIGNS,this.visitor.visitorId,this.visitor.anonymousId,this.visitor.context,this.visitor.flagsData),this.decisionManager.troubleshooting&&(this.sendFetchFlagsTroubleshooting({campaigns:n,now:e,isFromCache:this.visitor.flagsStatus.reason===Fe.FSFetchReasons.FLAGS_FETCHED_FROM_CACHE}),this.sendConsentHitTroubleshooting(),this.sendSegmentHitTroubleshooting()),this.sendSdkConfigAnalyticHit()}catch(t){this.handleFetchFlagsError(t,e,n)}case 13:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"visitorExposed",value:(o=e(s().mark((function t(e){var n,i,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.key,i=e.flag,r=e.defaultValue,o=e.hasGetValueBeenCalled,i){t.next=5;break}return(0,E.logWarningSprintf)(this.visitor.config,d.FLAG_VISITOR_EXPOSED,d.USER_EXPOSED_FLAG_ERROR,this.visitor.visitorId,n),this.sendFlagTroubleshooting(P.VISITOR_EXPOSED_FLAG_NOT_FOUND,n,r),t.abrupt("return");case 5:if(o){t.next=9;break}return(0,E.logWarningSprintf)(this.visitor.config,d.FLAG_VISITOR_EXPOSED,d.VISITOR_EXPOSED_VALUE_NOT_CALLED,this.visitor.visitorId,n),this.sendFlagTroubleshooting(P.FLAG_VALUE_NOT_CALLED,n,r,!0),t.abrupt("return");case 9:if(null==r||null===i.value||(0,E.hasSameType)(i.value,r)){t.next=13;break}return(0,E.logWarningSprintf)(this.visitor.config,d.FLAG_VISITOR_EXPOSED,d.USER_EXPOSED_CAST_ERROR,this.visitor.visitorId,n),this.sendFlagTroubleshooting(P.VISITOR_EXPOSED_TYPE_WARNING,n,r),t.abrupt("return");case 13:return t.next=15,this.sendActivate(i,r);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"sendFlagTroubleshooting",value:function(t,e,n,i){var r,o=new q({label:t,logLevel:y.LogLevel.WARNING,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(r=this.visitor.sdkInitialData)?void 0:r.instanceId,traffic:this.visitor.traffic,config:this.config,visitorContext:this.visitor.context,flagKey:e,flagDefault:n,visitorExposed:i});this.sendTroubleshootingHit(o)}},{key:"getFlagValue",value:function(t){var e=t.key,n=t.defaultValue,i=t.flag,r=t.visitorExposed;return i?(r&&this.sendActivate(i,n),null===i.value?n:null==n||(0,E.hasSameType)(i.value,n)?((0,E.logDebugSprintf)(this.config,d.FLAG_VALUE,d.GET_FLAG_VALUE,this.visitor.visitorId,e,i.value),i.value):((0,E.logWarningSprintf)(this.config,d.FLAG_VALUE,d.GET_FLAG_CAST_ERROR,this.visitor.visitorId,e,n),this.sendFlagTroubleshooting(P.GET_FLAG_VALUE_TYPE_WARNING,e,n,r),n)):((0,E.logWarningSprintf)(this.config,d.FLAG_VALUE,d.GET_FLAG_MISSING_ERROR,this.visitor.visitorId,e,n),this.sendFlagTroubleshooting(P.GET_FLAG_VALUE_FLAG_NOT_FOUND,e,n,r),n)}},{key:"SendFlagMetadataTroubleshooting",value:function(t){var e;(0,E.logWarningSprintf)(this.config,d.FLAG_METADATA,d.NO_FLAG_METADATA,this.visitor.visitorId,t);var n=new q({label:P.GET_FLAG_METADATA_TYPE_WARNING,logLevel:y.LogLevel.WARNING,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(e=this.visitor.sdkInitialData)?void 0:e.instanceId,traffic:this.visitor.traffic,config:this.config,visitorContext:this.visitor.context,flagKey:t});this.sendTroubleshootingHit(n)}},{key:"getFlagMetadata",value:function(t){var e=t.key,n=t.flag;return n?new Me({campaignId:n.campaignId,campaignName:n.campaignName,variationGroupId:n.variationGroupId,variationGroupName:n.variationGroupName,variationId:n.variationId,variationName:n.variationName,isReference:!!n.isReference,campaignType:n.campaignType,slug:n.slug}):((0,E.logWarningSprintf)(this.config,d.FLAG_METADATA,d.NO_FLAG_METADATA,this.visitor.visitorId,e),this.SendFlagMetadataTroubleshooting(e),Me.Empty())}}]);var o,l,h,g,p,v,I,_}(ge);function qe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(qe=function(){return!!t})()}var Ye=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,qe()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"lookupHits",value:(A=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return A.apply(this,arguments)})},{key:"lookupVisitor",value:(T=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return T.apply(this,arguments)})},{key:"cacheVisitor",value:(y=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return y.apply(this,arguments)})},{key:"collectEAIEventsAsync",value:(_=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("collectEAIData");case 1:case"end":return t.stop()}}),t,this)}))),function(){return _.apply(this,arguments)})},{key:"onEAICollectStatusChange",value:function(){}},{key:"reportEaiPageView",value:function(){}},{key:"reportEaiVisitorEvent",value:function(){}},{key:"sendVisitorAllocatedVariations",value:function(){}},{key:"sendHit",value:(I=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("sendHit");case 1:case"end":return t.stop()}}),t,this)}))),function(t){return I.apply(this,arguments)})},{key:"sendHits",value:(p=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("sendHits");case 1:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"fetchFlags",value:(g=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("fetchFlags");case 1:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"getFlagValue",value:function(t){return this.log("Flag.value"),t.defaultValue}},{key:"visitorExposed",value:(h=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log(d.FLAG_VISITOR_EXPOSED);case 1:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"getFlagMetadata",value:function(t){var e=Me.Empty();return(0,E.logErrorSprintf)(this.config,d.FLAG_METADATA,d.METADATA_SDK_NOT_READY,this.visitor.visitorId,t.key,e),e}},{key:"sendActivate",value:(l=e(s().mark((function t(e,n){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return l.apply(this,arguments)})},{key:"sendTroubleshootingHit",value:(a=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"sendSdkConfigAnalyticHit",value:(o=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"addInTrackingManager",value:(r=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"log",value:function(t){(0,E.logErrorSprintf)(this.config,t,d.METHOD_DEACTIVATED_ERROR,this.visitor.visitorId,t,v[v.SDK_NOT_INITIALIZED])}}]);var r,o,a,l,h,g,p,I,_,y,T,A}(Qe);function We(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(We=function(){return!!t})()}var ze=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,We()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"setConsent",value:function(t){this.visitor.hasConsented=t}},{key:"updateContext",value:function(){this.log("updateContext")}},{key:"clearContext",value:function(){this.log("clearContext")}},{key:"lookupHits",value:(A=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return A.apply(this,arguments)})},{key:"lookupVisitor",value:(T=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return T.apply(this,arguments)})},{key:"cacheVisitor",value:(y=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return y.apply(this,arguments)})},{key:"cacheHit",value:(_=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return _.apply(this,arguments)})},{key:"fetchCampaignsFromCache",value:function(){return[]}},{key:"sendVisitorAllocatedVariations",value:function(){}},{key:"sendHit",value:(I=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("sendHit");case 1:case"end":return t.stop()}}),t,this)}))),function(t){return I.apply(this,arguments)})},{key:"sendHits",value:(p=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("sendHits");case 1:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"getFlagValue",value:function(t){return this.log("Flag.value"),t.defaultValue}},{key:"visitorExposed",value:(g=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log(d.FLAG_VISITOR_EXPOSED);case 1:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"getFlagMetadata",value:function(t){var e=Me.Empty();return(0,E.logInfoSprintf)(this.config,d.FLAG_METADATA,d.METADATA_PANIC_MODE,this.visitor.visitorId,t.key,e),e}},{key:"sendTroubleshootingHit",value:(h=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return h.apply(this,arguments)})},{key:"sendSdkConfigAnalyticHit",value:(l=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)})},{key:"sendActivate",value:(a=e(s().mark((function t(e,n){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)})},{key:"collectEAIEventsAsync",value:(o=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("collectEAIData");case 1:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"reportEaiPageView",value:function(){}},{key:"reportEaiVisitorEvent",value:function(){}},{key:"onEAICollectStatusChange",value:function(){}},{key:"addInTrackingManager",value:(r=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"log",value:function(t){(0,E.logInfoSprintf)(this.config,t,d.METHOD_DEACTIVATED_ERROR,this.visitor.visitorId,t,v[v.SDK_PANIC])}}]);var r,o,a,l,h,g,p,I,_,y,T,A}(Qe);function Xe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Xe=function(){return!!t})()}var Je=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,Xe()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"lookupHits",value:(y=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return y.apply(this,arguments)})},{key:"lookupVisitor",value:(_=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return _.apply(this,arguments)})},{key:"cacheVisitor",value:(I=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return I.apply(this,arguments)})},{key:"cacheHit",value:(v=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return v.apply(this,arguments)})},{key:"collectEAIEventsAsync",value:(p=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("collectEAIData");case 1:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"reportEaiPageView",value:function(){}},{key:"reportEaiVisitorEvent",value:function(){}},{key:"onEAICollectStatusChange",value:function(){}},{key:"fetchCampaignsFromCache",value:function(){return[]}},{key:"sendHit",value:(g=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("sendHit");case 1:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)})},{key:"sendHits",value:(h=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("sendHits");case 1:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"sendActivate",value:(l=e(s().mark((function t(e,n){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return l.apply(this,arguments)})},{key:"visitorExposed",value:(a=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log(d.FLAG_VISITOR_EXPOSED);case 1:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"sendTroubleshootingHit",value:(o=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"addInTrackingManager",value:(r=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"log",value:function(t){(0,E.logInfo)(this.config,(0,E.sprintf)(d.METHOD_DEACTIVATED_CONSENT_ERROR,t,this.visitor.visitorId),t)}}]);var r,o,a,l,h,g,p,v,I,_,y}(Qe),Ze=function(){return(0,n.default)((function(){}),[{key:"murmurHash3Int32",value:function(t){var e,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=3&t.length,a=t.length-s;e=o;var c=3432918353,u=461845907;for(r=0;r<a;)i=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24,++r,e=27492+(65535&(n=5*(65535&(e=(e^=i=(65535&(i=(i=(65535&i)*c+(((i>>>16)*c&65535)<<16)&4294967295)<<15|i>>>17))*u+(((i>>>16)*u&65535)<<16)&4294967295)<<13|e>>>19))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(n>>>16)&65535)<<16);switch(i=0,s){case 3:i^=(255&t.charCodeAt(r+2))<<16;case 2:i^=(255&t.charCodeAt(r+1))<<8;case 1:e^=i=(65535&(i=(i=(65535&(i^=255&t.charCodeAt(r)))*c+(((i>>>16)*c&65535)<<16)&4294967295)<<15|i>>>17))*u+(((i>>>16)*u&65535)<<16)&4294967295}return e^=t.length,e=2246822507*(65535&(e^=e>>>16))+((2246822507*(e>>>16)&65535)<<16)&4294967295,e=3266489909*(65535&(e^=e>>>13))+((3266489909*(e>>>16)&65535)<<16)&4294967295,(e^=e>>>16)>>>0}}])}();function $e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($e=function(){return!!t})()}var tn=function(t){function i(t){var e,n,r,o,s=t.visitorId,a=t.context,l=t.isAuthenticated,f=t.hasConsented,h=t.initialFlagsData,g=t.initialCampaigns,p=t.onFlagsStatusChanged;n=this,r=u(r=i),e=c(n,$e()?Reflect.construct(r,[],u(n).constructor):r.apply(n,o)),(0,_.default)(e,"lastFetchFlagsTimestamp",0),e._visitorVariationState=t.visitorVariationState||{},e.initBaseProperties(t),e.initVisitorId(s,l,f),e.initAnalyticTraffic(),e.setConsent(f||!1),e.updateContext(a),e.loadPredefinedContext(),(0,E.logDebugSprintf)(e.config,d.PROCESS_NEW_VISITOR,d.PREDEFINED_CONTEXT_LOADED,{fs_client:d.SDK_INFO.name,fs_version:d.SDK_INFO.version,fs_users:e.visitorId}),e.updateCache();var v=e.getStrategy();return e.setInitialFlags(h,v),e.setInitializeCampaigns(g,!!h,v),e.onFetchFlagsStatusChanged=p,e.updateFlagsStatus(),e._emotionAi.init(e),(0,E.logDebugSprintf)(e.config,d.PROCESS_NEW_VISITOR,d.VISITOR_CREATED,e.visitorId,e.context,!!l,!!e.hasConsented),e}return f(i,t),(0,n.default)(i,[{key:"visitorVariationState",get:function(){return this._visitorVariationState}},{key:"isClientSuppliedID",get:function(){return this._isClientSuppliedID}},{key:"hasContextBeenUpdated",get:function(){return this._hasContextBeenUpdated},set:function(t){this._hasContextBeenUpdated=t}},{key:"getCampaignsPromise",get:function(){return this._getCampaignsPromise},set:function(t){this._getCampaignsPromise=t}},{key:"onFetchFlagsStatusChanged",get:function(){return this._onFetchFlagsStatusChanged},set:function(t){this._onFetchFlagsStatusChanged=t}},{key:"flagsStatus",get:function(){return this._fetchStatus},set:function(t){this._fetchStatus=t,this.onFetchFlagsStatusChanged&&this.onFetchFlagsStatusChanged(t)}},{key:"segmentHitTroubleshooting",get:function(){return this._segmentHitTroubleshooting},set:function(t){this._segmentHitTroubleshooting=t}},{key:"consentHitTroubleshooting",get:function(){return this._consentHitTroubleshooting},set:function(t){this._consentHitTroubleshooting=t}},{key:"sdkInitialData",get:function(){return this._sdkInitialData}},{key:"getSdkStatus",value:function(){return i.SdkStatus}},{key:"visitorCacheStatus",get:function(){return this._visitorCacheStatus},set:function(t){this._visitorCacheStatus=t}},{key:"emotionAi",get:function(){return this._emotionAi}},{key:"analyticTraffic",get:function(){return this._analyticTraffic}},{key:"initBaseProperties",value:function(t){var e=t.configManager,n=t.emotionAi,i=t.monitoringData,r=t.visitorProfileCache;this._murmurHash=t.murmurHash||new Ze,this._emotionAi=n,this._hasContextBeenUpdated=!0,this._exposedVariations={},this._sdkInitialData=i,this._instanceId=(0,E.uuidV4)(),this._isCleaningDeDuplicationCache=!1,this.deDuplicationCache={},this._context={},this._configManager=e,this.campaigns=[],this._visitorProfileCache=r}},{key:"getVisitorIdFromTag",value:function(){var t,e,n;if(!(null==(t=window.ABTasty)||null==(t=t.api)||null==(t=t.internal)||null==(e=t._isByoidConfigured)?void 0:e.call(t))){var i=null==(n=window.ABTasty)||null==(n=n.api)||null==(n=n.v1)?void 0:n.getValue("visitorId");return i&&(0,E.logDebugSprintf)(this.config,d.PROCESS_NEW_VISITOR,d.VISITOR_ID_FROM_AB_TASTY_TAG,i),i}}},{key:"hasVisitorProfileClientSuppliedId",value:function(t){return void 0===t.isClientSuppliedId||t.isClientSuppliedId}},{key:"initVisitorId",value:function(t,e,n){var i,r=this.config.reuseVisitorIds&&!0===n?null==(i=this._visitorProfileCache)?void 0:i.loadVisitorProfile():null;r&&(0,E.logDebugSprintf)(this.config,d.PROCESS_NEW_VISITOR,d.VISITOR_PROFILE_LOADED,r),this._isClientSuppliedID=!1,t?(this.visitorId=t,this._isClientSuppliedID=!0):!e&&null!=r&&r.anonymousId?(this.visitorId=r.anonymousId,this._isClientSuppliedID=this.hasVisitorProfileClientSuppliedId(r)):null!=r&&r.visitorId?(this.visitorId=r.visitorId,this._isClientSuppliedID=this.hasVisitorProfileClientSuppliedId(r)):this.visitorId=this.getVisitorIdFromTag()||this.generateVisitorId(),this._anonymousId=null,e&&(this._anonymousId=(null==r?void 0:r.anonymousId)||(0,E.uuidV4)())}},{key:"updateFlagsStatus",value:function(){this._flags.size>0?this.flagsStatus={status:He.INITIAL_DATA,reason:Fe.FSFetchReasons.NONE}:this.flagsStatus={status:He.FETCH_REQUIRED,reason:Fe.FSFetchReasons.FLAGS_NEVER_FETCHED}}},{key:"updateCache",value:function(){var t,e=this.hasConsented?{visitorId:this.visitorId,anonymousId:this.anonymousId,isClientSuppliedId:this.isClientSuppliedID}:void 0;null==(t=this._visitorProfileCache)||t.saveVisitorProfile(e)}},{key:"traffic",get:function(){return this._traffic},set:function(t){this._traffic=t}},{key:"instanceId",get:function(){return this._instanceId}},{key:"getCurrentDateTime",value:function(){return new Date}},{key:"initAnalyticTraffic",value:function(){var t=this.visitorId+this.getCurrentDateTime().toDateString(),e=this._murmurHash.murmurHash3Int32(t);this._analyticTraffic=e%1e3}},{key:"generateVisitorId",value:function(){var t=(0,E.uuidV4)();return(0,E.logDebugSprintf)(this.config,d.PROCESS_NEW_VISITOR,d.VISITOR_ID_GENERATED,t),t}},{key:"clearDeDuplicationCache",value:function(t){if(!this._isCleaningDeDuplicationCache){this._isCleaningDeDuplicationCache=!0;for(var e=0,n=Object.entries(this.deDuplicationCache);e<n.length;e++){var i=Z(n[e],2),r=i[0],o=i[1];Date.now()-o>1e3*t&&delete this.deDuplicationCache[r]}this._isCleaningDeDuplicationCache=!1}}},{key:"setInitialFlags",value:function(t,e){var n=this;this._flags=new Map,Array.isArray(t)&&(t.forEach((function(t){var e;n._flags.set(t.key,{key:t.key,campaignId:t.campaignId,campaignName:t.campaignName,variationGroupId:t.variationGroupId,variationGroupName:t.variationGroupName,variationId:t.variationId,variationName:t.variationName,isReference:t.isReference,value:null==(e=(0,E.hexToValue)(t.hex,n.config))?void 0:e.v,slug:t.slug,campaignType:t.campaignType})})),null==e||e.sendVisitorAllocatedVariations())}},{key:"setInitializeCampaigns",value:function(t,e,n){t&&Array.isArray(t)&&!e&&(null==n||n.updateCampaigns(t),null==n||n.sendVisitorAllocatedVariations())}},{key:"loadPredefinedContext",value:function(){this.context.fs_client=d.SDK_INFO.name,this.context.fs_version=d.SDK_INFO.version,this.context.fs_users=this.visitorId}},{key:"visitorId",get:function(){return this._visitorId},set:function(t){t&&"string"==typeof t?(this._visitorId=t,this.loadPredefinedContext(),this.visitorCache=void 0):(0,E.logError)(this.config,d.VISITOR_ID_ERROR,"VISITOR ID")}},{key:"hasConsented",get:function(){return this._hasConsented},set:function(t){this._hasConsented=t}},{key:"setConsent",value:function(t){this.hasConsented=t,this.getStrategy().setConsent(t)}},{key:"context",get:function(){return this._context},set:function(t){this._context={},this.updateContext(t)}},{key:"flagsData",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"configManager",get:function(){return this._configManager}},{key:"config",get:function(){return this.configManager.config}},{key:"campaigns",get:function(){return this._campaigns},set:function(t){this._campaigns=t}},{key:"anonymousId",get:function(){return this._anonymousId},set:function(t){this._anonymousId=t}},{key:"getStrategy",value:function(){var t={visitor:this,murmurHash:new Ze},e=this.getSdkStatus();return void 0===e||e===v.SDK_NOT_INITIALIZED?new Ye(t):e===v.SDK_PANIC?new ze(t):this.hasConsented?new Qe(t):new Je(t)}},{key:"sendExposedVariation",value:(g=e(s().mark((function t(e){var n,i,o,a=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&(0,E.isBrowser)()){t.next=3;break}return t.abrupt("return");case 3:if(this._exposedVariations[e.campaignId]={campaignId:e.campaignId,variationGroupId:e.variationGroupId,variationId:e.variationId},this._visitorVariationState.exposedVariations=this._exposedVariations,this.config.isQAModeEnabled){t.next=7;break}return t.abrupt("return");case 7:return n=10,i=100,t.next=11,r.e(532).then(r.bind(r,6532));case 11:if(o=t.sent,Object.keys(this._exposedVariations).length>=n&&(o.sendVisitorExposedVariations(this._visitorVariationState),this._exposedVariations={}),this._sendExposedVariationTimeoutId&&clearTimeout(this._sendExposedVariationTimeoutId),0!==Object.keys(this._exposedVariations).length){t.next=16;break}return t.abrupt("return");case 16:this._sendExposedVariationTimeoutId=setTimeout((function(){o.sendVisitorExposedVariations(a._visitorVariationState),a._exposedVariations={}}),i);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)})},{key:"collectEAIEventsAsync",value:function(t){return this.getStrategy().collectEAIEventsAsync(t)}},{key:"sendEaiVisitorEvent",value:function(t){this.getStrategy().reportEaiVisitorEvent(t)}},{key:"sendEaiPageView",value:function(t){this.getStrategy().reportEaiPageView(t)}},{key:"onEAICollectStatusChange",value:function(t){this.getStrategy().onEAICollectStatusChange(t)}},{key:"cleanup",value:function(){this.getStrategy().cleanup()}},{key:"getCachedEAIScore",value:(h=e(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.visitorCache){t.next=3;break}return t.next=3,this.getStrategy().lookupVisitor();case 3:return t.abrupt("return",null==(e=this.visitorCache)||null==(e=e.data)?void 0:e.eAIScore);case 4:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"isEAIDataCollected",value:(l=e(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.visitorCache){t.next=3;break}return t.next=3,this.getStrategy().lookupVisitor();case 3:return t.abrupt("return",(null==(e=this.visitorCache)||null==(e=e.data)?void 0:e.isEAIDataCollected)||!1);case 4:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"setCachedEAIScore",value:(a=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.getStrategy().cacheVisitor(e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"setIsEAIDataCollected",value:(o=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.getStrategy().cacheVisitor(void 0,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"sendTroubleshooting",value:function(t){return this.getStrategy().sendTroubleshootingHit(t)}},{key:"sendUsageHit",value:function(t){return this.getStrategy().sendUsageHit(t)}},{key:"addInTrackingManager",value:function(t){return this.getStrategy().addInTrackingManager(t)}}]);var o,a,l,h,g}(h.EventEmitter),en=function(t){return t.FETCHED="FETCHED",t.FETCH_REQUIRED="FETCH_REQUIRED",t.NOT_FOUND="NOT_FOUND",t.PANIC="PANIC",t}({});function nn(t){var e=t.flagDTO,n=t.config,i=t.visitorVariationState;if(n.isQAModeEnabled&&(0,E.isBrowser)()&&e&&i.forcedVariations){var r=i.forcedVariations[e.campaignId];if(r){var o=r.campaignId,s=r.campaignName,a=r.variationGroupId,c=r.variationGroupName,u=r.campaignType,l=r.CampaignSlug,f=r.variation,h=f.modifications.value[e.key];return{key:e.key,campaignId:o,campaignName:s,variationGroupId:a,variationGroupName:c,variationId:f.id,variationName:f.name,isReference:!!f.reference,campaignType:u,slug:l,value:h}}}}var rn=function(){return(0,n.default)((function(t){(0,_.default)(this,"hasGetValueBeenCalled",!1);var e=t.key,n=t.visitor;this._key=e,this._visitor=n}),[{key:"exists",value:function(){var t;if(!this._visitor)return!1;var e=null==(t=this._visitor)?void 0:t.flagsData.get(this._key),n=nn({flagDTO:e,config:this._visitor.config,visitorVariationState:this._visitor.visitorVariationState})||e;return!!(null!=n&&n.campaignId&&null!=n&&n.variationId&&null!=n&&n.variationGroupId)}},{key:"metadata",get:function(){if(!this._visitor)return Me.Empty();var t=this._visitor.flagsData.get(this._key),e=nn({flagDTO:t,config:this._visitor.config,visitorVariationState:this._visitor.visitorVariationState});return this._visitor.getFlagMetadata({key:this._key,flag:e||t})}},{key:"visitorExposed",value:(t=e(s().mark((function t(){var e,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._visitor){t.next=2;break}return t.abrupt("return");case 2:return e=this._visitor.flagsData.get(this._key),n=nn({flagDTO:e,config:this._visitor.config,visitorVariationState:this._visitor.visitorVariationState}),t.abrupt("return",this._visitor.visitorExposed({key:this._key,flag:n||e,defaultValue:this._defaultValue,hasGetValueBeenCalled:this.hasGetValueBeenCalled}));case 5:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"getValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._defaultValue=t,this.hasGetValueBeenCalled=!0,!this._visitor)return t;var n=this._visitor.flagsData.get(this._key),i=nn({flagDTO:n,config:this._visitor.config,visitorVariationState:this._visitor.visitorVariationState})||n;return this._visitor.sendExposedVariation(i),this._visitor.getFlagValue({key:this._key,defaultValue:t,flag:i,visitorExposed:e})}},{key:"status",get:function(){var t,e,n;return(null==(t=this._visitor)||null==(t=t.flagsStatus)?void 0:t.status)===He.PANIC?en.PANIC:this.exists()?(null==(e=this._visitor)||null==(e=e.flagsStatus)?void 0:e.status)===He.FETCH_REQUIRED||(null==(n=this._visitor)||null==(n=n.flagsStatus)?void 0:n.status)===He.FETCHING?en.FETCH_REQUIRED:en.FETCHED:en.NOT_FOUND}}]);var t}(),on=(r(1415),function(){function t(t){var e=this;(0,_.default)(this,"_keys",new Set);var n=t.visitor,i=t.flags;this._visitor=n,this._flags=i||new Map,0===this._flags.size?(this._keys=new Set(null==n?void 0:n.flagsData.keys()),this._keys.forEach((function(t){e._flags.set(t,new rn({key:t,visitor:n}))}))):this._keys=new Set(this._flags.keys())}return(0,n.default)(t,[{key:"size",get:function(){return this._keys.size}},{key:"get",value:function(t){var e;return this._flags.get(t)||(null!=(e=this._visitor)&&e.config&&(0,E.logWarningSprintf)(this._visitor.config,d.GET_FLAG,d.GET_FLAG_NOT_FOUND,this._visitor.visitorId,t),new rn({key:t}))}},{key:"has",value:function(t){return this._keys.has(t)}},{key:"keys",value:function(){return this._keys}},{key:Symbol.iterator,value:function(){var t=this,e=0,n=Array.from(this._keys);return{next:function(){if(e<n.length){var i=n[e++];return{value:[i,t._flags.get(i)],done:!1}}return{value:null,done:!0}}}}},{key:"filter",value:function(e){var n=this,i=new Map;return this._flags.forEach((function(t,r){e(t,r,n)&&i.set(r,t)})),new t({visitor:this._visitor,flags:i})}},{key:"exposeAll",value:(i=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(Array.from(this._flags.values(),(function(t){return t.visitorExposed()})));case 2:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getMetadata",value:function(){var t=new Map;return this._flags.forEach((function(e,n){t.set(n,e.metadata)})),t}},{key:"toJSON",value:function(){var t=[];return this._flags.forEach((function(e,n){var i=e.metadata;t.push({key:n,campaignId:i.campaignId,campaignName:i.campaignName,variationGroupId:i.variationGroupId,variationGroupName:i.variationGroupName,variationId:i.variationId,variationName:i.variationName,isReference:i.isReference,campaignType:i.campaignType,slug:i.slug,hex:(0,E.valueToHex)({v:e.getValue(null,!1)})})})),t}},{key:"forEach",value:function(t){var e=this;this._flags.forEach((function(n,i){t(n,i,e)}))}}]);var i}());function sn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(sn=function(){return!!t})()}var an=function(t){function i(){return t=this,n=arguments,e=u(e=i),c(t,sn()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n));var t,e,n}return f(i,t),(0,n.default)(i,[{key:"updateContext",value:function(t,e){this.getStrategy().updateContext(t,e),this.loadPredefinedContext()}},{key:"clearContext",value:function(){this.getStrategy().clearContext()}},{key:"getFlag",value:function(t){return this.flagsStatus.status!==He.FETCHED&&this.flagsStatus.status!==He.FETCHING&&this.flagsStatus.status!==He.INITIAL_DATA&&(0,E.logWarningSprintf)(this.config,d.GET_FLAG,(0,E.visitorFlagSyncStatusMessage)(this.flagsStatus.reason),this.visitorId,t),new rn({key:t,visitor:this})}},{key:"getFlags",value:function(){return new on({visitor:this})}},{key:"sendHit",value:function(t){return this.getStrategy().sendHit(t)}},{key:"sendHits",value:function(t){return this.getStrategy().sendHits(t)}},{key:"authenticate",value:function(t){this.getStrategy().authenticate(t),this.updateCache()}},{key:"unauthenticate",value:function(){this.getStrategy().unauthenticate(),this.updateCache()}},{key:"fetchFlags",value:(r=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getStrategy().fetchFlags();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"visitorExposed",value:function(t){return this.getStrategy().visitorExposed(t)}},{key:"getFlagValue",value:function(t){return this.getStrategy().getFlagValue(t)}},{key:"getFlagMetadata",value:function(t){return this.getStrategy().getFlagMetadata(t)}}]);var r}(tn);function cn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return un(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?un(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function un(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function ln(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ln=function(){return!!t})()}r(113),r(5086),r(9449),r(1392);var fn=function(t){function i(t){var e,n,r,o,s=t.httpClient,a=t.config,l=t.murmurHash,f=t.sdkManager;return n=this,o=[{httpClient:s,config:a,trackingManager:t.trackingManager,flagshipInstanceId:t.flagshipInstanceId}],r=u(r=i),(e=c(n,ln()?Reflect.construct(r,o||[],u(n).constructor):r.apply(n,o)))._murmurHash=l,e._sdkManager=f,e}return f(i,t),(0,n.default)(i,[{key:"_bucketingContent",get:function(){return this._sdkManager.getBucketingContent()}},{key:"sendContext",value:(a=e(s().mark((function t(e){var n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(Object.keys(e.context).length<=3)&&e.hasConsented&&e.hasContextBeenUpdated){t.next=3;break}return t.abrupt("return");case 3:return e.hasContextBeenUpdated=!1,i=new it({context:e.context,visitorId:e.visitorId,anonymousId:e.anonymousId}),t.next=7,e.sendHit(i);case 7:r=new q({label:P.VISITOR_SEND_HIT,logLevel:y.LogLevel.INFO,traffic:e.traffic||0,visitorId:e.visitorId,visitorSessionId:e.instanceId,flagshipInstanceId:null==(n=e.sdkInitialData)?void 0:n.instanceId,anonymousId:e.anonymousId,config:this.config,hitContent:i.toApiKeys()}),e.segmentHitTroubleshooting=r,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),(0,E.logError)(this.config,t.t0.message||t.t0,"sendContext");case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return a.apply(this,arguments)})},{key:"getThirdPartySegment",value:(o=e(s().mark((function t(e){var n,i,r,o,a,c,u,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,E.sprintf)(d.THIRD_PARTY_SEGMENT_URL,this.config.envId,e),i=Date.now(),r={},t.prev=3,t.next=6,this._httpClient.getAsync(n,{nextFetchConfig:this.config.nextFetchConfig});case 6:if(o=t.sent,a=o.body,Array.isArray(a)){c=cn(a);try{for(c.s();!(u=c.n()).done;)l=u.value,r["".concat(l.partner,"::").concat(l.segment)]=l.value}catch(t){c.e(t)}finally{c.f()}}t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),(0,E.logError)(this.config,(0,E.errorFormat)(t.t0.message||t.t0,{url:n,nextFetchConfig:this.config.nextFetchConfig,duration:Date.now()-i}),d.GET_THIRD_PARTY_SEGMENT);case 14:return t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this,[[3,11]])}))),function(t){return o.apply(this,arguments)})},{key:"getCampaignsAsync",value:(r=e(s().mark((function t(e){var n,i,r,o,a=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._bucketingContent){t.next=2;break}return t.abrupt("return",null);case 2:if(i=null==(n=this._bucketingContent)||null==(n=n.accountSettings)?void 0:n.troubleshooting,this.troubleshooting=void 0,i&&(this.troubleshooting={startDate:new Date(i.startDate),endDate:new Date(i.endDate),timezone:i.timezone,traffic:i.traffic}),!this._bucketingContent.panic){t.next=8;break}return this.panic=!0,t.abrupt("return",[]);case 8:if(this.panic=!1,this._bucketingContent.campaigns){t.next=11;break}return t.abrupt("return",null);case 11:if(!this.config.fetchThirdPartyData){t.next=16;break}return t.next=14,this.getThirdPartySegment(e.visitorId);case 14:r=t.sent,e.updateContext(r);case 16:return t.next=18,this.sendContext(e);case 18:return o=[],this._bucketingContent.campaigns.forEach((function(t){var n,i=a.getVisitorCampaigns(t.variationGroups,t.id,t.type,e);i&&(i.slug=null!=(n=t.slug)?n:null,i.name=t.name,o.push(i))})),t.abrupt("return",o);case 21:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"getVisitorCampaigns",value:function(t,e,n,i){var r,o=cn(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(this.isMatchTargeting(s,i)){var a=this.getVariation(s,i);return a?{id:e,variation:a,variationGroupId:s.id,variationGroupName:s.name,type:n}:null}}}catch(t){o.e(t)}finally{o.f()}return null}},{key:"getVariation",value:function(t,e){var n,i=this,r=this._murmurHash.murmurHash3Int32(t.id+e.visitorId)%100,o=0,s=cn(t.variations);try{var a,c=function(){var s,a=n.value,c=null==(s=e.visitorCache)||null==(s=s.data)?void 0:s.assignmentsHistory,u=c?c[t.id]:null;if(u){var l=t.variations.find((function(t){return t.id===u}));return l?((0,E.logDebugSprintf)(i.config,d.ALLOCATION,d.BUCKETING_VARIATION_CACHE,e.visitorId,l.id),{v:{id:l.id,name:l.name,modifications:l.modifications,reference:l.reference}}):0}return void 0===a.allocation||0===a.allocation?0:(o+=a.allocation,r<o?((0,E.logDebugSprintf)(i.config,d.ALLOCATION,d.BUCKETING_NEW_ALLOCATION,e.visitorId,a.id,o),{v:{id:a.id,modifications:a.modifications,reference:a.reference,name:a.name}}):void 0)};for(s.s();!(n=s.n()).done;)if(0!==(a=c())&&a)return a.v}catch(t){s.e(t)}finally{s.f()}return null}},{key:"isMatchTargeting",value:function(t,e){var n=this;return!!(t&&t.targeting&&t.targeting.targetingGroups)&&t.targeting.targetingGroups.some((function(t){return n.checkAndTargeting(t.targetings,e)}))}},{key:"isANDListOperator",value:function(t){return["NOT_EQUALS","NOT_CONTAINS"].includes(t)}},{key:"checkAndTargeting",value:function(t,e){var n,i,r=!1,o=cn(t);try{for(o.s();!(i=o.n()).done;){var s=i.value,a=s.key,c=s.value,u=s.operator;if("EXISTS"===u){if(a in e.context){r=!0;continue}r=!1;break}if("NOT_EXISTS"!==u)if("fs_all_users"!==a){if("fs_users"===a)n=e.visitorId;else{if(!(a in e.context)){r=!1;break}n=e.context[a]}if(!(r=this.testOperator(u,n,c)))break}else r=!0;else{if(a in e.context){r=!1;break}r=!0}}}catch(t){o.e(t)}finally{o.f()}return r}},{key:"testListOperatorLoop",value:function(t,e,n,i){var r,o=i,s=cn(n);try{for(s.s();!(r=s.n()).done;){var a=r.value;if((o=this.testOperator(t,e,a))!==i)break}}catch(t){s.e(t)}finally{s.f()}return o}},{key:"testListOperator",value:function(t,e,n){return this.isANDListOperator(t)?this.testListOperatorLoop(t,e,n,!0):this.testListOperatorLoop(t,e,n,!1)}},{key:"testOperator",value:function(t,e,n){var i;if(Array.isArray(n))return this.testListOperator(t,e,n);switch(t){case"EQUALS":i=e===n;break;case"NOT_EQUALS":i=e!==n;break;case"CONTAINS":i=e.toString().includes(n.toString());break;case"NOT_CONTAINS":i=!e.toString().includes(n.toString());break;case"GREATER_THAN":i=e>n;break;case"LOWER_THAN":i=e<n;break;case"GREATER_THAN_OR_EQUALS":i=e>=n;break;case"LOWER_THAN_OR_EQUALS":i=e<=n;break;case"STARTS_WITH":i=e.toString().startsWith(n.toString());break;case"ENDS_WITH":i=e.toString().endsWith(n.toString());break;default:i=!1}return i}}]);var r,o,a}(Y);function hn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(hn=function(){return!!t})()}function dn(t){var e="function"==typeof Map?new Map:void 0;return dn=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(hn())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(t.bind.apply(t,i));return n&&l(r,n.prototype),r}(t,arguments,u(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,t)},dn(t)}function gn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(gn=function(){return!!t})()}var pn=function(t){function e(t,n,i){var r,o,s,a;return o=this,a=[n],s=u(s=e),(r=c(o,gn()?Reflect.construct(s,a||[],u(o).constructor):s.apply(o,a)))._statusCode=t,r._headers=i,r}return f(e,t),(0,n.default)(e,[{key:"headers",get:function(){return this._headers}},{key:"statusCode",get:function(){return this._statusCode}}])}(dn(Error)),vn=AbortController,In=function(t,e){return fetch(t,e)},_n=function(){return(0,n.default)((function(){}),[{key:"getResponse",value:(r=e(s().mark((function t(e){var n,i,r,o,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.headers.get("Content-Type"),i=null==n?void 0:n.includes("application/json"),o={},e.headers.forEach((function(t,e){o[e]=t})),!i||!e.ok||204===e.status){t.next=8;break}return t.next=7,e.json();case 7:r=t.sent;case 8:if(!(e.status>=400)){t.next=13;break}return t.next=11,e.text();case 11:throw a=t.sent,new pn(e.status,a||e.statusText,o);case 13:return t.abrupt("return",{status:e.status,body:r,headers:o});case 14:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"getAbortController",value:function(){return new(void 0!==globalThis.AbortController?globalThis.AbortController:vn)}},{key:"getAsync",value:(i=e(s().mark((function t(e,n){var i,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.getAbortController(),r=setTimeout((function(){return i.abort()}),1e3*(null!=n&&n.timeout?n.timeout:d.REQUEST_TIME_OUT)),t.prev=2,t.next=5,In(e,{method:"GET",headers:null==n?void 0:n.headers,signal:i.signal,keepalive:!0,next:null==n?void 0:n.nextFetchConfig});case 5:return o=t.sent,t.abrupt("return",this.getResponse(o));case 7:return t.prev=7,clearTimeout(r),t.finish(7);case 10:case"end":return t.stop()}}),t,this,[[2,,7,10]])}))),function(t,e){return i.apply(this,arguments)})},{key:"postAsync",value:(t=e(s().mark((function t(e,n){var i,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.getAbortController(),r=setTimeout((function(){return i.abort()}),n.timeout?1e3*n.timeout:1e3*d.REQUEST_TIME_OUT),t.prev=2,t.next=5,In(e,{method:"POST",headers:n.headers,body:JSON.stringify(n.body),signal:i.signal,keepalive:!0,next:null==n?void 0:n.nextFetchConfig});case 5:return o=t.sent,t.abrupt("return",this.getResponse(o));case 7:return t.prev=7,clearTimeout(r),t.finish(7);case 10:case"end":return t.stop()}}),t,this,[[2,,7,10]])}))),function(e,n){return t.apply(this,arguments)})}]);var t,i,r}();function yn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(yn=function(){return!!t})()}var En=function(t){function e(){return t=this,i=arguments,n=u(n=e),c(t,yn()?Reflect.construct(n,i||[],u(t).constructor):n.apply(t,i));var t,n,i}return f(e,t),(0,n.default)(e,[{key:"getCampaignsAsync",value:function(e){return t.prototype.getCampaignsAsync.call(this,e)}}])}(fn);function Tn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function An(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tn(Object(n),!0).forEach((function(e){(0,_.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Sn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Sn=function(){return!!t})()}var mn=function(t){function e(t){return n=this,i=e,r=[An(An({},t),{},{decisionMode:I.BUCKETING_EDGE})],i=u(i),c(n,Sn()?Reflect.construct(i,r||[],u(n).constructor):i.apply(n,r));var n,i,r}return f(e,t),(0,n.default)(e)}(m),Cn=function(){return(0,n.default)((function(t){var e=t.httpClient,n=t.sdkConfig,i=t.trackingManager,r=t.flagshipInstanceId;this._httpClient=e,this._config=n,this._trackingManager=i,this._bucketingContent=n.initialBucketing,this._flagshipInstanceId=r,this._lastModified=""}),[{key:"resetSdk",value:function(){this._intervalID&&clearInterval(this._intervalID),this._isPooling=!1,this._intervalID=void 0,this._lastModified="",this._bucketingContent=void 0,this._EAIConfig=void 0,(0,E.logInfo)(this._config,d.BUCKETING_POOLING_STOPPED,d.PROCESS_BUCKETING)}},{key:"getBucketingContent",value:function(){return this._bucketingContent}},{key:"initSdk",value:(i=e(s().mark((function t(){var e,n=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=1e3*this._config.pollingInterval,t.next=3,this.fetchBucketingFile();case 3:if(0!==e){t.next=5;break}return t.abrupt("return");case 5:(0,E.logInfo)(this._config,d.BUCKETING_POOLING_STARTED,d.PROCESS_BUCKETING),this._intervalID=setInterval((function(){n.fetchBucketingFile()}),e);case 7:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getEAIConfig",value:function(){return this._EAIConfig}},{key:"sendTroubleshooting",value:function(t,e,n,i){var r=new q({visitorId:this._flagshipInstanceId,flagshipInstanceId:this._flagshipInstanceId,label:P.SDK_BUCKETING_FILE,traffic:0,logLevel:y.LogLevel.INFO,config:this._config,httpRequestHeaders:t,httpRequestMethod:"POST",httpRequestUrl:e,httpResponseBody:null==n?void 0:n.body,httpResponseHeaders:null==n?void 0:n.headers,httpResponseCode:null==n?void 0:n.status,httpResponseTime:Date.now()-i});this._trackingManager.initTroubleshootingHit=r}},{key:"sendErrorTroubleshooting",value:function(t,e,n,i){var r=new q({visitorId:this._flagshipInstanceId,flagshipInstanceId:this._flagshipInstanceId,label:P.SDK_BUCKETING_FILE_ERROR,traffic:0,logLevel:y.LogLevel.INFO,config:this._config,httpRequestHeaders:t,httpRequestMethod:"POST",httpRequestUrl:e,httpResponseBody:null==n?void 0:n.message,httpResponseHeaders:null==n?void 0:n.headers,httpResponseCode:null==n?void 0:n.statusCode,httpResponseTime:Date.now()-i});this._trackingManager.initTroubleshootingHit=r}},{key:"handlePollingResponse",value:function(t){var e,n,i,r=t.response;200===r.status?((0,E.logDebugSprintf)(this._config,d.PROCESS_BUCKETING,d.POLLING_EVENT_200,r.body),this._bucketingContent=r.body,this._lastBucketingTimestamp=(new Date).toISOString(),this._EAIConfig={eaiCollectEnabled:!(null==(n=this._bucketingContent)||null==(n=n.accountSettings)||!n.eaiActivationEnabled),eaiActivationEnabled:!(null==(i=this._bucketingContent)||null==(i=i.accountSettings)||!i.eaiCollectEnabled)},this.sendTroubleshooting(t.headers,t.url,r,t.now)):304===r.status&&(0,E.logDebug)(this._config,d.POLLING_EVENT_300,d.PROCESS_BUCKETING);var o=null==r||null==(e=r.headers)?void 0:e["last-modified"];o&&(this._lastModified!==o&&this._config.onBucketingUpdated&&this._config.onBucketingUpdated(new Date(o)),this._lastModified=o),this._isPooling=!1}},{key:"fetchBucketingFile",value:(t=e(s().mark((function t(){var e,n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isPooling){t.next=2;break}return t.abrupt("return");case 2:return this._isPooling=!0,e=(0,E.sprintf)(d.BUCKETING_API_URL,this._config.envId),n=(0,_.default)((0,_.default)((0,_.default)({},d.HEADER_X_SDK_CLIENT,d.SDK_INFO.name),d.HEADER_X_SDK_VERSION,d.SDK_INFO.version),d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON),i=Date.now(),t.prev=6,this._lastModified&&(n["if-modified-since"]=this._lastModified),t.next=10,this._httpClient.getAsync(e,{headers:n,timeout:this._config.timeout,nextFetchConfig:this._config.nextFetchConfig});case 10:r=t.sent,this.handlePollingResponse({response:r,headers:n,url:e,now:i}),t.next=19;break;case 14:t.prev=14,t.t0=t.catch(6),this._isPooling=!1,(0,E.logError)(this._config,(0,E.errorFormat)(d.POLLING_EVENT_FAILED,{url:e,headers:n,error:t.t0,nextFetchConfig:this._config.nextFetchConfig,method:"GET",duration:Date.now()-i}),d.PROCESS_BUCKETING),this.sendErrorTroubleshooting(n,e,t.t0,i);case 19:case"end":return t.stop()}}),t,this,[[6,14]])}))),function(){return t.apply(this,arguments)})}]);var t,i}(),On=function(){return(0,n.default)((function(t){var e=t.httpClient,n=t.sdkConfig,i=t.trackingManager,r=t.flagshipInstanceId;this._httpClient=e,this._config=n,this._trackingManager=i,this._bucketingContent=n.initialBucketing,this._flagshipInstanceId=r}),[{key:"resetSdk",value:function(){}},{key:"getBucketingContent",value:function(){return this._bucketingContent}},{key:"initSdk",value:(t=e(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})},{key:"getEAIConfig",value:function(){}}]);var t}(),kn=function(){return(0,n.default)((function(t){var e=t.httpClient,n=t.sdkConfig,i=t.trackingManager,r=t.flagshipInstanceId;this._httpClient=e,this._config=n,this._trackingManager=i,this._flagshipInstanceId=r}),[{key:"resetSdk",value:function(){this._EAIConfig=void 0}},{key:"getBucketingContent",value:function(){}},{key:"sendTroubleshooting",value:function(t,e,n,i){var r=new q({flagshipInstanceId:this._flagshipInstanceId,label:P.ACCOUNT_SETTINGS,logLevel:y.LogLevel.DEBUG,visitorId:this._flagshipInstanceId,config:this._config,accountSettings:t,traffic:0,httpRequestMethod:"POST",httpRequestUrl:e,httpResponseHeaders:null==n?void 0:n.headers,httpResponseCode:null==n?void 0:n.status,httpResponseTime:Date.now()-i});this._trackingManager.initTroubleshootingHit=r}},{key:"sendErrorTroubleshooting",value:function(t,e,n){var i=new q({visitorId:this._flagshipInstanceId,flagshipInstanceId:this._flagshipInstanceId,label:P.ACCOUNT_SETTINGS_ERROR,traffic:0,logLevel:y.LogLevel.ERROR,config:this._config,httpRequestMethod:"POST",httpRequestUrl:t,httpResponseBody:null==e?void 0:e.message,httpResponseHeaders:null==e?void 0:e.headers,httpResponseCode:null==e?void 0:e.status,httpResponseTime:Date.now()-n});this._trackingManager.initTroubleshootingHit=i}},{key:"initSdk",value:(t=e(s().mark((function t(){var e,n,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Date.now(),n=(0,E.sprintf)(d.CDN_ACCOUNT_SETTINGS_URL,this._config.envId),t.prev=2,t.next=5,this._httpClient.getAsync(n);case 5:i=t.sent,this._EAIConfig=i.body.accountSettings,this.sendTroubleshooting(i.body.accountSettings,n,i,e),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),(0,E.logErrorSprintf)(this._config,"Error while fetching EAI config: {0}",(null==t.t0?void 0:t.t0.message)||t.t0),this.sendErrorTroubleshooting(n,t.t0,e);case 14:case"end":return t.stop()}}),t,this,[[2,10]])}))),function(){return t.apply(this,arguments)})},{key:"getEAIConfig",value:function(){return this._EAIConfig}}]);var t}(),bn=function(){return(0,n.default)((function(t){var e=t.httpClient,n=t.sdkConfig,i=t.eAIConfig;this._EAIScoreChecked=!1,this._httpClient=e,this._sdkConfig=n,this._eAIConfig=i,this._isEAIDataCollecting=!1}),[{key:"init",value:function(t){this._visitor=t}},{key:"onEAICollectStatusChange",value:function(t){this._onEAICollectStatusChange=t}},{key:"EAIScore",get:function(){return this._EAIScore}},{key:"EAIScoreChecked",get:function(){return this._EAIScoreChecked}},{key:"setIsEAIDataCollected",value:function(t){return this._visitor.setIsEAIDataCollected(t)}},{key:"isEAIDataCollected",value:function(){return this._visitor.isEAIDataCollected()}},{key:"sendEAIScoreTroubleshooting",value:function(t,e){var n,i=new q({flagshipInstanceId:null==(n=this._visitor.sdkInitialData)?void 0:n.instanceId,visitorId:this._visitor.visitorId,label:P.EMOTION_AI_SCORE_FROM_LOCAL_CACHE,logLevel:y.LogLevel.DEBUG,eAIScore:t,isEAIScoreFromLocalCache:!0,config:this._sdkConfig,httpRequestUrl:e,traffic:this._visitor.traffic});this._visitor.sendTroubleshooting(i)}},{key:"sendRequestTroubleshooting",value:function(t,e,n){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"GET",o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=new q({flagshipInstanceId:null==(i=this._visitor.sdkInitialData)?void 0:i.instanceId,visitorId:this._visitor.visitorId,label:e,logLevel:y.LogLevel.DEBUG,hitContent:o,eAIScore:s,httpResponseBody:t.body,httpRequestMethod:r,httpRequestUrl:n,httpResponseCode:t.status,httpResponseHeaders:t.headers,traffic:this._visitor.traffic,config:this._sdkConfig});this._visitor.sendTroubleshooting(a)}},{key:"sendRequestTroubleshootingError",value:function(t,e,n,i){var r,o=new q({flagshipInstanceId:null==(r=this._visitor.sdkInitialData)?void 0:r.instanceId,visitorId:this._visitor.visitorId,label:e,logLevel:y.LogLevel.ERROR,httpRequestMethod:"GET",httpRequestUrl:n,hitContent:i,traffic:this._visitor.traffic,httpResponseBody:null==t?void 0:t.message,httpResponseHeaders:null==t?void 0:t.headers,httpResponseCode:null==t?void 0:t.statusCode,config:this._sdkConfig});this._visitor.sendTroubleshooting(o)}},{key:"sendCollectingTroubleshooting",value:function(t,e,n){var i,r=new q({flagshipInstanceId:null==(i=this._visitor.sdkInitialData)?void 0:i.instanceId,visitorId:this._visitor.visitorId,label:e,logLevel:y.LogLevel.DEBUG,eAIDataTimestamp:new Date(t).toISOString(),config:this._sdkConfig,eAIScore:n,traffic:this._visitor.traffic});this._visitor.sendTroubleshooting(r)}},{key:"sendCollectingUsageHit",value:function(t){var e,n=new ie({visitorId:null==(e=this._visitor.sdkInitialData)?void 0:e.instanceId,label:t,config:this._sdkConfig,logLevel:y.LogLevel.DEBUG});this._visitor.sendUsageHit(n)}},{key:"fetchEAIScore",value:(a=e(s().mark((function t(){var e,n,i,r,o,a,c,u,l,f,h=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=h.length>0&&void 0!==h[0]&&h[0],null!=(e=this._eAIConfig)&&e.eaiActivationEnabled){t.next=3;break}return t.abrupt("return",void 0);case 3:if(!this._EAIScoreChecked){t.next=5;break}return t.abrupt("return",this._EAIScore);case 5:return t.next=7,this._visitor.getCachedEAIScore();case 7:if(!(i=t.sent)){t.next=14;break}return this._EAIScore=i,this._EAIScoreChecked=!0,this._visitor.context[d.EAI_SCORE_CONTEXT_KEY]=null==(r=this._EAIScore)||null==(r=r.eai)?void 0:r.eas,this.sendEAIScoreTroubleshooting(this._EAIScore),t.abrupt("return",this._EAIScore);case 14:if(!this._fetchEAIScorePromise){t.next=18;break}return t.next=17,this._fetchEAIScorePromise;case 17:return t.abrupt("return",this._EAIScore);case 18:return o=this._visitor.visitorId,a=(0,E.sprintf)(d.EMOTION_AI_UC_URL,this._sdkConfig.envId,o),c=n?"&v=".concat(Date.now()):"",u="".concat(a,"?partner=eai").concat(c),t.prev=22,this._fetchEAIScorePromise=this._httpClient.getAsync(u),t.next=26,this._fetchEAIScorePromise;case 26:l=t.sent,this._EAIScore=l.body,this._EAIScoreChecked=!0,this.sendRequestTroubleshooting(l,P.EMOTION_AI_SCORE,u,"GET",void 0,this._EAIScore),this._EAIScore&&(this._visitor.setCachedEAIScore(this._EAIScore),this._visitor.updateContext(d.EAI_SCORE_CONTEXT_KEY,null==(f=this._EAIScore)||null==(f=f.eai)?void 0:f.eas)),(0,E.logDebugSprintf)(this._sdkConfig,d.FETCH_EAI_SCORE,d.FETCH_EAI_SCORE_SUCCESS,o,this._EAIScore),t.next=38;break;case 34:t.prev=34,t.t0=t.catch(22),(0,E.logErrorSprintf)(this._sdkConfig,d.FETCH_EAI_SCORE,d.FETCH_EAI_SCORE_ERROR,o,t.t0.message),this.sendRequestTroubleshootingError(t.t0,P.EMOTION_AI_SCORE_ERROR,u);case 38:return t.prev=38,this._fetchEAIScorePromise=void 0,t.finish(38);case 41:return t.abrupt("return",this._EAIScore);case 42:case"end":return t.stop()}}),t,this,[[22,34,38,41]])}))),function(){return a.apply(this,arguments)})},{key:"collectEAIEventsAsync",value:(o=e(s().mark((function t(e){var n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isEAIDataCollecting&&null!=(n=this._eAIConfig)&&n.eaiCollectEnabled){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.isEAIDataCollected();case 4:if(i=t.sent,this._eAIConfig.eaiActivationEnabled||!i){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.fetchEAIScore();case 9:if(!t.sent){t.next=12;break}return t.abrupt("return");case 12:return r=this._visitor.visitorId,t.next=15,this.startCollectingEAIData(r,e);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"reportPageView",value:(r=e(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isEAIDataCollecting){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",this.sendEAIEvent(e));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"sendEAIEvent",value:(i=e(s().mark((function t(e){var n,i,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.toApiKeys(),t.prev=1,t.next=4,this._httpClient.postAsync(d.EMOTION_AI_EVENT_URL,{body:n,headers:(0,_.default)({},d.HEADER_CONTENT_TYPE,d.HEADER_APPLICATION_JSON)});case 4:i=t.sent,r="PAGEVIEW"===n.t?P.EMOTION_AI_PAGE_VIEW:P.EMOTION_AI_VISITOR_EVENT,this.sendRequestTroubleshooting(i,r,d.EMOTION_AI_EVENT_URL,"POST",e.toApiKeys()),(0,E.logDebugSprintf)(this._sdkConfig,d.SEND_EAI_EVENT,d.SEND_EAI_EVENT_SUCCESS,e.toApiKeys()),t.next=15;break;case 10:t.prev=10,t.t0=t.catch(1),o="PAGEVIEW"===n.t?P.EMOTION_AI_PAGE_VIEW_ERROR:P.EMOTION_AI_VISITOR_EVENT_ERROR,this.sendRequestTroubleshootingError(t.t0,o,d.EMOTION_AI_EVENT_URL,n),(0,E.logErrorSprintf)(this._sdkConfig,d.SEND_EAI_EVENT,d.SEND_EAI_EVENT_ERROR,t.t0.message);case 15:case"end":return t.stop()}}),t,this,[[1,10]])}))),function(t){return i.apply(this,arguments)})},{key:"finalizeDataCollection",value:function(t){this._scoringIntervalId&&(clearInterval(this._scoringIntervalId),this._scoringIntervalId=void 0),this._isEAIDataCollecting=!1,this.setIsEAIDataCollected(t)}},{key:"stopCollectingEAIData",value:function(){var t,n=this;if(this.sendCollectingTroubleshooting(Date.now(),P.EMOTION_AI_STOP_COLLECTING),this.sendCollectingUsageHit(P.EMOTION_AI_STOP_COLLECTING),this.removeListeners(),null==(t=this._eAIConfig)||!t.eaiActivationEnabled)return this._isEAIDataCollecting=!1,void this.setIsEAIDataCollected(!0);this._startScoringTimestamp=Date.now(),this.sendCollectingTroubleshooting(this._startScoringTimestamp,P.EMOTION_AI_START_SCORING),this._scoringIntervalId=setInterval(e(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(Date.now()-n._startScoringTimestamp>d.MAX_SCORING_POLLING_TIME)){t.next=5;break}return n.sendCollectingTroubleshooting(Date.now(),P.EMOTION_AI_SCORING_FAILED),n.finalizeDataCollection(!1),t.abrupt("return");case 5:return n._EAIScoreChecked=!1,t.next=8,n.fetchEAIScore(!0);case 8:(e=t.sent)&&(n.sendCollectingTroubleshooting(Date.now(),P.EMOTION_AI_SCORING_SUCCESS,e),n.finalizeDataCollection(!0));case 10:case"end":return t.stop()}}),t)}))),d.SCORING_INTERVAL)}},{key:"reportVisitorEvent",value:(t=e(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isEAIDataCollecting){t.next=2;break}return t.abrupt("return");case 2:(n=Date.now()-this._startCollectingEAIDataTimestamp)<=d.MAX_COLLECTING_TIME_MS?this.sendEAIEvent(e):n<=d.MAX_LAST_COLLECTING_TIME_MS?(this.sendEAIEvent(e),this.stopCollectingEAIData()):(this.removeListeners(),this._isEAIDataCollecting=!1,this.setIsEAIDataCollected(!1));case 4:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})}]);var t,i,r,o,a}(),Rn=r(3988),Nn=r(7188);function Dn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Dn=function(){return!!t})()}var wn=function(t){function i(t){var e,n,r,o;return n=this,o=[t],r=u(r=i),e=c(n,Dn()?Reflect.construct(r,o||[],u(n).constructor):r.apply(n,o)),(0,_.default)(e,"_clickPath",""),(0,_.default)(e,"scrollTimeoutId",null),(0,_.default)(e,"scrollEndDelay",200),(0,_.default)(e,"_clickPathTimeoutId",null),(0,_.default)(e,"handleScroll",(function(t){null!==e.scrollTimeoutId&&clearTimeout(e.scrollTimeoutId),e.scrollTimeoutId=window.setTimeout((function(){e.onScrollEnd(t),e.scrollTimeoutId=null}),d.SCROLL_END_DELAY_MS)})),(0,_.default)(e,"handleMouseMove",(function(t,n){null!==e._clickPathTimeoutId&&clearTimeout(e._clickPathTimeoutId),e._clickPath+="".concat(t.clientX,",").concat(t.clientY,",").concat(Date.now().toString().slice(-5),";"),e._clickPath.length>=d.MAX_CLICK_PATH_LENGTH?e.sendClickPath(n):e._clickPathTimeoutId=window.setTimeout((function(){e.sendClickPath(n)}),d.CLICK_PATH_DELAY_MS)})),(0,_.default)(e,"handleClick",(function(t,n,i){var r=Date.now().toString().slice(-5),o=new Nn.VisitorEvent({visitorId:n,customerAccountId:e._sdkConfig.envId,clickPosition:"".concat(t.clientX,",").concat(t.clientY,",").concat(r,",").concat(i,";"),screenSize:"".concat(window.innerWidth,",").concat(window.innerHeight,";"),currentUrl:window.location.href});e.reportVisitorEvent(o)})),e._originalPushState=window.history.pushState,e._originalReplaceState=window.history.replaceState,e}return f(i,t),(0,n.default)(i,[{key:"cleanup",value:function(){this.removeListeners(),this._isEAIDataCollecting=!1,clearInterval(this._scoringIntervalId)}},{key:"getDeviceCategory",value:function(){var t=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(t)?"iphone":/android/.test(t)?"android":/windows nt/.test(t)?"win32":/macintosh|mac os x/.test(t)?"darwin":/linux/.test(t)?/armv8l/.test(t)?"linux armv8l":"linux":"unknown"}},{key:"processPageView",value:(o=e(s().mark((function t(e){var n,i,r,o,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._lastPageViewLocation!==window.location.href){t.next=2;break}return t.abrupt("return");case 2:return this._lastPageViewLocation=window.location.href,n=navigator.maxTouchPoints||0,i="ontouchstart"in window,r="ontouchstart"in window||"onmsgesturechange"in window,o=JSON.stringify([n,i,r]),a=new Rn.PageView({visitorId:e,customerAccountId:this._sdkConfig.envId,currentUrl:window.location.href,hasAdBlocker:!1,screenDepth:"".concat(window.screen.colorDepth),screenSize:"".concat(window.innerWidth,",").concat(window.innerHeight,";"),doNotTrack:navigator.doNotTrack||"unspecified",fonts:"[]",hasFakeBrowserInfos:!1,hasFakeLanguageInfos:!1,hasFakeOsInfos:!1,hasFakeResolutionInfos:!1,userLanguage:navigator.language,deviceCategory:this.getDeviceCategory(),pixelRatio:window.devicePixelRatio,documentReferer:document.referrer,viewportSize:"[".concat(document.documentElement.clientWidth,",").concat(document.documentElement.clientHeight,"]"),timezoneOffset:(new Date).getTimezoneOffset(),touchSupport:o,eventCategory:"click tunnel auto",userAgent:navigator.userAgent}),t.next=10,this.reportPageView(a);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"startCollectingEAIData",value:(r=e(s().mark((function t(e){var n,i=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._isEAIDataCollecting=!0,t.next=3,this.processPageView(e);case 3:this._startCollectingEAIDataTimestamp=Date.now(),this.sendCollectingTroubleshooting(this._startCollectingEAIDataTimestamp,P.EMOTION_AI_START_COLLECTING),this.sendCollectingUsageHit(P.EMOTION_AI_START_COLLECTING),n=null,this.onScroll=function(){return i.handleScroll(e)},this.onMouseMove=function(t){return i.handleMouseMove(t,e)},this.onMouseDown=function(){n=Date.now()},this.onMouseUp=function(t){if(n){var r=Date.now()-n;i.handleClick(t,e,r),n=null}},this.onPopState=function(){i.processPageView(e)},(0,E.onDomReady)((function(){window.history.pushState=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];i._originalPushState.apply(window.history,n),i.processPageView(e)},window.history.replaceState=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];i._originalReplaceState.apply(window.history,n),i.processPageView(e)},window.addEventListener("scroll",i.onScroll),document.addEventListener("mousemove",i.onMouseMove),document.addEventListener("mousedown",i.onMouseDown),document.addEventListener("mouseup",i.onMouseUp),window.addEventListener("popstate",i.onPopState)}));case 13:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"removeListeners",value:function(){var t=this;(0,E.onDomReady)((function(){window.removeEventListener("scroll",t.onScroll),document.removeEventListener("mousemove",t.onMouseMove),document.removeEventListener("mousedown",t.onMouseDown),document.removeEventListener("mouseup",t.onMouseUp),window.removeEventListener("popstate",t.onPopState),window.history.pushState=t._originalPushState,window.history.replaceState=t._originalReplaceState})),null!==this.scrollTimeoutId&&(clearTimeout(this.scrollTimeoutId),this.scrollTimeoutId=null),null!==this._clickPathTimeoutId&&(clearTimeout(this._clickPathTimeoutId),this._clickPathTimeoutId=null)}},{key:"onScrollEnd",value:function(t){var e=Date.now().toString().slice(-5),n="".concat(window.scrollY,",").concat(e,";"),i=new Nn.VisitorEvent({visitorId:t,customerAccountId:this._sdkConfig.envId,scrollPosition:n,screenSize:"".concat(window.innerWidth,",").concat(window.innerHeight,";"),currentUrl:window.location.href});this.reportVisitorEvent(i)}},{key:"sendClickPath",value:function(t){var e=new Nn.VisitorEvent({visitorId:t,customerAccountId:this._sdkConfig.envId,clickPath:this._clickPath,screenSize:"".concat(window.innerWidth,",").concat(window.innerHeight,";"),currentUrl:window.location.href});this._clickPath="",this.reportVisitorEvent(e)}}]);var r,o}(bn),xn=function(){return(0,n.default)((function(t){this._sdkConfig=t}),[{key:"saveVisitorProfile",value:function(t){try{if(!t)return void localStorage.removeItem(d.CLIENT_CACHE_KEY);localStorage.setItem(d.CLIENT_CACHE_KEY,JSON.stringify(t))}catch(t){(0,E.logErrorSprintf)(this._sdkConfig,"VisitorProfileCache.saveVisitorProfile",null==t?void 0:t.message)}}},{key:"loadVisitorProfile",value:function(){try{var t=localStorage.getItem(d.CLIENT_CACHE_KEY);return t?JSON.parse(t):null}catch(t){(0,E.logErrorSprintf)(this._sdkConfig,"VisitorProfileCache.loadVisitorProfile",null==t?void 0:t.message)}return null}}])}(),Pn=function(t){return t.ABT_TAG_TRACK_ACTION="ABT_TAG_TRACK_ACTION",t.ABT_WEB_SDK_TRACK_ACTION="ABT_WEB_SDK_TRACK_ACTION",t}({});function Ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var Mn=function(){return(0,n.default)((function(t){var e=t.sdkConfig;(0,_.default)(this,"visitor",null),this.trustedNonces={},this.sdkConfig=e}),[{key:"generateNonce",value:function(){if((0,E.isBrowser)()&&this.visitor&&this.visitor.hasConsented){var t=Math.random().toString(36).substring(2)+Date.now().toString(36);return this.trustedNonces[t]=!1,t}}},{key:"initialize",value:function(t){var e,n,i=this;(this.visitor=t,this.initTimestamp=Date.now(),(0,E.isBrowser)())&&(this.onMessageReceived&&(null==(n=window)||n.removeEventListener("message",this.onMessageReceived)),this.onMessageReceived=function(t){i.handleMessage(t)},null==(e=window)||e.addEventListener("message",this.onMessageReceived))}},{key:"processHit",value:(t=e(s().mark((function t(e){var n,i,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((null==e?void 0:e.ec)===rt.ACTION_TRACKING&&e.ea){t.next=3;break}return(0,E.logDebugSprintf)(this.sdkConfig,d.ACTION_TRACKING,d.ACTION_TRACKING_INVALID_HIT,e),t.abrupt("return");case 3:o=new ct({category:e.ec,action:e.ea,label:e.el,value:e.ev,visitorId:null==(n=this.visitor)?void 0:n.visitorId,anonymousId:null==(i=this.visitor)?void 0:i.anonymousId,isActionTrackingHit:!0}),null==(r=this.visitor)||r.addInTrackingManager(o),(0,E.logDebugSprintf)(this.sdkConfig,d.ACTION_TRACKING,d.ACTION_TRACKING_HIT_RECEIVED,e);case 6:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})},{key:"handleMessage",value:function(t){var e;if(null!=t&&t.data&&(null==t?void 0:t.origin)===window.location.origin&&null!=(e=this.visitor)&&e.hasConsented){var n=t.data;if(n.action===Pn.ABT_TAG_TRACK_ACTION&&n.nonce){var i=n.nonce;if(void 0===this.trustedNonces[i]||this.trustedNonces[i])(0,E.logDebugSprintf)(this.sdkConfig,d.ACTION_TRACKING,d.ACTION_TRACKING_INVALID_NONCE,i);else{this.trustedNonces[i]=!0;var r=n.data;if(r&&r.length){var o,s=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ln(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ln(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(r);try{for(s.s();!(o=s.n()).done;){var a=o.value;this.processHit(a)}}catch(t){s.e(t)}finally{s.f()}}}}}}},{key:"dispatchEventHits",value:function(t){if(this.shouldProcessHits(t)){var e=this.getNonce();if(e){var n=this.filterHitsToDispatch(t);n.length&&this.postHits(n,e)}}}},{key:"shouldProcessHits",value:function(t){return(0,E.isBrowser)()&&!!this.visitor&&!!t&&t.length>0}},{key:"getNonce",value:function(){var t,e;return null==(t=window.ABTasty)||null==(t=t.api)||null==(t=t.internal)||null==(e=t._getActionTrackingNonce)?void 0:e.call(t)}},{key:"filterHitsToDispatch",value:function(t){var e=this;return t.filter((function(t){var n,i,r=e.initTimestamp&&t.createdAt>=e.initTimestamp,o=t.visitorId===(null==(n=e.visitor)?void 0:n.visitorId)||t.visitorId===(null==(i=e.visitor)?void 0:i.anonymousId);return t.data.ec===rt.ACTION_TRACKING&&r&&o})).map((function(t){return t.data}))}},{key:"postHits",value:function(t,e){var n,i={action:Pn.ABT_WEB_SDK_TRACK_ACTION,data:t,nonce:e,timestamp:Date.now()};null==(n=window)||n.postMessage(i,window.location.origin),(0,E.logDebugSprintf)(this.sdkConfig,d.ACTION_TRACKING,d.ACTION_TRACKING_DISPATCHED,t)}}]);var t}(),Hn=function(){return(0,n.default)((function(t){var e=t.sharedActionTracking;this.sharedActionTracking=e}),[{key:"setVisitor",value:function(t){this.visitor=t}},{key:"getApiV1",value:function(){var t=this;return{_getActionTrackingNonce:function(){var e;return null==(e=t.sharedActionTracking)?void 0:e.generateNonce()},_getVisitorId:function(){var e,n;return!0!==(null==(e=t.visitor)?void 0:e.isClientSuppliedID)?null==(n=t.visitor)?void 0:n.visitorId:void 0}}}}])}(),Fn=function(){function t(){this.instanceId=(0,E.uuidV4)(),this._status=v.SDK_NOT_INITIALIZED;var e=t;e.setVisitorProfile=function(e){t.visitorProfile=e},e.getVisitorProfile=function(){return t.visitorProfile},e.setOnSaveVisitorProfile=function(e){t.onSaveVisitorProfile=e},e.getOnSaveVisitorProfile=function(){return t.onSaveVisitorProfile},this._visitorVariationState={}}return(0,n.default)(t,[{key:"configManager",get:function(){return this._configManager},set:function(t){this._configManager=t}},{key:"setStatus",value:function(t){var e;if(this._status!==t){this._status=t,tn.SdkStatus=t;var n,i,r=null==(e=this.getConfig())?void 0:e.onSdkStatusChanged;if((0,E.logInfoSprintf)(this._config,d.PROCESS_SDK_STATUS,d.SDK_STATUS_CHANGED,v[t]),this.getConfig().decisionMode!==I.BUCKETING_EDGE)t===v.SDK_INITIALIZED&&(null==(n=this.configManager)||null==(n=n.trackingManager)||n.startBatchingLoop()),t===v.SDK_NOT_INITIALIZED&&(null==(i=this.configManager)||null==(i=i.trackingManager)||i.stopBatchingLoop());r&&r(t)}}},{key:"getStatus",value:function(){return this._status}},{key:"getConfig",value:function(){return this._config}},{key:"getVisitor",value:function(){return this._visitorInstance}},{key:"buildConfig",value:function(t){var e;switch(null==t?void 0:t.decisionMode){case I.BUCKETING:e=new b(t);break;case I.BUCKETING_EDGE:e=new mn(t);break;default:e=new w(t)}return e}},{key:"createManagers",value:function(t,e,n){var i;switch(e.decisionMode){case I.BUCKETING:return{sdkManager:i=new Cn({httpClient:t,sdkConfig:e,trackingManager:n,flagshipInstanceId:this.instanceId}),decisionManager:new fn({httpClient:t,config:e,murmurHash:new Ze,sdkManager:i,trackingManager:n,flagshipInstanceId:this.instanceId})};case I.BUCKETING_EDGE:return{sdkManager:i=new On({httpClient:t,sdkConfig:e,trackingManager:n,flagshipInstanceId:this.instanceId}),decisionManager:new En({httpClient:t,config:e,murmurHash:new Ze,sdkManager:i,trackingManager:n,flagshipInstanceId:this.instanceId})};default:return{sdkManager:i=new kn({httpClient:t,sdkConfig:e,trackingManager:n,flagshipInstanceId:this.instanceId}),decisionManager:new z({trackingManager:n,httpClient:t,config:e,flagshipInstanceId:this.instanceId})}}}},{key:"buildSdkApi",value:function(t,e){this._sdkApi=new Hn({sharedActionTracking:t}),window.ABTastyWebSdk={envId:e.envId,internal:this._sdkApi.getApiV1()}}},{key:"sendInitializedPostMessage",value:function(){(0,E.onDomReady)((function(){window.postMessage({action:M.AB_TASTY_WEB_SDK_INITIALIZED},"*")}))}},{key:"initializeSdk",value:(c=e(s().mark((function t(e){var n,i,r,o,a,c,u,l,f,h;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setStatus(v.SDK_INITIALIZING),null==(n=this._sdkManager)||n.resetSdk(),!(a=null==(i=this.configManager)?void 0:i.sharedActionTracking)&&(0,E.isBrowser)()&&(a=new Mn({sdkConfig:e}),this.buildSdkApi(a,e)),c=new _n,u=(null==(r=this.configManager)?void 0:r.trackingManager)||new Jt(c,e,this.instanceId,a),l=this.createManagers(c,e,u),f=l.sdkManager,h=l.decisionManager,this._sdkManager=f,h.statusChangedCallback(this.setStatus.bind(this)),h.flagshipInstanceId=this.instanceId,this.configManager=new x(e,h,u,a),t.next=13,null==(o=this._sdkManager)?void 0:o.initSdk();case 13:this.setStatus(v.SDK_INITIALIZED);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"close",value:(a=e(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.close();case 2:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"newVisitor",value:function(e){return t.newVisitor(e)}},{key:"initializeConfigManager",value:function(){var t=new w;t.logManager=new Zt;var e=new _n,n=new Jt(e,t),i=new z({httpClient:e,config:t,trackingManager:n});this._config=t,this.configManager=new x(t,i,n)}}],[{key:"getInstance",value:function(){return this._instance||(this._instance=new this),this._instance}},{key:"getStatus",value:function(){return this.getInstance()._status}},{key:"getConfig",value:function(){return this.getInstance()._config}},{key:"getVisitor",value:function(){return this.getInstance().getVisitor()}},{key:"start",value:(o=e(s().mark((function t(e,n,i){var o,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this.getInstance(),(a=o.buildConfig(i)).envId=e,a.apiKey=n,o._config=a,a.onLog||a.logManager||(a.logManager=new Zt),e&&n){t.next=10;break}return o.setStatus(v.SDK_NOT_INITIALIZED),(0,E.logError)(a,d.INITIALIZATION_PARAM_ERROR,d.PROCESS_INITIALIZATION),t.abrupt("return",o);case 10:return(0,E.logDebugSprintf)(a,d.PROCESS_INITIALIZATION,d.INITIALIZATION_STARTING,d.SDK_INFO.version,a.decisionMode,a),!a.hitCacheImplementation&&(0,E.isBrowser)()&&(a.hitCacheImplementation=new ae),!a.visitorCacheImplementation&&(0,E.isBrowser)()&&(a.visitorCacheImplementation=new ue),t.next=14,o.initializeSdk(a);case 14:return(0,E.logInfo)(a,(0,E.sprintf)(d.SDK_STARTED_INFO,d.SDK_INFO.version,v[o._status],a.decisionMode),d.PROCESS_INITIALIZATION),r.e(692).then(r.bind(r,6692)).then((function(t){t.launchQaAssistant(a,o._visitorVariationState)})),o.lastInitializationTimestamp=(new Date).toISOString(),o.sendInitializedPostMessage(),t.abrupt("return",o);case 19:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return o.apply(this,arguments)})},{key:"close",value:(i=e(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==(e=this._instance)||null==(e=e.configManager)||null==(e=e.trackingManager)?void 0:e.sendBatch();case 2:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"newVisitor",value:function(t){var e,n=t.visitorId,i=t.context,r=t.isAuthenticated,o=t.hasConsented,s=t.initialCampaigns,a=t.initialFlagsData,c=t.shouldSaveInstance,u=t.onFlagsStatusChanged,l=null!=c?c:(0,E.isBrowser)(),f=this.getInstance();f.configManager||(f.initializeConfigManager(),(0,E.logError)(f.getConfig(),d.NEW_VISITOR_NOT_READY,d.PROCESS_NEW_VISITOR));var h=f.getConfig(),g=f.configManager;void 0===o&&(0,E.logWarning)(h,d.CONSENT_NOT_SPECIFY_WARNING,d.PROCESS_NEW_VISITOR);var v=new wn({sdkConfig:h,httpClient:new _n,eAIConfig:null==(e=f._sdkManager)?void 0:e.getEAIConfig()}),_=new xn(h);tn.SdkStatus=f.getStatus();var y=new an({visitorId:n,context:i||{},isAuthenticated:null!=r&&r,hasConsented:null!=o&&o,configManager:g,initialCampaigns:s,initialFlagsData:a,onFlagsStatusChanged:u,emotionAi:v,visitorProfileCache:_,monitoringData:{instanceId:this.getInstance().instanceId,lastInitializationTimestamp:this.getInstance().lastInitializationTimestamp,initialCampaigns:s,initialFlagsData:a},murmurHash:new Ze,visitorVariationState:f._visitorVariationState});(0,E.onDomReady)((function(){var t;(0,E.isBrowser)()&&(null==(t=f._sdkApi)||t.setVisitor(y),g.sharedActionTracking&&g.sharedActionTracking.initialize(y))}));var T=new p(y);return this.getInstance()._visitorInstance=l?T:void 0,l&&(0,E.logDebugSprintf)(h,d.PROCESS_NEW_VISITOR,d.SAVE_VISITOR_INSTANCE,T.visitorId),h.fetchNow&&h.decisionMode!==I.BUCKETING_EDGE&&T.fetchFlags(),T}}]);var i,o,a,c}();const Vn=Fn})(),o})()));
//# sourceMappingURL=index.browser.umd.js.map