{"version":3,"file":"chunks/browser/umd/532.633ace213f3afd9caf0c.js","mappings":"6OAKO,IAAKA,EAAoB,SAApBA,GAAoB,OAApBA,EAAoB,8CAApBA,EAAoB,qDAApBA,EAAoB,qDAApBA,EAAoB,2CAApBA,EAAoB,kEAApBA,EAAoB,oCAApBA,EAAoB,8EAApBA,CAAoB,MA8BpBC,EAAkB,SAAlBA,GAAkB,OAAlBA,EAAkB,0EAAlBA,EAAkB,yDAAlBA,EAAkB,eAAlBA,CAAkB,MAMlBC,EAA2B,SAA3BA,GAA2B,OAA3BA,EAA2B,8BAA3BA,CAA2B,MAqB3BC,EAAe,SAAfA,GAAe,OAAfA,EAAe,0CAAfA,CAAe,K,m0BC3DpB,SAASC,EAAoBC,GAA+B,IAAAC,EACtD,OAAPA,EAACC,SAAc,OAARD,EAANA,EAAQE,SAARF,EAAgBG,oBAGrBF,OAAOC,OAAOC,mBAAmBC,YAAYL,EAAM,IACrD,CAEO,SAASM,EAA+BC,GAEnB,MAArBA,GAAAA,EAAuBC,mBAI5BT,EAAoB,CAClBU,KAAMb,EAAAA,mBAAmBc,kCACzBC,MAAOJ,EAAsBC,mBAEjC,CAEO,SAASI,EAA6BL,GAC3C,GAA0B,MAArBA,GAAAA,EAAuBM,kBAA5B,CAIA,IAAMC,EAAqBP,EAAsBO,mBAE7CP,EAAsBO,qBACxBP,EAAsBO,oBAAqB,GAG7Cf,EAAoB,CAClBU,KAAMb,EAAAA,mBAAmBmB,0BACzBJ,MAAOJ,EAAsBM,kBAC7BG,MAAOF,EAAqBjB,EAAAA,4BAA4BoB,mBAAgBC,GAX1E,CAaF,CAEO,SAASC,EAAcC,GAC5BrB,EAAoB,CAClBU,KAAMb,EAAAA,mBAAmByB,MACzBV,MAAOS,EAAIE,KAAI,SAAAC,GACb,OAAAC,EAAAA,EAAA,GACKD,GAAI,IACPE,UAAWC,KAAKC,MAASJ,EAAKK,IAElC,KAEJ,C","sources":["webpack://@flagship.io/js-sdk/./src/qaAssistant/type.ts","webpack://@flagship.io/js-sdk/./src/qaAssistant/messages/index.ts"],"sourcesContent":["import { FsVariationToForce, VisitorVariations } from '../types';\n\n/**\n * All events posted from iframe\n */\nexport enum MSG_NAME_FROM_IFRAME {\n  QaAssistantClose = 'ABTASTY_QA_ASSISTANT_CLOSE',\n  FsApplyForcedVariations = 'FS_APPLY_FORCED_VARIATIONS',\n  FsResetForcedVariations = 'FS_RESET_FORCED_VARIATIONS',\n  FsQaAssistantReady = 'FS_QA_ASSISTANT_READY',\n  MinimizeQaAssistantClose = 'ABTASTY_QA_MINIMIZE_QA_ASSISTANT_CLOSE',\n  FsTriggerRender = 'FS_TRIGGER_RENDER',\n  QaAssistantPlatformChoiceLoaded = 'ABTASTY_QA_ASSISTANT_PLATFORM_CHOICE_LOADED'\n}\n\nexport type FsApplyForcedVariations = {\n  name: MSG_NAME_FROM_IFRAME.FsApplyForcedVariations;\n  value: Record<string, FsVariationToForce>;\n};\n\nexport type EventDataFromIframe =\n  | {\n      name:\n        | MSG_NAME_FROM_IFRAME.QaAssistantClose\n        | MSG_NAME_FROM_IFRAME.FsResetForcedVariations\n        | MSG_NAME_FROM_IFRAME.FsQaAssistantReady\n        | MSG_NAME_FROM_IFRAME.MinimizeQaAssistantClose\n        | MSG_NAME_FROM_IFRAME.FsTriggerRender\n        | MSG_NAME_FROM_IFRAME.QaAssistantPlatformChoiceLoaded;\n    }\n  | FsApplyForcedVariations;\n\n/**\n * All events posted to iframe\n */\nexport enum MSG_NAME_TO_IFRAME {\n  FsUpdateVisitorAllocatedVariation = 'FS_UPDATE_VISITOR_ALLOCATED_VARIATION',\n  FsVisitorExposedVariation = 'FS_VISITOR_EXPOSED_VARIATION',\n  FsHIT = 'FS_HIT',\n}\n\nexport enum VisitorVariationUpdateParam {\n  NewNavigation = 'newNavigation',\n}\n\n\nexport type VisitorAllocatedVariations = {\n  name:\n    | MSG_NAME_TO_IFRAME.FsUpdateVisitorAllocatedVariation\n    | MSG_NAME_TO_IFRAME.FsVisitorExposedVariation;\n  value: Record<string, VisitorVariations>;\n  param?: VisitorVariationUpdateParam\n\n};\n\nexport type FsSendHit = {\n  name: MSG_NAME_TO_IFRAME.FsHIT;\n  value: Record<string, unknown>[];\n};\n\nexport type EventDataToIframe = VisitorAllocatedVariations | FsSendHit;\n\nexport enum INTERNAL_EVENTS {\n  FsTriggerRendering = 'FS_TRIGGER_RENDERING',\n}\n","import { VisitorVariationState } from '../../type.local';\nimport { EventDataToIframe, MSG_NAME_TO_IFRAME, VisitorVariationUpdateParam } from '../type';\n\nexport function sendMessageToIframe(data: EventDataToIframe): void {\n  if (!window?.frames?.ABTastyQaAssistant) {\n    return;\n  }\n  window.frames.ABTastyQaAssistant.postMessage(data, '*');\n}\n\nexport function sendVisitorAllocatedVariations(visitorVariationState: VisitorVariationState):void {\n\n  if (!visitorVariationState?.visitorVariations) {\n    return;\n  }\n\n  sendMessageToIframe({\n    name: MSG_NAME_TO_IFRAME.FsUpdateVisitorAllocatedVariation,\n    value: visitorVariationState.visitorVariations\n  });\n}\n\nexport function sendVisitorExposedVariations(visitorVariationState: VisitorVariationState):void {\n  if (!visitorVariationState?.exposedVariations) {\n    return;\n  }\n\n  const navigationDetected = visitorVariationState.navigationDetected;\n\n  if (visitorVariationState.navigationDetected) {\n    visitorVariationState.navigationDetected = false;\n  }\n\n  sendMessageToIframe({\n    name: MSG_NAME_TO_IFRAME.FsVisitorExposedVariation,\n    value: visitorVariationState.exposedVariations,\n    param: navigationDetected ? VisitorVariationUpdateParam.NewNavigation : undefined\n  });\n}\n\nexport function sendFsHitToQA(hit: Record<string, unknown>[]):void {\n  sendMessageToIframe({\n    name: MSG_NAME_TO_IFRAME.FsHIT,\n    value: hit.map(item => {\n      return {\n        ...item,\n        timestamp: Date.now() - (item.qt as number)\n      };\n    })\n  });\n}\n"],"names":["MSG_NAME_FROM_IFRAME","MSG_NAME_TO_IFRAME","VisitorVariationUpdateParam","INTERNAL_EVENTS","sendMessageToIframe","data","_window","window","frames","ABTastyQaAssistant","postMessage","sendVisitorAllocatedVariations","visitorVariationState","visitorVariations","name","FsUpdateVisitorAllocatedVariation","value","sendVisitorExposedVariations","exposedVariations","navigationDetected","FsVisitorExposedVariation","param","NewNavigation","undefined","sendFsHitToQA","hit","FsHIT","map","item","_objectSpread","timestamp","Date","now","qt"],"sourceRoot":""}